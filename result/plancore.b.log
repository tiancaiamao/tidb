2022/06/22 14:00:01 maxprocs: Leaving GOMAXPROCS=16: CPU quota undefined
err=exit status 1
[2022/06/22 14:02:23.004 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:02:23.004 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:02:24.005 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:02:28.006 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING: error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING"]
[2022/06/22 14:02:29.007 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:02:29.007 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:02:29.007 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:02:29.008 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:02:31.011 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:02:31.021 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=849802] ["lease id"=2231818a01326427]
[2022/06/22 14:02:31.023 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:02:37.023 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=4.012531626s]
[2022/06/22 14:02:37.023 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:02:37.023 +08:00] [WARN] [domain.go:449] ["loading schema takes a long time"] ["take time"=5.998553482s]
[2022/06/22 14:02:37.023 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=0acdfd88-a2f3-4e20-8017-4324607ed7fb] [runWorker=true]
[2022/06/22 14:02:37.023 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:02:37.028 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:02:37.028 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:02:37.028 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:02:37.029 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"] [ownerID=0acdfd88-a2f3-4e20-8017-4324607ed7fb]
[2022/06/22 14:02:37.034 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:02:37.034 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:02:37.036 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"] [ownerID=0acdfd88-a2f3-4e20-8017-4324607ed7fb]
[2022/06/22 14:02:37.055 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:02:37.240 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:02:37.242 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:02:37.243 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:02:37.417 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:02:37.417 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:02:37.422 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=6062805a6fc0002]
[2022/06/22 14:02:37.423 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=6.107554ms]
[2022/06/22 14:02:37.424 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"] [ownerID=0acdfd88-a2f3-4e20-8017-4324607ed7fb]
[2022/06/22 14:02:37.424 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"] [ownerID=0acdfd88-a2f3-4e20-8017-4324607ed7fb]
[2022/06/22 14:02:37.931 +08:00] [WARN] [adapter.go:1095] ["# Txn_start_ts: 434078418842419201\n# Query_time: 0.506305298\n# Parse_time: 0\n# Compile_time: 0.000067189\n# Rewrite_time: 0.000016609\n# Optimize_time: 0\n# Wait_TS: 0.000100319\n# Prewrite_time: 0.00261576 Commit_time: 0.002016295 Get_commit_ts_time: 0.000121509 Write_keys: 1 Write_size: 109 Prewrite_region: 1\n# Is_internal: true\n# Digest: 61f4cce222f1a26d6b0650865051ebed3d077412ae053636e2f5acf9dc426a42\n# Num_cop_tasks: 0\n# Mem_max: 403\n# Prepared: false\n# Plan_from_cache: false\n# Plan_from_binding: false\n# Has_more_results: false\n# KV_total: 0\n# PD_total: 0\n# Backoff_total: 0\n# Write_sql_response_total: 0\n# Result_rows: 0\n# Succ: true\n# IsExplicitTxn: false\n# Plan: tidb_decode_plan('pATYMAkyN18xCTAJMAlOL0EJMAl0aW1lOjY0My42wrVzLCBsb29wczoxLCBwcmVwYXJlOiAxMTQuMgUcUGNoZWNrX2luc2VydDoge3RvdGFsXwVAFCA1MjkuNQUlCG1lbQ0jDRsMNDkuMQUaOHByZWZldGNoOiA0ODAuNAUUSHJwYzp7QmF0Y2hHZXQ6e251bV8BEwgyLCAdXiA0NDcuM8K1c30RFgh3YWkVXjhtcywgc2Nhbl9kZXRhaWwVmDRwcm9jZXNzX2tleXM6IBVRLhcAJF9zaXplOiAyMDgRWRUtmHJvY2tzZGI6IHtkZWxldGVfc2tpcHBlZF9jb3VudDogMCwga2V5X0YWAEBibG9jazoge2NhY2hlX2hpdBEyGDEyLCByZWEuQgAFDzRieXRlOiAwIEJ5dGVzfQEBFCwgY29tbQHiRHhuOiB7cHJld3JpdGU6Mi42MgHuBGdlAVUJIhBzOjEyMS16CTYMOjIuMAUnJHJlZ2lvbl9udW0hzwVDCeAEMSwNDgV7SDEwOX0JNDAzIEJ5dGVzCU4vQQo=')\nINSERT HIGH_PRIORITY INTO mysql.tidb VALUES ('tikv_gc_leader_uuid', '6062805a6fc0002', 'Current GC worker leader UUID. (DO NOT EDIT)')           ON DUPLICATE KEY           UPDATE variable_value = '6062805a6fc0002', comment = 'Current GC worker leader UUID. (DO NOT EDIT)';"]
[2022/06/22 14:02:37.960 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=6062805a6fc0002]
[2022/06/22 14:02:37.961 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=] [sql="drop database if exists test_partition;"] [user=]
[2022/06/22 14:02:37.961 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=] [sql="create database test_partition"] [user=]
[2022/06/22 14:02:37.970 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create schema, State:queueing, SchemaState:none, SchemaID:69, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:37.926 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:02:37.970 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create schema, State:queueing, SchemaState:none, SchemaID:69, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:37.926 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create database test_partition"]
[2022/06/22 14:02:37.971 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create schema, State:queueing, SchemaState:none, SchemaID:69, TableID:0, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:37.926 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:37.975 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=403.107µs] [phyTblIDs="[]"] [actionTypes="[]"]
[2022/06/22 14:02:38.025 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.078042ms] [job="ID:70, Type:create schema, State:done, SchemaState:public, SchemaID:69, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:37.926 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.026 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create schema, State:synced, SchemaState:public, SchemaID:69, TableID:0, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:37.926 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.029 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:02:38.029 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:02:38.030 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test_partition] [sql="create table t1 (id int, a int, b int) partition by list columns (b,a) (partition p0 values in ((1,1),(2,2),(3,3),(4,4),(5,5)), partition p1 values in ((6,6),(7,7),(8,8),(9,9),(10,10),(null,10)));"] [user=]
[2022/06/22 14:02:38.039 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.025 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:02:38.039 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.025 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t1 (id int, a int, b int) partition by list columns (b,a) (partition p0 values in ((1,1),(2,2),(3,3),(4,4),(5,5)), partition p1 values in ((6,6),(7,7),(8,8),(9,9),(10,10),(null,10)));"]
[2022/06/22 14:02:38.041 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:38.025 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.050 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=1.492608ms] [phyTblIDs="[71,72,73]"] [actionTypes="[8,8,8]"]
[2022/06/22 14:02:38.099 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.727749ms] [job="ID:74, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.025 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.101 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:38.025 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.105 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=74]
[2022/06/22 14:02:38.105 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:02:38.106 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=36] [cur_db=test_partition] [sql="create table t2 (id int, a int, b int) partition by list columns (id,a,b) (partition p0 values in ((1,1,1),(2,2,2),(3,3,3),(4,4,4),(5,5,5)), partition p1 values in ((6,6,6),(7,7,7),(8,8,8),(9,9,9),(10,10,10),(null,null,null)));"] [user=]
[2022/06/22 14:02:38.113 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.075 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:02:38.113 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.075 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t2 (id int, a int, b int) partition by list columns (id,a,b) (partition p0 values in ((1,1,1),(2,2,2),(3,3,3),(4,4,4),(5,5,5)), partition p1 values in ((6,6,6),(7,7,7),(8,8,8),(9,9,9),(10,10,10),(null,null,null)));"]
[2022/06/22 14:02:38.114 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:38.075 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.122 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=36] [neededSchemaVersion=37] ["start time"=2.413272ms] [phyTblIDs="[75,76,77]"] [actionTypes="[8,8,8]"]
[2022/06/22 14:02:38.170 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=37] ["take time"=51.496401ms] [job="ID:78, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.075 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.172 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:78, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:38.075 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.175 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=78]
[2022/06/22 14:02:38.176 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:02:38.178 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078419039027204] [checkTS=434078419039027205]
[2022/06/22 14:02:38.182 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078419039027207] [checkTS=434078419039027208]
[2022/06/22 14:02:38.185 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=2] [schemaVersion=37] [cur_db=] [sql="drop database if exists test_partition_1;"] [user=]
[2022/06/22 14:02:38.185 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=2] [schemaVersion=37] [cur_db=] [sql="create database test_partition_1"] [user=]
[2022/06/22 14:02:38.191 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:80, Type:create schema, State:queueing, SchemaState:none, SchemaID:79, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.175 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:02:38.191 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:80, Type:create schema, State:queueing, SchemaState:none, SchemaID:79, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.175 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create database test_partition_1"]
[2022/06/22 14:02:38.192 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:80, Type:create schema, State:queueing, SchemaState:none, SchemaID:79, TableID:0, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:38.175 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.196 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=37] [neededSchemaVersion=38] ["start time"=412.257µs] [phyTblIDs="[]"] [actionTypes="[]"]
[2022/06/22 14:02:38.246 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=38] ["take time"=51.122823ms] [job="ID:80, Type:create schema, State:done, SchemaState:public, SchemaID:79, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.175 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.247 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:80, Type:create schema, State:synced, SchemaState:public, SchemaID:79, TableID:0, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:38.175 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.249 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=80]
[2022/06/22 14:02:38.249 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:02:38.249 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=2] [schemaVersion=38] [cur_db=test_partition_1] [sql="create table t1 (id int, a int, b int, unique key (a,b,id)) partition by list columns (b,a) (partition p0 values in ((1,1),(2,2),(3,3),(4,4),(5,5)), partition p1 values in ((6,6),(7,7),(8,8),(9,9),(10,10),(null,10)));"] [user=]
[2022/06/22 14:02:38.259 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:84, Type:create table, State:queueing, SchemaState:none, SchemaID:79, TableID:81, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.225 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:02:38.259 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:84, Type:create table, State:queueing, SchemaState:none, SchemaID:79, TableID:81, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.225 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t1 (id int, a int, b int, unique key (a,b,id)) partition by list columns (b,a) (partition p0 values in ((1,1),(2,2),(3,3),(4,4),(5,5)), partition p1 values in ((6,6),(7,7),(8,8),(9,9),(10,10),(null,10)));"]
[2022/06/22 14:02:38.260 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:84, Type:create table, State:queueing, SchemaState:none, SchemaID:79, TableID:81, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:38.225 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.266 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=38] [neededSchemaVersion=39] ["start time"=992.642µs] [phyTblIDs="[81,82,83]"] [actionTypes="[8,8,8]"]
[2022/06/22 14:02:38.315 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=39] ["take time"=51.159804ms] [job="ID:84, Type:create table, State:done, SchemaState:public, SchemaID:79, TableID:81, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.225 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.316 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:84, Type:create table, State:synced, SchemaState:public, SchemaID:79, TableID:81, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:38.225 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.320 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=84]
[2022/06/22 14:02:38.320 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:02:38.321 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=2] [schemaVersion=39] [cur_db=test_partition_1] [sql="create table t2 (id int, a int, b int, unique key (a,b,id)) partition by list columns (id,a,b) (partition p0 values in ((1,1,1),(2,2,2),(3,3,3),(4,4,4),(5,5,5)), partition p1 values in ((6,6,6),(7,7,7),(8,8,8),(9,9,9),(10,10,10),(null,null,null)));"] [user=]
[2022/06/22 14:02:38.328 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:88, Type:create table, State:queueing, SchemaState:none, SchemaID:79, TableID:85, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.276 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:02:38.328 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:88, Type:create table, State:queueing, SchemaState:none, SchemaID:79, TableID:85, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.276 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t2 (id int, a int, b int, unique key (a,b,id)) partition by list columns (id,a,b) (partition p0 values in ((1,1,1),(2,2,2),(3,3,3),(4,4,4),(5,5,5)), partition p1 values in ((6,6,6),(7,7,7),(8,8,8),(9,9,9),(10,10,10),(null,null,null)));"]
[2022/06/22 14:02:38.329 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:88, Type:create table, State:queueing, SchemaState:none, SchemaID:79, TableID:85, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:38.276 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.337 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=39] [neededSchemaVersion=40] ["start time"=1.347819ms] [phyTblIDs="[85,86,87]"] [actionTypes="[8,8,8]"]
[2022/06/22 14:02:38.386 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=40] ["take time"=51.764809ms] [job="ID:88, Type:create table, State:done, SchemaState:public, SchemaID:79, TableID:85, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.276 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.388 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:88, Type:create table, State:synced, SchemaState:public, SchemaID:79, TableID:85, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:38.276 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.391 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=88]
[2022/06/22 14:02:38.391 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:02:38.393 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=2] [startTS=434078419091718151] [checkTS=434078419091718152]
[2022/06/22 14:02:38.397 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=2] [startTS=434078419091718154] [checkTS=434078419091718155]
[2022/06/22 14:02:38.399 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=3] [schemaVersion=40] [cur_db=] [sql="drop database if exists test_partition_2;"] [user=]
[2022/06/22 14:02:38.400 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=3] [schemaVersion=40] [cur_db=] [sql="create database test_partition_2"] [user=]
[2022/06/22 14:02:38.406 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:90, Type:create schema, State:queueing, SchemaState:none, SchemaID:89, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.376 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:02:38.406 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:90, Type:create schema, State:queueing, SchemaState:none, SchemaID:89, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.376 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create database test_partition_2"]
[2022/06/22 14:02:38.407 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:90, Type:create schema, State:queueing, SchemaState:none, SchemaID:89, TableID:0, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:38.376 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.412 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=40] [neededSchemaVersion=41] ["start time"=473.926µs] [phyTblIDs="[]"] [actionTypes="[]"]
[2022/06/22 14:02:38.462 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=41] ["take time"=51.318192ms] [job="ID:90, Type:create schema, State:done, SchemaState:public, SchemaID:89, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.376 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.463 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:90, Type:create schema, State:synced, SchemaState:public, SchemaID:89, TableID:0, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:38.376 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.466 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=90]
[2022/06/22 14:02:38.466 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:02:38.466 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=3] [schemaVersion=41] [cur_db=test_partition_2] [sql="create table t1 (id int, a int, b int)"] [user=]
[2022/06/22 14:02:38.472 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:92, Type:create table, State:queueing, SchemaState:none, SchemaID:89, TableID:91, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.426 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:02:38.472 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:92, Type:create table, State:queueing, SchemaState:none, SchemaID:89, TableID:91, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.426 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t1 (id int, a int, b int)"]
[2022/06/22 14:02:38.474 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:92, Type:create table, State:queueing, SchemaState:none, SchemaID:89, TableID:91, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:38.426 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.480 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=41] [neededSchemaVersion=42] ["start time"=639.976µs] [phyTblIDs="[91]"] [actionTypes="[8]"]
[2022/06/22 14:02:38.531 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=42] ["take time"=51.888458ms] [job="ID:92, Type:create table, State:done, SchemaState:public, SchemaID:89, TableID:91, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.426 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.531 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:92, Type:create table, State:synced, SchemaState:public, SchemaID:89, TableID:91, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:38.426 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.535 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=92]
[2022/06/22 14:02:38.535 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:02:38.535 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=3] [schemaVersion=42] [cur_db=test_partition_2] [sql="create table t2 (id int, a int, b int)"] [user=]
[2022/06/22 14:02:38.541 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:94, Type:create table, State:queueing, SchemaState:none, SchemaID:89, TableID:93, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.526 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:02:38.541 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:94, Type:create table, State:queueing, SchemaState:none, SchemaID:89, TableID:93, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.526 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t2 (id int, a int, b int)"]
[2022/06/22 14:02:38.542 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:94, Type:create table, State:queueing, SchemaState:none, SchemaID:89, TableID:93, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:38.526 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.549 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=42] [neededSchemaVersion=43] ["start time"=529.856µs] [phyTblIDs="[93]"] [actionTypes="[8]"]
[2022/06/22 14:02:38.599 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=43] ["take time"=51.846118ms] [job="ID:94, Type:create table, State:done, SchemaState:public, SchemaID:89, TableID:93, RowCount:0, ArgLen:1, start time: 2022-06-22 14:02:38.526 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.600 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:94, Type:create table, State:synced, SchemaState:public, SchemaID:89, TableID:93, RowCount:0, ArgLen:0, start time: 2022-06-22 14:02:38.526 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:02:38.604 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=94]
[2022/06/22 14:02:38.604 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:02:38.607 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=3] [startTS=434078419143884807] [checkTS=434078419143884808]
[2022/06/22 14:02:38.611 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=3] [startTS=434078419143884810] [checkTS=434078419143884811]
[2022/06/22 14:02:38.615 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"]
[2022/06/22 14:02:38.615 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"]
[2022/06/22 14:02:38.615 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:02:38.616 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"] []
[2022/06/22 14:02:38.616 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=370ns]
[2022/06/22 14:02:38.616 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=140ns]
[2022/06/22 14:02:38.616 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:02:38.616 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:02:38.616 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=0acdfd88-a2f3-4e20-8017-4324607ed7fb] ["take time"=1.083502ms]
[2022/06/22 14:02:38.616 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=0acdfd88-a2f3-4e20-8017-4324607ed7fb]
[2022/06/22 14:02:38.617 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:02:38.617 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:02:38.617 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:02:38.617 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:02:38.617 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:02:38.617 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:02:38.617 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:02:38.617 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:02:38.617 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:02:38.617 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:02:38.617 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"]
[2022/06/22 14:02:38.617 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"]
[2022/06/22 14:02:38.617 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:02:38.617 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:02:38.617 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:02:38.617 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:02:38.617 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:02:38.617 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:02:38.617 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:02:38.617 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:02:38.617 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"]
[2022/06/22 14:02:38.617 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"]
[2022/06/22 14:02:38.617 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:02:38.617 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb watch owner key /tidb/stats/owner/2231818a01326456"]
[2022/06/22 14:02:38.617 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"]
[2022/06/22 14:02:38.617 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:02:38.618 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:37378->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:02:38.618 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"]
[2022/06/22 14:02:38.690 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"] [error="context canceled"]
[2022/06/22 14:02:38.890 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:02:41.134 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:02:41.134 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:02:41.140 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:02:41.140 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:02:41.427 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 0acdfd88-a2f3-4e20-8017-4324607ed7fb"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:02:41.427 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:02:41.427 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.811913329s]
[2022/06/22 14:02:41.427 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=6062805a6fc0002]
--- FAIL: TestListColumnsPartitionPruner (18.42s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				partition_pruner_test.go:396
        	Error:      	Not equal: 
        	            	expected: "[Sort 10000.00 root  test_partition.t1.id, test_partition.t1.a]\n[└─TableReader 10000.00 root partition:all data:TableFullScan]\n[  └─TableFullScan 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo]\n"
        	            	actual  : "[Sort 20000.00 root  test_partition.t1.id, test_partition.t1.a]\n[└─PartitionUnion 20000.00 root  ]\n[  ├─TableReader 10000.00 root  data:TableFullScan]\n[  │ └─TableFullScan 10000.00 cop[tikv] table:t1, partition:p0 keep order:false, stats:pseudo]\n[  └─TableReader 10000.00 root  data:TableFullScan]\n[    └─TableFullScan 10000.00 cop[tikv] table:t1, partition:p1 keep order:false, stats:pseudo]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,4 +1,7 @@
        	            	-[Sort 10000.00 root  test_partition.t1.id, test_partition.t1.a]
        	            	-[└─TableReader 10000.00 root partition:all data:TableFullScan]
        	            	-[  └─TableFullScan 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo]
        	            	+[Sort 20000.00 root  test_partition.t1.id, test_partition.t1.a]
        	            	+[└─PartitionUnion 20000.00 root  ]
        	            	+[  ├─TableReader 10000.00 root  data:TableFullScan]
        	            	+[  │ └─TableFullScan 10000.00 cop[tikv] table:t1, partition:p0 keep order:false, stats:pseudo]
        	            	+[  └─TableReader 10000.00 root  data:TableFullScan]
        	            	+[    └─TableFullScan 10000.00 cop[tikv] table:t1, partition:p1 keep order:false, stats:pseudo]
        	            	 
        	Test:       	TestListColumnsPartitionPruner
        	Messages:   	sql:explain format = 'brief' select * from t1 order by id,a, args:[]
FAIL
err=exit status 1
[2022/06/22 14:03:00.050 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:03:00.050 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:03:01.050 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:03:03.259 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 14:03:04.260 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:03:04.260 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:03:04.260 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:03:04.260 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:03:04.265 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:03:04.269 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=1025266] ["lease id"=2231818a01c32124]
[2022/06/22 14:03:04.271 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:03:04.280 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=6.967768ms]
[2022/06/22 14:03:04.281 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:03:04.281 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=b4a45484-c154-4c65-b773-ddca823c248e] [runWorker=true]
[2022/06/22 14:03:04.281 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:03:04.281 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:03:04.282 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:03:04.282 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:03:04.283 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"] [ownerID=b4a45484-c154-4c65-b773-ddca823c248e]
[2022/06/22 14:03:04.289 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:03:04.290 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:03:04.292 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"] [ownerID=b4a45484-c154-4c65-b773-ddca823c248e]
[2022/06/22 14:03:04.311 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:03:04.324 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:03:04.326 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:03:04.327 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:03:04.471 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:03:04.471 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:03:04.473 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=60628074dac0002]
[2022/06/22 14:03:04.475 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"] [ownerID=b4a45484-c154-4c65-b773-ddca823c248e]
[2022/06/22 14:03:04.475 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"] [ownerID=b4a45484-c154-4c65-b773-ddca823c248e]
[2022/06/22 14:03:04.477 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=6.654501ms]
[2022/06/22 14:03:04.508 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=60628074dac0002]
[2022/06/22 14:03:04.508 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t"] [user=]
[2022/06/22 14:03:04.508 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t (id int, c int) partition by range (id) (partition p0 values less than (4), partition p1 values less than (7))"] [user=]
[2022/06/22 14:03:04.519 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:03:04.476 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:03:04.519 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:03:04.476 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t (id int, c int) partition by range (id) (partition p0 values less than (4), partition p1 values less than (7))"]
[2022/06/22 14:03:04.520 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:03:04.476 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:03:04.528 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=1.41634ms] [phyTblIDs="[69,70,71]"] [actionTypes="[8,8,8]"]
[2022/06/22 14:03:04.577 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.846815ms] [job="ID:72, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:03:04.476 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:03:04.578 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:03:04.476 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:03:04.582 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=72]
[2022/06/22 14:03:04.582 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:03:04.585 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078425959890951] [checkTS=434078425959890952]
[2022/06/22 14:03:04.587 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"]
[2022/06/22 14:03:04.587 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"]
[2022/06/22 14:03:04.588 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"] []
[2022/06/22 14:03:04.588 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=430ns]
[2022/06/22 14:03:04.588 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=220ns]
[2022/06/22 14:03:04.588 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:03:04.588 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:03:04.588 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=b4a45484-c154-4c65-b773-ddca823c248e] ["take time"=968.143µs]
[2022/06/22 14:03:04.588 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=b4a45484-c154-4c65-b773-ddca823c248e]
[2022/06/22 14:03:04.589 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:03:04.589 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:03:04.589 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:03:04.589 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:03:04.589 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:03:04.589 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:03:04.589 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:03:04.589 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:03:04.589 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:03:04.589 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:03:04.589 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"]
[2022/06/22 14:03:04.589 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"]
[2022/06/22 14:03:04.589 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:03:04.589 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:03:04.590 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:03:04.590 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:03:04.590 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:03:04.590 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:03:04.590 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:03:04.590 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:03:04.590 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"]
[2022/06/22 14:03:04.590 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"]
[2022/06/22 14:03:04.590 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:03:04.590 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager b4a45484-c154-4c65-b773-ddca823c248e watch owner key /tidb/stats/owner/2231818a01c32148"]
[2022/06/22 14:03:04.590 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"]
[2022/06/22 14:03:04.590 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:03:04.590 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:37444->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:03:04.590 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"]
[2022/06/22 14:03:04.607 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"] [error="context canceled"]
[2022/06/22 14:03:04.808 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:03:07.116 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:03:07.116 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:03:07.131 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:03:07.131 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:03:07.341 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager b4a45484-c154-4c65-b773-ddca823c248e"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:03:07.341 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:03:07.341 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.753435542s]
[2022/06/22 14:03:07.341 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=60628074dac0002]
[2022/06/22 14:03:07.341 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 14:03:07.341 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestIssue20139 (7.29s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				integration_test.go:3487
        	Error:      	Not equal: 
        	            	expected: "[TableReader 0.01 root partition:p0 data:Selection]\n[└─Selection 0.01 cop[tikv]  eq(test.t.c, 1), eq(test.t.id, 1)]\n[  └─TableFullScan 10000.00 cop[tikv] table:t keep order:false, stats:pseudo]\n"
        	            	actual  : "[TableReader 0.01 root  data:Selection]\n[└─Selection 0.01 cop[tikv]  eq(test.t.c, 1), eq(test.t.id, 1)]\n[  └─TableFullScan 10000.00 cop[tikv] table:t, partition:p0 keep order:false, stats:pseudo]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,4 +1,4 @@
        	            	-[TableReader 0.01 root partition:p0 data:Selection]
        	            	+[TableReader 0.01 root  data:Selection]
        	            	 [└─Selection 0.01 cop[tikv]  eq(test.t.c, 1), eq(test.t.id, 1)]
        	            	-[  └─TableFullScan 10000.00 cop[tikv] table:t keep order:false, stats:pseudo]
        	            	+[  └─TableFullScan 10000.00 cop[tikv] table:t, partition:p0 keep order:false, stats:pseudo]
        	            	 
        	Test:       	TestIssue20139
        	Messages:   	sql:explain format = 'brief' select * from t where c = 1 and id = c, args:[]
FAIL
err=exit status 1
[2022/06/22 14:08:42.853 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:08:42.854 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:08:43.854 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:08:46.076 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 14:08:47.077 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:08:47.077 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:08:47.077 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:08:47.077 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:08:47.081 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:08:47.091 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=2401882] ["lease id"=2231818a06fe3d24]
[2022/06/22 14:08:47.093 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:08:47.104 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=7.630725ms]
[2022/06/22 14:08:47.104 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:08:47.104 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=2856a3ef-4a9e-4a88-9047-9b0d09362ba8] [runWorker=true]
[2022/06/22 14:08:47.104 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:08:47.105 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:08:47.105 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:08:47.105 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:08:47.107 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"] [ownerID=2856a3ef-4a9e-4a88-9047-9b0d09362ba8]
[2022/06/22 14:08:47.111 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:08:47.111 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:08:47.113 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"] [ownerID=2856a3ef-4a9e-4a88-9047-9b0d09362ba8]
[2022/06/22 14:08:47.128 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:08:47.144 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:08:47.146 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:08:47.146 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:08:47.312 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:08:47.313 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:08:47.314 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=606281c3aec0002]
[2022/06/22 14:08:47.317 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"] [ownerID=2856a3ef-4a9e-4a88-9047-9b0d09362ba8]
[2022/06/22 14:08:47.317 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"] [ownerID=2856a3ef-4a9e-4a88-9047-9b0d09362ba8]
[2022/06/22 14:08:47.318 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=5.495906ms]
[2022/06/22 14:08:47.343 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=606281c3aec0002]
[2022/06/22 14:08:47.343 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t1, t2, t3"] [user=]
[2022/06/22 14:08:47.344 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t1(a int, b int)"] [user=]
[2022/06/22 14:08:47.350 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:08:47.341 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:08:47.350 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:08:47.341 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t1(a int, b int)"]
[2022/06/22 14:08:47.351 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:08:47.341 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:08:47.357 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=658.946µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 14:08:47.408 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.782564ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:08:47.341 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:08:47.409 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:08:47.341 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:08:47.412 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:08:47.412 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:08:47.412 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="create table t2(a int, b int)"] [user=]
[2022/06/22 14:08:47.417 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:08:47.391 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:08:47.417 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:08:47.391 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t2(a int, b int)"]
[2022/06/22 14:08:47.418 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:08:47.391 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:08:47.428 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=631.486µs] [phyTblIDs="[71]"] [actionTypes="[8]"]
[2022/06/22 14:08:47.478 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.237328ms] [job="ID:72, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:08:47.391 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:08:47.479 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:08:47.391 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:08:47.481 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=72]
[2022/06/22 14:08:47.481 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:08:47.482 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=36] [cur_db=test] [sql="create table t3(a int, b int, index c(b))"] [user=]
[2022/06/22 14:08:47.487 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 14:08:47.441 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:08:47.487 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 14:08:47.441 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t3(a int, b int, index c(b))"]
[2022/06/22 14:08:47.489 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:0, start time: 2022-06-22 14:08:47.441 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:08:47.495 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=36] [neededSchemaVersion=37] ["start time"=612.667µs] [phyTblIDs="[73]"] [actionTypes="[8]"]
[2022/06/22 14:08:47.545 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=37] ["take time"=51.12757ms] [job="ID:74, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 14:08:47.441 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:08:47.546 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:73, RowCount:0, ArgLen:0, start time: 2022-06-22 14:08:47.441 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:08:47.549 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=74]
[2022/06/22 14:08:47.549 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:08:47.551 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078515866107911] [checkTS=434078515866107912]
[2022/06/22 14:08:47.559 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078515866107916] [checkTS=434078515866107917]
[2022/06/22 14:08:47.564 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078515866107921] [checkTS=434078515866107922]
[2022/06/22 14:08:47.605 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t1` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:08:47.577 +08:00] ["end time"=2022/06/22 14:08:47.600 +08:00] [cost=22.95662ms]
[2022/06/22 14:08:47.655 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t2` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:08:47.630 +08:00] ["end time"=2022/06/22 14:08:47.650 +08:00] [cost=19.964868ms]
[2022/06/22 14:08:47.700 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t3` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:08:47.671 +08:00] ["end time"=2022/06/22 14:08:47.696 +08:00] [cost=25.109978ms]
[2022/06/22 14:08:47.713 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"]
[2022/06/22 14:08:47.713 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"]
[2022/06/22 14:08:47.714 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"] []
[2022/06/22 14:08:47.714 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=450ns]
[2022/06/22 14:08:47.714 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=150ns]
[2022/06/22 14:08:47.714 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:08:47.714 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:08:47.714 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=2856a3ef-4a9e-4a88-9047-9b0d09362ba8] ["take time"=1.054264ms]
[2022/06/22 14:08:47.714 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=2856a3ef-4a9e-4a88-9047-9b0d09362ba8]
[2022/06/22 14:08:47.715 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:08:47.715 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:08:47.715 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"]
[2022/06/22 14:08:47.715 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"]
[2022/06/22 14:08:47.715 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:08:47.715 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:08:47.715 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:08:47.715 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:08:47.715 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:08:47.715 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:08:47.715 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:08:47.715 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:08:47.715 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:08:47.715 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:08:47.715 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:08:47.715 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"]
[2022/06/22 14:08:47.715 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"]
[2022/06/22 14:08:47.715 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:08:47.715 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:08:47.715 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:08:47.715 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:08:47.715 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:08:47.715 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8 watch owner key /tidb/stats/owner/2231818a06fe3d46"]
[2022/06/22 14:08:47.715 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"]
[2022/06/22 14:08:47.716 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:08:47.716 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:38530->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:08:47.716 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"]
[2022/06/22 14:08:47.734 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"] [error="context canceled"]
[2022/06/22 14:08:47.935 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:08:50.240 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:08:50.240 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:08:50.264 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:08:50.264 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:08:50.459 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 2856a3ef-4a9e-4a88-9047-9b0d09362ba8"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:08:50.459 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:08:50.459 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.745500252s]
[2022/06/22 14:08:50.459 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=606281c3aec0002]
[2022/06/22 14:08:50.459 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 14:08:50.459 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestVerboseExplain (7.61s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				integration_test.go:515
        	Error:      	Not equal: 
        	            	expected: "[StreamAgg_20 1.00 12.68 root  funcs:count(Column#9)->Column#4]\n[└─TableReader_21 1.00 9.68 root  data:StreamAgg_8]\n[  └─StreamAgg_8 1.00 117.00 cop[tikv]  funcs:count(1)->Column#9]\n[    └─TableFullScan_18 3.00 108.00 cop[tikv] table:t3 keep order:false]\n"
        	            	actual  : "[StreamAgg_20 1.00 16.88 root  funcs:count(Column#9)->Column#4]\n[└─TableReader_21 1.00 13.88 root  data:StreamAgg_8]\n[  └─StreamAgg_8 1.00 180.00 cop[tikv]  funcs:count(1)->Column#9]\n[    └─TableFullScan_18 3.00 171.00 cop[tikv] table:t3 keep order:false]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,5 +1,5 @@
        	            	-[StreamAgg_20 1.00 12.68 root  funcs:count(Column#9)->Column#4]
        	            	-[└─TableReader_21 1.00 9.68 root  data:StreamAgg_8]
        	            	-[  └─StreamAgg_8 1.00 117.00 cop[tikv]  funcs:count(1)->Column#9]
        	            	-[    └─TableFullScan_18 3.00 108.00 cop[tikv] table:t3 keep order:false]
        	            	+[StreamAgg_20 1.00 16.88 root  funcs:count(Column#9)->Column#4]
        	            	+[└─TableReader_21 1.00 13.88 root  data:StreamAgg_8]
        	            	+[  └─StreamAgg_8 1.00 180.00 cop[tikv]  funcs:count(1)->Column#9]
        	            	+[    └─TableFullScan_18 3.00 171.00 cop[tikv] table:t3 keep order:false]
        	            	 
        	Test:       	TestVerboseExplain
        	Messages:   	sql:explain format = 'verbose' select count(*) from t3, args:[]
FAIL
err=exit status 1
[2022/06/22 14:21:22.695 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:21:22.695 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:21:23.695 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:21:27.696 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING: error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING"]
[2022/06/22 14:21:28.698 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:21:28.698 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:21:28.698 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:21:28.698 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:21:30.702 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:21:30.711 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=399169] ["lease id"=2231818a12965d27]
[2022/06/22 14:21:30.713 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:21:36.705 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=4.005526849s]
[2022/06/22 14:21:36.706 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:21:36.706 +08:00] [WARN] [domain.go:449] ["loading schema takes a long time"] ["take time"=5.991123762s]
[2022/06/22 14:21:36.706 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=448d5793-ef70-47d6-9ceb-fd713a335334] [runWorker=true]
[2022/06/22 14:21:36.706 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:21:36.710 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:21:36.710 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:21:36.710 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:21:36.712 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"] [ownerID=448d5793-ef70-47d6-9ceb-fd713a335334]
[2022/06/22 14:21:36.716 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:21:36.716 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:21:36.717 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"] [ownerID=448d5793-ef70-47d6-9ceb-fd713a335334]
[2022/06/22 14:21:36.731 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:21:36.985 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:21:36.988 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:21:36.988 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:21:37.154 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:21:37.154 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:21:37.158 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=3.676172ms]
[2022/06/22 14:21:37.159 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=606284b37940004]
[2022/06/22 14:21:37.160 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"] [ownerID=448d5793-ef70-47d6-9ceb-fd713a335334]
[2022/06/22 14:21:37.160 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"] [ownerID=448d5793-ef70-47d6-9ceb-fd713a335334]
[2022/06/22 14:21:37.667 +08:00] [WARN] [adapter.go:1095] ["# Txn_start_ts: 434078717607936009\n# Query_time: 0.505614823\n# Parse_time: 0\n# Compile_time: 0.000084151\n# Rewrite_time: 0.00001767\n# Optimize_time: 0\n# Wait_TS: 0.000095641\n# Prewrite_time: 0.00265757 Commit_time: 0.00174834 Get_commit_ts_time: 0.000099091 Write_keys: 1 Write_size: 109 Prewrite_region: 1\n# Is_internal: true\n# Digest: 61f4cce222f1a26d6b0650865051ebed3d077412ae053636e2f5acf9dc426a42\n# Num_cop_tasks: 0\n# Mem_max: 403\n# Prepared: false\n# Plan_from_cache: false\n# Plan_from_binding: false\n# Has_more_results: false\n# KV_total: 0\n# PD_total: 0\n# Backoff_total: 0\n# Write_sql_response_total: 0\n# Result_rows: 0\n# Succ: true\n# IsExplicitTxn: false\n# Plan: tidb_decode_plan('iwTQMAkyN18xCTAJMAlOL0EJMAl0aW1lOjYwOMK1cywgbG9vcHM6MSwgcHJlcGFyZTogMTA4LjUFHFBjaGVja19pbnNlcnQ6IHt0b3RhbF8FPgwgNDk5DSUIbWVtDSMRGwQ0LglbOHByZWZldGNoOiA0NTQuNgVTSHJwYzp7QmF0Y2hHZXQ6e251bV8BEwgyLCAdXlQ0MjUuMsK1c30sIHNjYW5fZGV0YWlsFYI0cHJvY2Vzc19rZXlzOiAVOy4XACRfc2l6ZTogMjA4EVkVLZhyb2Nrc2RiOiB7ZGVsZXRlX3NraXBwZWRfY291bnQ6IDAsIGtleV9GFgBAYmxvY2s6IHtjYWNoZV9oaXQRMhgxMiwgcmVhLkIABQ80Ynl0ZTogMCBCeXRlc30BAZAsIGNvbW1pdF90eG46IHtwcmV3cml0ZToyLjY2bXMsIGdldF9jDSIUczo5OS4xJTUJNRA6MS43NQEmJHJlZ2lvbl9udW0huAVCCd8EMSwNDgV6SDEwOX0JNDAzIEJ5dGVzCU4vQQo=')\nINSERT HIGH_PRIORITY INTO mysql.tidb VALUES ('tikv_gc_leader_uuid', '606284b37940004', 'Current GC worker leader UUID. (DO NOT EDIT)')           ON DUPLICATE KEY           UPDATE variable_value = '606284b37940004', comment = 'Current GC worker leader UUID. (DO NOT EDIT)';"]
[2022/06/22 14:21:37.685 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=606284b37940004]
[2022/06/22 14:21:37.686 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t, t1, t2, t3, t4, t5, t6, t7, t8;"] [user=]
[2022/06/22 14:21:37.686 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t(a int, b int, key(a));"] [user=]
[2022/06/22 14:21:37.693 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.675 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:21:37.693 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.675 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t(a int, b int, key(a));"]
[2022/06/22 14:21:37.694 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:37.675 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:37.699 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=609.107µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 14:21:37.749 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=50.972996ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.675 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:37.750 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:37.675 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:37.753 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:21:37.753 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:21:37.753 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="create table t1(a int, b int, key(a));"] [user=]
[2022/06/22 14:21:37.758 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.725 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:21:37.758 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.725 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t1(a int, b int, key(a));"]
[2022/06/22 14:21:37.759 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:37.725 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:37.765 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=571.097µs] [phyTblIDs="[71]"] [actionTypes="[8]"]
[2022/06/22 14:21:37.815 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.39675ms] [job="ID:72, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.725 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:37.816 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:37.725 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:37.819 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=72]
[2022/06/22 14:21:37.819 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:21:37.819 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=36] [cur_db=test] [sql="create table t2(a int, b int, key(a));"] [user=]
[2022/06/22 14:21:37.825 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.775 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:21:37.825 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.775 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t2(a int, b int, key(a));"]
[2022/06/22 14:21:37.826 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:37.775 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:37.832 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=36] [neededSchemaVersion=37] ["start time"=595.037µs] [phyTblIDs="[73]"] [actionTypes="[8]"]
[2022/06/22 14:21:37.881 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=37] ["take time"=50.894455ms] [job="ID:74, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.775 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:37.882 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:73, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:37.775 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:37.885 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=74]
[2022/06/22 14:21:37.885 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:21:37.886 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=37] [cur_db=test] [sql="create table t3(a int, b int, key(a));"] [user=]
[2022/06/22 14:21:37.890 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:76, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.875 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:21:37.890 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:76, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.875 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t3(a int, b int, key(a));"]
[2022/06/22 14:21:37.892 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:76, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:37.875 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:37.897 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=37] [neededSchemaVersion=38] ["start time"=639.137µs] [phyTblIDs="[75]"] [actionTypes="[8]"]
[2022/06/22 14:21:37.947 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=38] ["take time"=51.540561ms] [job="ID:76, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.875 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:37.949 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:76, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:37.875 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:37.951 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=76]
[2022/06/22 14:21:37.951 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:21:37.952 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=38] [cur_db=test] [sql="create table t4(a int, b int, key(a));"] [user=]
[2022/06/22 14:21:37.956 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:77, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.926 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:21:37.956 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:77, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.926 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t4(a int, b int, key(a));"]
[2022/06/22 14:21:37.957 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:77, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:37.926 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:37.963 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=38] [neededSchemaVersion=39] ["start time"=661.878µs] [phyTblIDs="[77]"] [actionTypes="[8]"]
[2022/06/22 14:21:38.013 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=39] ["take time"=50.982675ms] [job="ID:78, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:77, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.926 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:38.014 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:78, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:77, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:37.926 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:38.017 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=78]
[2022/06/22 14:21:38.017 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:21:38.017 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=39] [cur_db=test] [sql="create table t5(a int, b int, key(a));"] [user=]
[2022/06/22 14:21:38.022 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:80, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:79, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.976 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:21:38.022 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:80, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:79, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.976 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t5(a int, b int, key(a));"]
[2022/06/22 14:21:38.023 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:80, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:79, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:37.976 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:38.029 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=39] [neededSchemaVersion=40] ["start time"=559.736µs] [phyTblIDs="[79]"] [actionTypes="[8]"]
[2022/06/22 14:21:38.078 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=40] ["take time"=50.916074ms] [job="ID:80, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:79, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:37.976 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:38.080 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:80, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:79, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:37.976 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:38.082 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=80]
[2022/06/22 14:21:38.083 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:21:38.083 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=40] [cur_db=test] [sql="create table t6(a int, b int, key(a));"] [user=]
[2022/06/22 14:21:38.087 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:82, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:81, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:38.075 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:21:38.087 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:82, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:81, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:38.075 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t6(a int, b int, key(a));"]
[2022/06/22 14:21:38.088 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:82, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:81, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:38.075 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:38.093 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=40] [neededSchemaVersion=41] ["start time"=606.656µs] [phyTblIDs="[81]"] [actionTypes="[8]"]
[2022/06/22 14:21:38.143 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=41] ["take time"=51.424908ms] [job="ID:82, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:81, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:38.075 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:38.145 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:82, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:81, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:38.075 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:38.148 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=82]
[2022/06/22 14:21:38.148 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:21:38.148 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=41] [cur_db=test] [sql="create table t7(a int, b int, key(a));"] [user=]
[2022/06/22 14:21:38.153 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:84, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:83, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:38.125 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:21:38.153 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:84, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:83, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:38.125 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t7(a int, b int, key(a));"]
[2022/06/22 14:21:38.154 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:84, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:83, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:38.125 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:38.160 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=41] [neededSchemaVersion=42] ["start time"=740.578µs] [phyTblIDs="[83]"] [actionTypes="[8]"]
[2022/06/22 14:21:38.210 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=42] ["take time"=52.119006ms] [job="ID:84, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:83, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:38.125 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:38.211 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:84, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:83, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:38.125 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:38.214 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=84]
[2022/06/22 14:21:38.214 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:21:38.214 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=42] [cur_db=test] [sql="create table t8(a int, b int, key(a));"] [user=]
[2022/06/22 14:21:38.219 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:86, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:85, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:38.176 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:21:38.220 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:86, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:85, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:38.176 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t8(a int, b int, key(a));"]
[2022/06/22 14:21:38.220 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:86, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:85, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:38.176 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:38.226 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=42] [neededSchemaVersion=43] ["start time"=620.037µs] [phyTblIDs="[85]"] [actionTypes="[8]"]
[2022/06/22 14:21:38.275 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=43] ["take time"=50.988674ms] [job="ID:86, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:85, RowCount:0, ArgLen:1, start time: 2022-06-22 14:21:38.176 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:38.276 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:86, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:85, RowCount:0, ArgLen:0, start time: 2022-06-22 14:21:38.176 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:21:38.280 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=86]
[2022/06/22 14:21:38.280 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:21:38.282 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078717909401607] [checkTS=434078717909401608]
[2022/06/22 14:21:38.323 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t3` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:21:38.291 +08:00] ["end time"=2022/06/22 14:21:38.319 +08:00] [cost=27.696717ms]
[2022/06/22 14:21:38.397 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"]
[2022/06/22 14:21:38.397 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"]
[2022/06/22 14:21:38.398 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"] []
[2022/06/22 14:21:38.398 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=200ns]
[2022/06/22 14:21:38.398 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=230ns]
[2022/06/22 14:21:38.398 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:21:38.398 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:21:38.398 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=448d5793-ef70-47d6-9ceb-fd713a335334] ["take time"=1.025372ms]
[2022/06/22 14:21:38.398 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=448d5793-ef70-47d6-9ceb-fd713a335334]
[2022/06/22 14:21:38.399 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:21:38.399 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:21:38.399 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:21:38.399 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:21:38.399 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:21:38.399 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:21:38.399 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:21:38.399 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:21:38.399 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:21:38.399 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"]
[2022/06/22 14:21:38.399 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"]
[2022/06/22 14:21:38.399 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:21:38.399 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:21:38.399 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:21:38.399 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:21:38.399 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"]
[2022/06/22 14:21:38.399 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"]
[2022/06/22 14:21:38.399 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:21:38.399 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:21:38.399 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:21:38.399 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:21:38.399 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:21:38.399 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334 watch owner key /tidb/stats/owner/2231818a12965d55"]
[2022/06/22 14:21:38.399 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"]
[2022/06/22 14:21:38.400 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:21:38.400 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:40798->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:21:38.400 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"]
[2022/06/22 14:21:38.410 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"] [error="context canceled"]
[2022/06/22 14:21:38.610 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:21:40.925 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:21:40.925 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:21:40.939 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:21:40.940 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:21:41.131 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 448d5793-ef70-47d6-9ceb-fd713a335334"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:21:41.131 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:21:41.131 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.733933413s]
[2022/06/22 14:21:41.131 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=606284b37940004]
[2022/06/22 14:21:41.131 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 14:21:41.131 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestJoinOrderHint4Subquery (18.44s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				rule_join_reorder_test.go:44
        	            				rule_join_reorder_test.go:330
        	Error:      	Not equal: 
        	            	expected: "[HashJoin 9990.00 root  CARTESIAN anti semi join, other cond:eq(test.t1.a, test.t3.a)]\n[├─TableReader(Build) 3.00 root  data:TableFullScan]\n[│ └─TableFullScan 3.00 cop[tikv] table:t3 keep order:false]\n[└─HashJoin(Probe) 12487.50 root  inner join, equal:[eq(test.t1.a, test.t2.a)]]\n[  ├─TableReader(Build) 9990.00 root  data:Selection]\n[  │ └─Selection 9990.00 cop[tikv]  not(isnull(test.t2.a))]\n[  │   └─TableFullScan 10000.00 cop[tikv] table:t2 keep order:false, stats:pseudo]\n[  └─TableReader(Probe) 9990.00 root  data:Selection]\n[    └─Selection 9990.00 cop[tikv]  not(isnull(test.t1.a))]\n[      └─TableFullScan 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo]\n"
        	            	actual  : "[HashJoin 9990.00 root  CARTESIAN anti semi join, other cond:eq(test.t1.a, test.t3.a)]\n[├─IndexReader(Build) 3.00 root  index:IndexFullScan]\n[│ └─IndexFullScan 3.00 cop[tikv] table:t3, index:a(a) keep order:false]\n[└─HashJoin(Probe) 12487.50 root  inner join, equal:[eq(test.t1.a, test.t2.a)]]\n[  ├─TableReader(Build) 9990.00 root  data:Selection]\n[  │ └─Selection 9990.00 cop[tikv]  not(isnull(test.t2.a))]\n[  │   └─TableFullScan 10000.00 cop[tikv] table:t2 keep order:false, stats:pseudo]\n[  └─TableReader(Probe) 9990.00 root  data:Selection]\n[    └─Selection 9990.00 cop[tikv]  not(isnull(test.t1.a))]\n[      └─TableFullScan 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,4 +1,4 @@
        	            	 [HashJoin 9990.00 root  CARTESIAN anti semi join, other cond:eq(test.t1.a, test.t3.a)]
        	            	-[├─TableReader(Build) 3.00 root  data:TableFullScan]
        	            	-[│ └─TableFullScan 3.00 cop[tikv] table:t3 keep order:false]
        	            	+[├─IndexReader(Build) 3.00 root  index:IndexFullScan]
        	            	+[│ └─IndexFullScan 3.00 cop[tikv] table:t3, index:a(a) keep order:false]
        	            	 [└─HashJoin(Probe) 12487.50 root  inner join, equal:[eq(test.t1.a, test.t2.a)]]
        	Test:       	TestJoinOrderHint4Subquery
        	Messages:   	sql:explain format = 'brief' select /*+ straight_join() */ * from t1 join t2 on t1.a=t2.a where t1.a not in (select t3.a from t3), args:[]
FAIL
err=exit status 1
[2022/06/22 14:28:52.617 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:28:52.617 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:28:53.618 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:28:57.348 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 14:28:58.349 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:28:58.349 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:28:58.349 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:28:58.349 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:28:58.353 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:28:58.359 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=3061259] ["lease id"=2231818a1973ea24]
[2022/06/22 14:28:58.361 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:28:58.372 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=7.034075ms]
[2022/06/22 14:28:58.373 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:28:58.373 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=b6d08440-d2cf-4f45-aaf5-40966ea5e4b3] [runWorker=true]
[2022/06/22 14:28:58.373 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:28:58.373 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:28:58.373 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:28:58.373 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:28:58.375 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"] [ownerID=b6d08440-d2cf-4f45-aaf5-40966ea5e4b3]
[2022/06/22 14:28:58.379 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:28:58.379 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:28:58.380 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"] [ownerID=b6d08440-d2cf-4f45-aaf5-40966ea5e4b3]
[2022/06/22 14:28:58.400 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:28:58.418 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:28:58.422 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:28:58.422 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:28:58.594 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:28:58.594 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:28:58.595 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=606286629080002]
[2022/06/22 14:28:58.597 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"] [ownerID=b6d08440-d2cf-4f45-aaf5-40966ea5e4b3]
[2022/06/22 14:28:58.597 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"] [ownerID=b6d08440-d2cf-4f45-aaf5-40966ea5e4b3]
[2022/06/22 14:28:58.599 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=4.993561ms]
[2022/06/22 14:28:58.621 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=606286629080002]
[2022/06/22 14:28:58.622 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t"] [user=]
[2022/06/22 14:28:58.622 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t(a int(11) not null, b int) partition by range (a) (partition p0 values less than (4), partition p1 values less than(10), partition p2 values less than maxvalue);"] [user=]
[2022/06/22 14:28:58.630 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:73, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:28:58.611 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:28:58.630 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:73, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:28:58.611 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t(a int(11) not null, b int) partition by range (a) (partition p0 values less than (4), partition p1 values less than(10), partition p2 values less than maxvalue);"]
[2022/06/22 14:28:58.631 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:73, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:28:58.611 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:28:58.637 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=1.034237ms] [phyTblIDs="[69,70,71,72]"] [actionTypes="[8,8,8,8]"]
[2022/06/22 14:28:58.686 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.358594ms] [job="ID:73, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:28:58.611 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:28:58.687 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:73, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:28:58.611 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:28:58.690 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=73]
[2022/06/22 14:28:58.690 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:28:58.693 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078833354211335] [checkTS=434078833354211336]
[2022/06/22 14:28:58.695 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"]
[2022/06/22 14:28:58.695 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"]
[2022/06/22 14:28:58.696 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"] []
[2022/06/22 14:28:58.696 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=120ns]
[2022/06/22 14:28:58.696 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=290ns]
[2022/06/22 14:28:58.696 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:28:58.696 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:28:58.696 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=b6d08440-d2cf-4f45-aaf5-40966ea5e4b3] ["take time"=998.266µs]
[2022/06/22 14:28:58.696 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=b6d08440-d2cf-4f45-aaf5-40966ea5e4b3]
[2022/06/22 14:28:58.697 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:28:58.697 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"]
[2022/06/22 14:28:58.697 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"]
[2022/06/22 14:28:58.697 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:28:58.697 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"]
[2022/06/22 14:28:58.697 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"]
[2022/06/22 14:28:58.697 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3 watch owner key /tidb/stats/owner/2231818a1973ea47"]
[2022/06/22 14:28:58.697 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"]
[2022/06/22 14:28:58.697 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:28:58.697 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:42132->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:28:58.697 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"]
[2022/06/22 14:28:58.715 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"] [error="context canceled"]
[2022/06/22 14:28:58.915 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:29:01.224 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:29:01.224 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:29:01.244 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:29:01.244 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:29:01.431 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager b6d08440-d2cf-4f45-aaf5-40966ea5e4b3"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:29:01.431 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:29:01.431 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.735886749s]
[2022/06/22 14:29:01.431 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=606286629080002]
[2022/06/22 14:29:01.431 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 14:29:01.431 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestPartitionPruningForInExpr (8.81s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				integration_test.go:1476
        	Error:      	Not equal: 
        	            	expected: "[TableReader 30.00 root partition:p0,p2 data:Selection]\n[└─Selection 30.00 cop[tikv]  in(test.t.a, 1, 2, 11)]\n[  └─TableFullScan 10000.00 cop[tikv] table:t keep order:false, stats:pseudo]\n"
        	            	actual  : "[PartitionUnion 60.00 root  ]\n[├─TableReader 30.00 root  data:Selection]\n[│ └─Selection 30.00 cop[tikv]  in(test.t.a, 1, 2, 11)]\n[│   └─TableFullScan 10000.00 cop[tikv] table:t, partition:p0 keep order:false, stats:pseudo]\n[└─TableReader 30.00 root  data:Selection]\n[  └─Selection 30.00 cop[tikv]  in(test.t.a, 1, 2, 11)]\n[    └─TableFullScan 10000.00 cop[tikv] table:t, partition:p2 keep order:false, stats:pseudo]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,4 +1,8 @@
        	            	-[TableReader 30.00 root partition:p0,p2 data:Selection]
        	            	-[└─Selection 30.00 cop[tikv]  in(test.t.a, 1, 2, 11)]
        	            	-[  └─TableFullScan 10000.00 cop[tikv] table:t keep order:false, stats:pseudo]
        	            	+[PartitionUnion 60.00 root  ]
        	            	+[├─TableReader 30.00 root  data:Selection]
        	            	+[│ └─Selection 30.00 cop[tikv]  in(test.t.a, 1, 2, 11)]
        	            	+[│   └─TableFullScan 10000.00 cop[tikv] table:t, partition:p0 keep order:false, stats:pseudo]
        	            	+[└─TableReader 30.00 root  data:Selection]
        	            	+[  └─Selection 30.00 cop[tikv]  in(test.t.a, 1, 2, 11)]
        	            	+[    └─TableFullScan 10000.00 cop[tikv] table:t, partition:p2 keep order:false, stats:pseudo]
        	            	 
        	Test:       	TestPartitionPruningForInExpr
        	Messages:   	sql:explain format = 'brief' select * from t where a in (1, 2,'11'), args:[]
FAIL
err=exit status 1
[2022/06/22 14:31:40.773 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:31:40.774 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:31:41.774 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:31:43.983 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 14:31:44.984 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:31:44.984 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:31:44.984 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:31:44.984 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:31:44.989 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:31:44.996 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=2932123] ["lease id"=2231818a1c04b124]
[2022/06/22 14:31:44.999 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:31:45.008 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=7.080386ms]
[2022/06/22 14:31:45.009 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:31:45.009 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=90c741cf-9417-4b6a-969a-2669b939044b] [runWorker=true]
[2022/06/22 14:31:45.009 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:31:45.009 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:31:45.009 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:31:45.010 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:31:45.011 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"] [ownerID=90c741cf-9417-4b6a-969a-2669b939044b]
[2022/06/22 14:31:45.015 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:31:45.015 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:31:45.016 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"] [ownerID=90c741cf-9417-4b6a-969a-2669b939044b]
[2022/06/22 14:31:45.038 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:31:45.052 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:31:45.054 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:31:45.054 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:31:45.212 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:31:45.213 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:31:45.214 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=606287054ac0002]
[2022/06/22 14:31:45.216 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"] [ownerID=90c741cf-9417-4b6a-969a-2669b939044b]
[2022/06/22 14:31:45.216 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"] [ownerID=90c741cf-9417-4b6a-969a-2669b939044b]
[2022/06/22 14:31:45.217 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=4.965796ms]
[2022/06/22 14:31:45.242 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=606287054ac0002]
[2022/06/22 14:31:45.243 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t1, t2"] [user=]
[2022/06/22 14:31:45.243 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t1(a int not null, b int not null, key(a,b))"] [user=]
[2022/06/22 14:31:45.250 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:31:45.246 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:31:45.250 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:31:45.246 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t1(a int not null, b int not null, key(a,b))"]
[2022/06/22 14:31:45.251 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:31:45.246 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:31:45.256 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=620.263µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 14:31:45.306 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.183029ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:31:45.246 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:31:45.307 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:31:45.246 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:31:45.310 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:31:45.310 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:31:45.312 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078877036314631] [checkTS=434078877036314632]
[2022/06/22 14:31:45.314 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="create table t2(a int not null, b int not null, key(a,b))"] [user=]
[2022/06/22 14:31:45.319 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:31:45.296 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:31:45.319 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:31:45.296 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t2(a int not null, b int not null, key(a,b))"]
[2022/06/22 14:31:45.320 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:31:45.296 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:31:45.326 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=659.473µs] [phyTblIDs="[71]"] [actionTypes="[8]"]
[2022/06/22 14:31:45.376 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.382748ms] [job="ID:72, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:31:45.296 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:31:45.377 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:31:45.296 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:31:45.380 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=72]
[2022/06/22 14:31:45.380 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:31:45.382 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078877049421831] [checkTS=434078877049421832]
[2022/06/22 14:31:45.423 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t1` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:31:45.392 +08:00] ["end time"=2022/06/22 14:31:45.418 +08:00] [cost=26.760921ms]
[2022/06/22 14:31:45.476 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t2` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:31:45.444 +08:00] ["end time"=2022/06/22 14:31:45.472 +08:00] [cost=27.978157ms]
[2022/06/22 14:31:45.492 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"]
[2022/06/22 14:31:45.492 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"]
[2022/06/22 14:31:45.492 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:31:45.493 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"] []
[2022/06/22 14:31:45.494 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=360ns]
[2022/06/22 14:31:45.494 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=160ns]
[2022/06/22 14:31:45.494 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:31:45.494 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:31:45.494 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=90c741cf-9417-4b6a-969a-2669b939044b] ["take time"=2.699694ms]
[2022/06/22 14:31:45.494 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=90c741cf-9417-4b6a-969a-2669b939044b]
[2022/06/22 14:31:45.495 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:31:45.495 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:31:45.495 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:31:45.495 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:31:45.495 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:31:45.495 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:31:45.495 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:31:45.495 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:31:45.495 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:31:45.495 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:31:45.495 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"]
[2022/06/22 14:31:45.495 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"]
[2022/06/22 14:31:45.495 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:31:45.495 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:31:45.495 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:31:45.495 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"]
[2022/06/22 14:31:45.495 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"]
[2022/06/22 14:31:45.495 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:31:45.495 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:31:45.495 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:31:45.495 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:31:45.495 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:31:45.495 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 90c741cf-9417-4b6a-969a-2669b939044b watch owner key /tidb/stats/owner/2231818a1c04b148"]
[2022/06/22 14:31:45.495 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"]
[2022/06/22 14:31:45.496 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:31:45.496 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:42650->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:31:45.496 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"]
[2022/06/22 14:31:45.510 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"] [error="context canceled"]
[2022/06/22 14:31:45.711 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:31:48.006 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:31:48.007 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:31:48.028 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:31:48.028 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:31:48.264 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 90c741cf-9417-4b6a-969a-2669b939044b"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:31:48.264 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:31:48.264 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.772975896s]
[2022/06/22 14:31:48.264 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=606287054ac0002]
--- FAIL: TestNDVGroupCols (7.49s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				stats_test.go:152
        	Error:      	Not equal: 
        	            	expected: "[StreamAgg 4.00 root  group by:test.t1.a, test.t1.b, funcs:count(1)->Column#4]\n[└─IndexReader 4.00 root  index:Selection]\n[  └─Selection 4.00 cop[tikv]  gt(test.t1.b, 0)]\n[    └─IndexFullScan 4.00 cop[tikv] table:t1, index:a(a, b) keep order:true]\n"
        	            	actual  : "[StreamAgg 1.33 root  group by:test.t1.a, test.t1.b, funcs:count(1)->Column#4]\n[└─IndexReader 1.33 root  index:Selection]\n[  └─Selection 1.33 cop[tikv]  gt(test.t1.b, 0)]\n[    └─IndexFullScan 4.00 cop[tikv] table:t1, index:a(a, b) keep order:true]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,4 +1,4 @@
        	            	-[StreamAgg 4.00 root  group by:test.t1.a, test.t1.b, funcs:count(1)->Column#4]
        	            	-[└─IndexReader 4.00 root  index:Selection]
        	            	-[  └─Selection 4.00 cop[tikv]  gt(test.t1.b, 0)]
        	            	+[StreamAgg 1.33 root  group by:test.t1.a, test.t1.b, funcs:count(1)->Column#4]
        	            	+[└─IndexReader 1.33 root  index:Selection]
        	            	+[  └─Selection 1.33 cop[tikv]  gt(test.t1.b, 0)]
        	            	 [    └─IndexFullScan 4.00 cop[tikv] table:t1, index:a(a, b) keep order:true]
        	Test:       	TestNDVGroupCols
        	Messages:   	sql:explain format = 'brief' select count(1) from t1 where b > 0 group by a, b, args:[]
FAIL
err=exit status 1
[2022/06/22 14:32:50.470 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:32:50.470 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:32:51.470 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:32:54.670 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 14:32:55.671 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:32:55.671 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:32:55.671 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:32:55.671 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:32:55.676 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:32:55.684 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=4157585] ["lease id"=2231818a1d14e824]
[2022/06/22 14:32:55.686 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:32:55.696 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=7.307017ms]
[2022/06/22 14:32:55.697 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:32:55.697 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=f7685c3c-2e22-4cbc-abf1-542f29c2ddac] [runWorker=true]
[2022/06/22 14:32:55.697 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:32:55.697 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:32:55.697 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:32:55.697 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:32:55.702 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"] [ownerID=f7685c3c-2e22-4cbc-abf1-542f29c2ddac]
[2022/06/22 14:32:55.707 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:32:55.708 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:32:55.709 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"] [ownerID=f7685c3c-2e22-4cbc-abf1-542f29c2ddac]
[2022/06/22 14:32:55.724 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:32:55.736 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:32:55.739 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:32:55.739 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:32:55.895 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:32:55.895 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:32:55.897 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=6062874a52c0002]
[2022/06/22 14:32:55.899 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"] [ownerID=f7685c3c-2e22-4cbc-abf1-542f29c2ddac]
[2022/06/22 14:32:55.899 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"] [ownerID=f7685c3c-2e22-4cbc-abf1-542f29c2ddac]
[2022/06/22 14:32:55.900 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=5.248815ms]
[2022/06/22 14:32:55.925 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=6062874a52c0002]
[2022/06/22 14:32:55.925 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t1, t2"] [user=]
[2022/06/22 14:32:55.926 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t1(a int, b int)"] [user=]
[2022/06/22 14:32:55.932 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:32:55.883 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:32:55.932 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:32:55.883 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t1(a int, b int)"]
[2022/06/22 14:32:55.933 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:32:55.883 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:32:55.940 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=924.245µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 14:32:55.989 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.447743ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:32:55.883 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:32:55.990 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:32:55.883 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:32:55.993 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:32:55.993 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:32:55.995 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078895566487559] [checkTS=434078895566487560]
[2022/06/22 14:32:56.036 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t1` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:32:56.008 +08:00] ["end time"=2022/06/22 14:32:56.032 +08:00] [cost=23.775176ms]
[2022/06/22 14:32:56.047 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="create table t2(a int, b int)"] [user=]
[2022/06/22 14:32:56.052 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:32:56.033 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:32:56.052 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:32:56.033 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t2(a int, b int)"]
[2022/06/22 14:32:56.053 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:32:56.033 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:32:56.061 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=675.583µs] [phyTblIDs="[71]"] [actionTypes="[8]"]
[2022/06/22 14:32:56.111 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.446182ms] [job="ID:72, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:32:56.033 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:32:56.112 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:32:56.033 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:32:56.115 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=72]
[2022/06/22 14:32:56.115 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:32:56.117 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078895592701959] [checkTS=434078895592701960]
[2022/06/22 14:32:56.147 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t2` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:32:56.123 +08:00] ["end time"=2022/06/22 14:32:56.143 +08:00] [cost=19.766137ms]
[2022/06/22 14:32:56.158 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"]
[2022/06/22 14:32:56.158 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"]
[2022/06/22 14:32:56.159 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"] []
[2022/06/22 14:32:56.159 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=210ns]
[2022/06/22 14:32:56.159 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=130ns]
[2022/06/22 14:32:56.159 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:32:56.159 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:32:56.159 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=f7685c3c-2e22-4cbc-abf1-542f29c2ddac] ["take time"=1.084606ms]
[2022/06/22 14:32:56.159 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=f7685c3c-2e22-4cbc-abf1-542f29c2ddac]
[2022/06/22 14:32:56.160 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:32:56.160 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"]
[2022/06/22 14:32:56.160 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"]
[2022/06/22 14:32:56.160 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:32:56.160 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"]
[2022/06/22 14:32:56.160 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"]
[2022/06/22 14:32:56.160 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac watch owner key /tidb/stats/owner/2231818a1d14e847"]
[2022/06/22 14:32:56.160 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"]
[2022/06/22 14:32:56.160 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:32:56.160 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:42878->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:32:56.161 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"]
[2022/06/22 14:32:56.178 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"] [error="context canceled"]
[2022/06/22 14:32:56.378 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:32:58.698 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:32:58.698 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:32:58.700 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:32:58.700 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:32:58.922 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager f7685c3c-2e22-4cbc-abf1-542f29c2ddac"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:32:58.922 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:32:58.922 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.763947879s]
[2022/06/22 14:32:58.922 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=6062874a52c0002]
[2022/06/22 14:32:58.922 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 14:32:58.922 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestMultiColInExpression (8.45s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				expression_rewriter_test.go:424
        	Error:      	Not equal: 
        	            	expected: "[HashJoin 2.25 root  inner join, equal:[eq(test.t1.a, test.t2.a) eq(test.t1.b, test.t2.b)]]\n[├─HashAgg(Build) 1.69 root  group by:test.t2.a, test.t2.b, funcs:firstrow(test.t2.a)->test.t2.a, funcs:firstrow(test.t2.b)->test.t2.b]\n[│ └─TableReader 1.69 root  data:HashAgg]\n[│   └─HashAgg 1.69 cop[tikv]  group by:test.t2.a, test.t2.b, ]\n[│     └─Selection 2.25 cop[tikv]  not(isnull(test.t2.a)), not(isnull(test.t2.b))]\n[│       └─TableFullScan 4.00 cop[tikv] table:t2 keep order:false]\n[└─TableReader(Probe) 2.25 root  data:Selection]\n[  └─Selection 2.25 cop[tikv]  not(isnull(test.t1.a)), not(isnull(test.t1.b))]\n[    └─TableFullScan 4.00 cop[tikv] table:t1 keep order:false]\n"
        	            	actual  : "[HashJoin 3.99 root  inner join, equal:[eq(test.t1.a, test.t2.a) eq(test.t1.b, test.t2.b)]]\n[├─HashAgg(Build) 2.99 root  group by:test.t2.a, test.t2.b, funcs:firstrow(test.t2.a)->test.t2.a, funcs:firstrow(test.t2.b)->test.t2.b]\n[│ └─TableReader 2.99 root  data:HashAgg]\n[│   └─HashAgg 2.99 cop[tikv]  group by:test.t2.a, test.t2.b, ]\n[│     └─Selection 3.99 cop[tikv]  not(isnull(test.t2.a)), not(isnull(test.t2.b))]\n[│       └─TableFullScan 4.00 cop[tikv] table:t2 keep order:false]\n[└─TableReader(Probe) 3.99 root  data:Selection]\n[  └─Selection 3.99 cop[tikv]  not(isnull(test.t1.a)), not(isnull(test.t1.b))]\n[    └─TableFullScan 4.00 cop[tikv] table:t1 keep order:false]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,9 +1,9 @@
        	            	-[HashJoin 2.25 root  inner join, equal:[eq(test.t1.a, test.t2.a) eq(test.t1.b, test.t2.b)]]
        	            	-[├─HashAgg(Build) 1.69 root  group by:test.t2.a, test.t2.b, funcs:firstrow(test.t2.a)->test.t2.a, funcs:firstrow(test.t2.b)->test.t2.b]
        	            	-[│ └─TableReader 1.69 root  data:HashAgg]
        	            	-[│   └─HashAgg 1.69 cop[tikv]  group by:test.t2.a, test.t2.b, ]
        	            	-[│     └─Selection 2.25 cop[tikv]  not(isnull(test.t2.a)), not(isnull(test.t2.b))]
        	            	+[HashJoin 3.99 root  inner join, equal:[eq(test.t1.a, test.t2.a) eq(test.t1.b, test.t2.b)]]
        	            	+[├─HashAgg(Build) 2.99 root  group by:test.t2.a, test.t2.b, funcs:firstrow(test.t2.a)->test.t2.a, funcs:firstrow(test.t2.b)->test.t2.b]
        	            	+[│ └─TableReader 2.99 root  data:HashAgg]
        	            	+[│   └─HashAgg 2.99 cop[tikv]  group by:test.t2.a, test.t2.b, ]
        	            	+[│     └─Selection 3.99 cop[tikv]  not(isnull(test.t2.a)), not(isnull(test.t2.b))]
        	            	 [│       └─TableFullScan 4.00 cop[tikv] table:t2 keep order:false]
        	            	-[└─TableReader(Probe) 2.25 root  data:Selection]
        	            	-[  └─Selection 2.25 cop[tikv]  not(isnull(test.t1.a)), not(isnull(test.t1.b))]
        	            	+[└─TableReader(Probe) 3.99 root  data:Selection]
        	            	+[  └─Selection 3.99 cop[tikv]  not(isnull(test.t1.a)), not(isnull(test.t1.b))]
        	            	 [    └─TableFullScan 4.00 cop[tikv] table:t1 keep order:false]
        	Test:       	TestMultiColInExpression
        	Messages:   	sql:explain format = 'brief' select * from t1 where (t1.a, t1.b) in (select a, b from t2), args:[]
FAIL
err=exit status 1
[2022/06/22 14:33:42.303 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:33:42.304 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:33:43.304 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:33:46.487 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 14:33:47.488 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:33:47.488 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:33:47.488 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:33:47.488 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:33:47.493 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:33:47.501 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=58133] ["lease id"=2231818a1ddf5324]
[2022/06/22 14:33:47.503 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:33:47.514 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=7.711727ms]
[2022/06/22 14:33:47.514 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:33:47.514 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=c4d92d32-d7b2-4962-b752-48cbc67f72ed] [runWorker=true]
[2022/06/22 14:33:47.514 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:33:47.515 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:33:47.515 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:33:47.515 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:33:47.517 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"] [ownerID=c4d92d32-d7b2-4962-b752-48cbc67f72ed]
[2022/06/22 14:33:47.520 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:33:47.521 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:33:47.522 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"] [ownerID=c4d92d32-d7b2-4962-b752-48cbc67f72ed]
[2022/06/22 14:33:47.538 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:33:47.551 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:33:47.553 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:33:47.553 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:33:47.714 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:33:47.715 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:33:47.716 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=6062877cedc0002]
[2022/06/22 14:33:47.717 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"] [ownerID=c4d92d32-d7b2-4962-b752-48cbc67f72ed]
[2022/06/22 14:33:47.717 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"] [ownerID=c4d92d32-d7b2-4962-b752-48cbc67f72ed]
[2022/06/22 14:33:47.719 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=4.832133ms]
[2022/06/22 14:33:47.742 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=6062877cedc0002]
[2022/06/22 14:33:47.742 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t(a int, b int, c int, index idx(c,b,a))"] [user=]
[2022/06/22 14:33:47.749 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:33:47.703 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:33:47.749 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:33:47.703 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t(a int, b int, c int, index idx(c,b,a))"]
[2022/06/22 14:33:47.750 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:33:47.703 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:33:47.755 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=933.444µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 14:33:47.805 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.272689ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:33:47.703 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:33:47.806 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:33:47.703 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:33:47.809 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:33:47.809 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:33:47.811 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078909150789639] [checkTS=434078909150789640]
[2022/06/22 14:33:47.874 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:33:47.821 +08:00] ["end time"=2022/06/22 14:33:47.870 +08:00] [cost=49.31228ms]
[2022/06/22 14:33:47.890 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"]
[2022/06/22 14:33:47.890 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"]
[2022/06/22 14:33:47.890 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:33:47.890 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"] []
[2022/06/22 14:33:47.891 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=190ns]
[2022/06/22 14:33:47.891 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=280ns]
[2022/06/22 14:33:47.891 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:33:47.891 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:33:47.891 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=c4d92d32-d7b2-4962-b752-48cbc67f72ed] ["take time"=984.185µs]
[2022/06/22 14:33:47.891 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=c4d92d32-d7b2-4962-b752-48cbc67f72ed]
[2022/06/22 14:33:47.892 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:33:47.892 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"]
[2022/06/22 14:33:47.892 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"]
[2022/06/22 14:33:47.892 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:33:47.892 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"]
[2022/06/22 14:33:47.892 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"]
[2022/06/22 14:33:47.892 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed watch owner key /tidb/stats/owner/2231818a1ddf5348"]
[2022/06/22 14:33:47.892 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"]
[2022/06/22 14:33:47.892 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:33:47.892 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:43046->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:33:47.900 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"] [error="context canceled"]
[2022/06/22 14:33:47.900 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"]
[2022/06/22 14:33:47.900 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:33:50.417 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:33:50.417 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:33:50.430 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:33:50.430 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:33:50.438 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager c4d92d32-d7b2-4962-b752-48cbc67f72ed"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:33:50.438 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:33:50.438 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.548368006s]
[2022/06/22 14:33:50.438 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=6062877cedc0002]
--- FAIL: TestCorrelatedEstimation (8.13s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				cbo_test.go:460
        	Error:      	Not equal: 
        	            	expected: "[Projection 10.00 root  Column#22]\n[└─Apply 10.00 root  CARTESIAN left outer semi join, other cond:eq(test.t.c, Column#21)]\n[  ├─TableReader(Build) 10.00 root  data:TableFullScan]\n[  │ └─TableFullScan 10.00 cop[tikv] table:t keep order:false]\n[  └─StreamAgg(Probe) 1.00 root  funcs:count(1)->Column#21]\n[    └─HashJoin 1.00 root  inner join, equal:[eq(test.t.a, test.t.a)]]\n[      ├─TableReader(Build) 1.00 root  data:Selection]\n[      │ └─Selection 1.00 cop[tikv]  eq(test.t.a, test.t.a), not(isnull(test.t.a))]\n[      │   └─TableFullScan 10.00 cop[tikv] table:t1 keep order:false]\n[      └─TableReader(Probe) 1.00 root  data:Selection]\n[        └─Selection 1.00 cop[tikv]  eq(test.t.a, test.t.a), not(isnull(test.t.a))]\n[          └─TableFullScan 10.00 cop[tikv] table:s keep order:false]\n"
        	            	actual  : "[Projection 10.00 root  Column#22]\n[└─Apply 10.00 root  CARTESIAN left outer semi join, other cond:eq(test.t.c, Column#21)]\n[  ├─TableReader(Build) 10.00 root  data:TableFullScan]\n[  │ └─TableFullScan 10.00 cop[tikv] table:t keep order:false]\n[  └─StreamAgg(Probe) 1.00 root  funcs:count(1)->Column#21]\n[    └─HashJoin 0.00 root  inner join, equal:[eq(test.t.a, test.t.a)]]\n[      ├─TableReader(Build) 0.01 root  data:Selection]\n[      │ └─Selection 0.01 cop[tikv]  eq(test.t.a, test.t.a), not(isnull(test.t.a))]\n[      │   └─TableFullScan 10.00 cop[tikv] table:t1 keep order:false]\n[      └─TableReader(Probe) 0.01 root  data:Selection]\n[        └─Selection 0.01 cop[tikv]  eq(test.t.a, test.t.a), not(isnull(test.t.a))]\n[          └─TableFullScan 10.00 cop[tikv] table:s keep order:false]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -5,8 +5,8 @@
        	            	 [  └─StreamAgg(Probe) 1.00 root  funcs:count(1)->Column#21]
        	            	-[    └─HashJoin 1.00 root  inner join, equal:[eq(test.t.a, test.t.a)]]
        	            	-[      ├─TableReader(Build) 1.00 root  data:Selection]
        	            	-[      │ └─Selection 1.00 cop[tikv]  eq(test.t.a, test.t.a), not(isnull(test.t.a))]
        	            	+[    └─HashJoin 0.00 root  inner join, equal:[eq(test.t.a, test.t.a)]]
        	            	+[      ├─TableReader(Build) 0.01 root  data:Selection]
        	            	+[      │ └─Selection 0.01 cop[tikv]  eq(test.t.a, test.t.a), not(isnull(test.t.a))]
        	            	 [      │   └─TableFullScan 10.00 cop[tikv] table:t1 keep order:false]
        	            	-[      └─TableReader(Probe) 1.00 root  data:Selection]
        	            	-[        └─Selection 1.00 cop[tikv]  eq(test.t.a, test.t.a), not(isnull(test.t.a))]
        	            	+[      └─TableReader(Probe) 0.01 root  data:Selection]
        	            	+[        └─Selection 0.01 cop[tikv]  eq(test.t.a, test.t.a), not(isnull(test.t.a))]
        	            	 [          └─TableFullScan 10.00 cop[tikv] table:s keep order:false]
        	Test:       	TestCorrelatedEstimation
        	Messages:   	sql:explain format = 'brief' select t.c in (select count(*) from t s , t t1 where s.a = t.a and s.a = t1.a) from t, args:[]
FAIL
err=exit status 1
[2022/06/22 14:34:09.266 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:34:09.266 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:34:10.266 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:34:13.521 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 14:34:14.522 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:34:14.522 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:34:14.522 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:34:14.522 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:34:14.526 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:34:14.538 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=3344536] ["lease id"=2231818a1e48ed24]
[2022/06/22 14:34:14.540 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:34:14.550 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=7.066872ms]
[2022/06/22 14:34:14.550 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:34:14.550 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=85f1411f-9ddc-45b7-8eb1-16fa59624c5e] [runWorker=true]
[2022/06/22 14:34:14.550 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:34:14.551 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:34:14.551 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:34:14.551 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:34:14.553 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"] [ownerID=85f1411f-9ddc-45b7-8eb1-16fa59624c5e]
[2022/06/22 14:34:14.557 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:34:14.557 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:34:14.559 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"] [ownerID=85f1411f-9ddc-45b7-8eb1-16fa59624c5e]
[2022/06/22 14:34:14.575 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:34:14.590 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:34:14.592 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:34:14.593 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:34:14.814 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:34:14.815 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:34:14.819 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=4.277829ms]
[2022/06/22 14:34:14.819 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=6062879760c0002]
[2022/06/22 14:34:14.821 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"] [ownerID=85f1411f-9ddc-45b7-8eb1-16fa59624c5e]
[2022/06/22 14:34:14.821 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"] [ownerID=85f1411f-9ddc-45b7-8eb1-16fa59624c5e]
[2022/06/22 14:34:14.846 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=6062879760c0002]
[2022/06/22 14:34:14.846 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists d1_t"] [user=]
[2022/06/22 14:34:14.847 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table d1_t(d1_k int, value int)"] [user=]
[2022/06/22 14:34:14.852 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:34:14.837 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:34:14.853 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:34:14.837 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table d1_t(d1_k int, value int)"]
[2022/06/22 14:34:14.854 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:34:14.837 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:34:14.861 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=841.714µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 14:34:14.911 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.803106ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:34:14.837 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:34:14.912 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:34:14.837 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:34:14.914 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:34:14.914 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:34:14.916 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078916250697735] [checkTS=434078916250697736]
[2022/06/22 14:34:14.954 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`d1_t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:34:14.928 +08:00] ["end time"=2022/06/22 14:34:14.951 +08:00] [cost=22.565632ms]
[2022/06/22 14:34:14.965 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="drop table if exists d2_t"] [user=]
[2022/06/22 14:34:14.965 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="create table d2_t(d2_k decimal(10,2), value int)"] [user=]
[2022/06/22 14:34:14.970 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:34:14.937 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:34:14.971 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:34:14.937 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table d2_t(d2_k decimal(10,2), value int)"]
[2022/06/22 14:34:14.972 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:34:14.937 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:34:14.977 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=760.933µs] [phyTblIDs="[71]"] [actionTypes="[8]"]
[2022/06/22 14:34:15.027 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=50.872932ms] [job="ID:72, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:34:14.937 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:34:15.028 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:34:14.937 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:34:15.031 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=72]
[2022/06/22 14:34:15.031 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:34:15.033 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078916276912135] [checkTS=434078916276912136]
[2022/06/22 14:34:15.065 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`d2_t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:34:15.041 +08:00] ["end time"=2022/06/22 14:34:15.062 +08:00] [cost=20.328591ms]
[2022/06/22 14:34:15.080 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=36] [cur_db=test] [sql="drop table if exists d3_t"] [user=]
[2022/06/22 14:34:15.080 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=36] [cur_db=test] [sql="create table d3_t(d3_k date, value int)"] [user=]
[2022/06/22 14:34:15.087 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 14:34:15.037 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:34:15.087 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 14:34:15.037 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table d3_t(d3_k date, value int)"]
[2022/06/22 14:34:15.088 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:0, start time: 2022-06-22 14:34:15.037 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:34:15.093 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=36] [neededSchemaVersion=37] ["start time"=557.682µs] [phyTblIDs="[73]"] [actionTypes="[8]"]
[2022/06/22 14:34:15.144 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=37] ["take time"=51.790385ms] [job="ID:74, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 14:34:15.037 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:34:15.145 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:73, RowCount:0, ArgLen:0, start time: 2022-06-22 14:34:15.037 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:34:15.148 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=74]
[2022/06/22 14:34:15.148 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:34:15.150 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078916316233735] [checkTS=434078916316233736]
[2022/06/22 14:34:15.178 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`d3_t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:34:15.157 +08:00] ["end time"=2022/06/22 14:34:15.175 +08:00] [cost=17.821001ms]
[2022/06/22 14:34:15.189 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=37] [cur_db=test] [sql="drop table if exists fact_t"] [user=]
[2022/06/22 14:34:15.189 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=37] [cur_db=test] [sql="create table fact_t(d1_k int, d2_k decimal(10,2), d3_k date, col1 int, col2 int, col3 int)"] [user=]
[2022/06/22 14:34:15.194 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:76, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 14:34:15.187 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:34:15.194 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:76, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 14:34:15.187 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table fact_t(d1_k int, d2_k decimal(10,2), d3_k date, col1 int, col2 int, col3 int)"]
[2022/06/22 14:34:15.195 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:76, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 14:34:15.187 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:34:15.201 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=37] [neededSchemaVersion=38] ["start time"=764.123µs] [phyTblIDs="[75]"] [actionTypes="[8]"]
[2022/06/22 14:34:15.251 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=38] ["take time"=51.148893ms] [job="ID:76, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 14:34:15.187 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:34:15.252 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:76, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 14:34:15.187 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:34:15.256 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=76]
[2022/06/22 14:34:15.256 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:34:15.260 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078916342710281] [checkTS=434078916342710282]
[2022/06/22 14:34:15.317 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`fact_t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:34:15.272 +08:00] ["end time"=2022/06/22 14:34:15.313 +08:00] [cost=40.788176ms]
[2022/06/22 14:34:15.335 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"]
[2022/06/22 14:34:15.335 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"]
[2022/06/22 14:34:15.336 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"] []
[2022/06/22 14:34:15.336 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=360ns]
[2022/06/22 14:34:15.336 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=150ns]
[2022/06/22 14:34:15.336 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:34:15.336 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:34:15.336 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=85f1411f-9ddc-45b7-8eb1-16fa59624c5e] ["take time"=1.101305ms]
[2022/06/22 14:34:15.336 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=85f1411f-9ddc-45b7-8eb1-16fa59624c5e]
[2022/06/22 14:34:15.337 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:34:15.337 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:34:15.337 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:34:15.337 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:34:15.337 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:34:15.337 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:34:15.337 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:34:15.337 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:34:15.337 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:34:15.337 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"]
[2022/06/22 14:34:15.337 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"]
[2022/06/22 14:34:15.337 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:34:15.337 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:34:15.337 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:34:15.337 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:34:15.337 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"]
[2022/06/22 14:34:15.337 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"]
[2022/06/22 14:34:15.337 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:34:15.337 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:34:15.338 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:34:15.338 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:34:15.338 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:34:15.338 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e watch owner key /tidb/stats/owner/2231818a1e48ed48"]
[2022/06/22 14:34:15.338 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"]
[2022/06/22 14:34:15.338 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:34:15.338 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:43148->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:34:15.338 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"]
[2022/06/22 14:34:15.373 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"] [error="context canceled"]
[2022/06/22 14:34:15.573 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:34:17.861 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:34:17.861 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:34:17.868 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:34:17.868 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:34:18.125 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 85f1411f-9ddc-45b7-8eb1-16fa59624c5e"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:34:18.125 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:34:18.125 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.789505894s]
[2022/06/22 14:34:18.125 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=6062879760c0002]
[2022/06/22 14:34:18.125 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 14:34:18.125 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestMPPShuffledJoin (8.86s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				integration_test.go:867
        	Error:      	Not equal: 
        	            	expected: "[HashAgg 1.00 root  funcs:count(Column#12)->Column#11]\n[└─TableReader 1.00 root  data:ExchangeSender]\n[  └─ExchangeSender 1.00 mpp[tiflash]  ExchangeType: PassThrough]\n[    └─HashAgg 1.00 mpp[tiflash]  funcs:count(1)->Column#12]\n[      └─HashJoin 32.00 mpp[tiflash]  inner join, equal:[eq(test.d1_t.d1_k, test.fact_t.d1_k)]]\n[        ├─ExchangeReceiver(Build) 4.00 mpp[tiflash]  ]\n[        │ └─ExchangeSender 4.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: test.d1_t.d1_k, collate: binary]]\n[        │   └─Selection 4.00 mpp[tiflash]  not(isnull(test.d1_t.d1_k))]\n[        │     └─TableFullScan 4.00 mpp[tiflash] table:d1_t keep order:false]\n[        └─ExchangeReceiver(Probe) 16.00 mpp[tiflash]  ]\n[          └─ExchangeSender 16.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: test.fact_t.d1_k, collate: binary]]\n[            └─Selection 16.00 mpp[tiflash]  not(isnull(test.fact_t.d1_k))]\n[              └─TableFullScan 16.00 mpp[tiflash] table:fact_t keep order:false]\n"
        	            	actual  : "[HashAgg 1.00 root  funcs:count(Column#12)->Column#11]\n[└─TableReader 1.00 root  data:ExchangeSender]\n[  └─ExchangeSender 1.00 mpp[tiflash]  ExchangeType: PassThrough]\n[    └─HashAgg 1.00 mpp[tiflash]  funcs:count(1)->Column#12]\n[      └─HashJoin 31.97 mpp[tiflash]  inner join, equal:[eq(test.d1_t.d1_k, test.fact_t.d1_k)]]\n[        ├─ExchangeReceiver(Build) 4.00 mpp[tiflash]  ]\n[        │ └─ExchangeSender 4.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: test.d1_t.d1_k, collate: binary]]\n[        │   └─Selection 4.00 mpp[tiflash]  not(isnull(test.d1_t.d1_k))]\n[        │     └─TableFullScan 4.00 mpp[tiflash] table:d1_t keep order:false]\n[        └─ExchangeReceiver(Probe) 15.98 mpp[tiflash]  ]\n[          └─ExchangeSender 15.98 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: test.fact_t.d1_k, collate: binary]]\n[            └─Selection 15.98 mpp[tiflash]  not(isnull(test.fact_t.d1_k))]\n[              └─TableFullScan 16.00 mpp[tiflash] table:fact_t keep order:false]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -4,3 +4,3 @@
        	            	 [    └─HashAgg 1.00 mpp[tiflash]  funcs:count(1)->Column#12]
        	            	-[      └─HashJoin 32.00 mpp[tiflash]  inner join, equal:[eq(test.d1_t.d1_k, test.fact_t.d1_k)]]
        	            	+[      └─HashJoin 31.97 mpp[tiflash]  inner join, equal:[eq(test.d1_t.d1_k, test.fact_t.d1_k)]]
        	            	 [        ├─ExchangeReceiver(Build) 4.00 mpp[tiflash]  ]
        	            	@@ -9,5 +9,5 @@
        	            	 [        │     └─TableFullScan 4.00 mpp[tiflash] table:d1_t keep order:false]
        	            	-[        └─ExchangeReceiver(Probe) 16.00 mpp[tiflash]  ]
        	            	-[          └─ExchangeSender 16.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: test.fact_t.d1_k, collate: binary]]
        	            	-[            └─Selection 16.00 mpp[tiflash]  not(isnull(test.fact_t.d1_k))]
        	            	+[        └─ExchangeReceiver(Probe) 15.98 mpp[tiflash]  ]
        	            	+[          └─ExchangeSender 15.98 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: test.fact_t.d1_k, collate: binary]]
        	            	+[            └─Selection 15.98 mpp[tiflash]  not(isnull(test.fact_t.d1_k))]
        	            	 [              └─TableFullScan 16.00 mpp[tiflash] table:fact_t keep order:false]
        	Test:       	TestMPPShuffledJoin
        	Messages:   	sql:explain format = 'brief' select count(*) from fact_t, d1_t where fact_t.d1_k = d1_t.d1_k, args:[]
FAIL
err=exit status 1
[2022/06/22 14:34:44.277 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:34:44.278 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:34:45.278 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:34:49.281 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING: error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING"]
[2022/06/22 14:34:50.283 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:34:50.283 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:34:50.283 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:34:50.283 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:34:52.288 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:34:52.300 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=3790773] ["lease id"=2231818a1ed18527]
[2022/06/22 14:34:52.307 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:34:58.291 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=4.005386542s]
[2022/06/22 14:34:58.292 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:34:58.292 +08:00] [WARN] [domain.go:449] ["loading schema takes a long time"] ["take time"=5.983313406s]
[2022/06/22 14:34:58.292 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=53b8f66f-be8f-4123-a215-07c09f71786b] [runWorker=true]
[2022/06/22 14:34:58.292 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:34:58.296 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:34:58.296 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:34:58.296 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:34:58.298 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"] [ownerID=53b8f66f-be8f-4123-a215-07c09f71786b]
[2022/06/22 14:34:58.302 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:34:58.302 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:34:58.303 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"] [ownerID=53b8f66f-be8f-4123-a215-07c09f71786b]
[2022/06/22 14:34:58.317 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:34:58.540 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:34:58.543 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:34:58.543 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:34:58.694 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:34:58.694 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:34:58.697 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=3.160653ms]
[2022/06/22 14:34:58.699 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=606287c23740002]
[2022/06/22 14:34:58.700 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"] [ownerID=53b8f66f-be8f-4123-a215-07c09f71786b]
[2022/06/22 14:34:58.700 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"] [ownerID=53b8f66f-be8f-4123-a215-07c09f71786b]
[2022/06/22 14:34:59.207 +08:00] [WARN] [adapter.go:1095] ["# Txn_start_ts: 434078927723692039\n# Query_time: 0.505521925\n# Parse_time: 0\n# Compile_time: 0.00006319\n# Rewrite_time: 0.00001344\n# Optimize_time: 0\n# Wait_TS: 0.00006738\n# Prewrite_time: 0.002622501 Commit_time: 0.001846568 Get_commit_ts_time: 0.000115291 Write_keys: 1 Write_size: 109 Prewrite_region: 1\n# Is_internal: true\n# Digest: 61f4cce222f1a26d6b0650865051ebed3d077412ae053636e2f5acf9dc426a42\n# Num_cop_tasks: 0\n# Mem_max: 403\n# Prepared: false\n# Plan_from_cache: false\n# Plan_from_binding: false\n# Has_more_results: false\n# KV_total: 0\n# PD_total: 0\n# Backoff_total: 0\n# Write_sql_response_total: 0\n# Result_rows: 0\n# Succ: true\n# IsExplicitTxn: false\n# Plan: tidb_decode_plan('iwTYMAkyN18xCTAJMAlOL0EJMAl0aW1lOjUwMy4xwrVzLCBsb29wczoxLCBwcmVwYXJlOiA3OC42wgEbUGNoZWNrX2luc2VydDoge3RvdGFsXwU/FCA0MjQuNQVACG1lbQ0jDRsEMzkFGDBwcmVmZXRjaDogMzg1DSxIcnBjOntCYXRjaEdldDp7bnVtXwETCDIsIB1cDDM0OS4BgDR9LCBzY2FuX2RldGFpbBWANHByb2Nlc3Nfa2V5czogFTsuFwAkX3NpemU6IDIwOBFZFS2Ycm9ja3NkYjoge2RlbGV0ZV9za2lwcGVkX2NvdW50OiAwLCBrZXlfRhYAQGJsb2NrOiB7Y2FjaGVfaGl0ETIYMTIsIHJlYS5CAAUPNGJ5dGU6IDAgQnl0ZXN9AQGQLCBjb21taXRfdHhuOiB7cHJld3JpdGU6Mi42Mm1zLCBnZXRfYw0iGHM6MTE1LjMlSgk2EDoxLjg1ASckcmVnaW9uX251bSG2BUMJ4AQxLA0OBXtIMTA5fQk0MDMgQnl0ZXMJTi9BCg==')\nINSERT HIGH_PRIORITY INTO mysql.tidb VALUES ('tikv_gc_leader_uuid', '606287c23740002', 'Current GC worker leader UUID. (DO NOT EDIT)')           ON DUPLICATE KEY           UPDATE variable_value = '606287c23740002', comment = 'Current GC worker leader UUID. (DO NOT EDIT)';"]
[2022/06/22 14:34:59.224 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=606287c23740002]
[2022/06/22 14:34:59.225 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t1"] [user=]
[2022/06/22 14:34:59.225 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t1 (a int, b varchar(20), c decimal(40,10), d int, primary key(a,b), key(c))"] [user=]
[2022/06/22 14:34:59.231 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:34:59.203 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:34:59.231 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:34:59.203 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t1 (a int, b varchar(20), c decimal(40,10), d int, primary key(a,b), key(c))"]
[2022/06/22 14:34:59.232 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:34:59.203 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:34:59.238 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=873.594µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 14:34:59.287 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.159217ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:34:59.203 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:34:59.289 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:34:59.203 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:34:59.292 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:34:59.292 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:34:59.355 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t1` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:34:59.303 +08:00] ["end time"=2022/06/22 14:34:59.352 +08:00] [cost=48.162781ms]
[2022/06/22 14:34:59.385 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"]
[2022/06/22 14:34:59.385 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"]
[2022/06/22 14:34:59.386 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"] []
[2022/06/22 14:34:59.386 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=780ns]
[2022/06/22 14:34:59.386 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=150ns]
[2022/06/22 14:34:59.386 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:34:59.386 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:34:59.386 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=53b8f66f-be8f-4123-a215-07c09f71786b] ["take time"=1.151335ms]
[2022/06/22 14:34:59.386 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=53b8f66f-be8f-4123-a215-07c09f71786b]
[2022/06/22 14:34:59.387 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:34:59.388 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"]
[2022/06/22 14:34:59.388 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"]
[2022/06/22 14:34:59.388 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:34:59.388 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"]
[2022/06/22 14:34:59.388 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"]
[2022/06/22 14:34:59.388 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b watch owner key /tidb/stats/owner/2231818a1ed18554"]
[2022/06/22 14:34:59.388 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"]
[2022/06/22 14:34:59.388 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:34:59.388 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:43284->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:34:59.399 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"] [error="context canceled"]
[2022/06/22 14:34:59.399 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"]
[2022/06/22 14:34:59.399 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:35:01.905 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:35:01.905 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:35:01.918 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:35:01.919 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:35:01.931 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 53b8f66f-be8f-4123-a215-07c09f71786b"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:35:01.931 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:35:01.931 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.545446592s]
[2022/06/22 14:35:01.931 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=606287c23740002]
[2022/06/22 14:35:01.931 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 14:35:01.931 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestAccessPathOnClusterIndex (17.65s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				integration_test.go:2659
        	Error:      	Not equal: 
        	            	expected: "[TableReader 0.82 root  data:TableRangeScan]\n[└─TableRangeScan 0.82 cop[tikv] table:t1 range:[1 -inf,1 \"333\"), keep order:false]\n"
        	            	actual  : "[TableReader 1.00 root  data:TableRangeScan]\n[└─TableRangeScan 1.00 cop[tikv] table:t1 range:[1 -inf,1 \"333\"), keep order:false]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,3 +1,3 @@
        	            	-[TableReader 0.82 root  data:TableRangeScan]
        	            	-[└─TableRangeScan 0.82 cop[tikv] table:t1 range:[1 -inf,1 "333"), keep order:false]
        	            	+[TableReader 1.00 root  data:TableRangeScan]
        	            	+[└─TableRangeScan 1.00 cop[tikv] table:t1 range:[1 -inf,1 "333"), keep order:false]
        	            	 
        	Test:       	TestAccessPathOnClusterIndex
        	Messages:   	sql:explain format='brief' select * from t1 where t1.a = 1 and t1.b < "333", args:[]
FAIL
err=exit status 1
[2022/06/22 14:36:36.487 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:36:36.487 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:36:37.487 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:36:41.171 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 14:36:42.172 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:36:42.172 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:36:42.172 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:36:42.172 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:36:42.180 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:36:42.188 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=1740799] ["lease id"=2231818a2087bb24]
[2022/06/22 14:36:42.191 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:36:42.201 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=7.120527ms]
[2022/06/22 14:36:42.202 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:36:42.202 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=6b257c56-89e8-48a3-a38c-0f332f31200a] [runWorker=true]
[2022/06/22 14:36:42.202 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:36:42.207 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:36:42.207 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:36:42.207 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:36:42.209 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"] [ownerID=6b257c56-89e8-48a3-a38c-0f332f31200a]
[2022/06/22 14:36:42.212 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:36:42.212 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:36:42.214 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"] [ownerID=6b257c56-89e8-48a3-a38c-0f332f31200a]
[2022/06/22 14:36:42.233 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:36:42.246 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:36:42.248 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:36:42.249 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:36:42.399 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:36:42.400 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:36:42.401 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=6062882784c0002]
[2022/06/22 14:36:42.403 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"] [ownerID=6b257c56-89e8-48a3-a38c-0f332f31200a]
[2022/06/22 14:36:42.403 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"] [ownerID=6b257c56-89e8-48a3-a38c-0f332f31200a]
[2022/06/22 14:36:42.404 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=5.003639ms]
[2022/06/22 14:36:42.427 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=6062882784c0002]
[2022/06/22 14:36:42.427 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=] [sql="drop database if exists test_partition;"] [user=]
[2022/06/22 14:36:42.428 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=] [sql="create database test_partition"] [user=]
[2022/06/22 14:36:42.433 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create schema, State:queueing, SchemaState:none, SchemaID:69, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.387 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:36:42.433 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create schema, State:queueing, SchemaState:none, SchemaID:69, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.387 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create database test_partition"]
[2022/06/22 14:36:42.435 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create schema, State:queueing, SchemaState:none, SchemaID:69, TableID:0, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.387 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.441 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=1.092705ms] [phyTblIDs="[]"] [actionTypes="[]"]
[2022/06/22 14:36:42.490 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=50.948365ms] [job="ID:70, Type:create schema, State:done, SchemaState:public, SchemaID:69, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.387 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.491 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create schema, State:synced, SchemaState:public, SchemaID:69, TableID:0, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.387 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.494 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:36:42.494 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:36:42.495 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test_partition] [sql="create table t1 (id int, a int, b int                 ) partition by list (    a    ) (partition p0 values in (1,2,3,4,5), partition p1 values in (6,7,8,9,10,null));"] [user=]
[2022/06/22 14:36:42.501 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.487 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:36:42.502 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.487 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t1 (id int, a int, b int                 ) partition by list (    a    ) (partition p0 values in (1,2,3,4,5), partition p1 values in (6,7,8,9,10,null));"]
[2022/06/22 14:36:42.503 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.487 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.508 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=1.063845ms] [phyTblIDs="[71,72,73]"] [actionTypes="[8,8,8]"]
[2022/06/22 14:36:42.558 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.807689ms] [job="ID:74, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.487 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.559 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.487 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.562 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=74]
[2022/06/22 14:36:42.562 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:36:42.563 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=36] [cur_db=test_partition] [sql="create table t2 (a int, id int, b int) partition by list (a*3 + b - 2*a - b) (partition p0 values in (1,2,3,4,5), partition p1 values in (6,7,8,9,10,null));"] [user=]
[2022/06/22 14:36:42.570 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.537 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:36:42.570 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.537 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t2 (a int, id int, b int) partition by list (a*3 + b - 2*a - b) (partition p0 values in (1,2,3,4,5), partition p1 values in (6,7,8,9,10,null));"]
[2022/06/22 14:36:42.571 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.537 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.577 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=36] [neededSchemaVersion=37] ["start time"=878.774µs] [phyTblIDs="[75,76,77]"] [actionTypes="[8,8,8]"]
[2022/06/22 14:36:42.626 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=37] ["take time"=51.134456ms] [job="ID:78, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.537 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.627 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:78, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.537 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.630 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=78]
[2022/06/22 14:36:42.630 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:36:42.631 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=37] [cur_db=test_partition] [sql="create table t3 (b int, id int, a int) partition by list columns (a) (partition p0 values in (1,2,3,4,5), partition p1 values in (6,7,8,9,10,null));"] [user=]
[2022/06/22 14:36:42.638 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:82, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:79, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.587 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:36:42.638 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:82, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:79, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.587 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t3 (b int, id int, a int) partition by list columns (a) (partition p0 values in (1,2,3,4,5), partition p1 values in (6,7,8,9,10,null));"]
[2022/06/22 14:36:42.639 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:82, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:79, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.587 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.644 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=37] [neededSchemaVersion=38] ["start time"=830.934µs] [phyTblIDs="[79,80,81]"] [actionTypes="[8,8,8]"]
[2022/06/22 14:36:42.694 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=38] ["take time"=50.822845ms] [job="ID:82, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:79, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.587 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.695 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:82, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:79, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.587 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.698 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=82]
[2022/06/22 14:36:42.698 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:36:42.698 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=38] [cur_db=test_partition] [sql="create table t4 (id int, a int, b int, primary key (a)) partition by list (    a    ) (partition p0 values in (1,2,3,4,5), partition p1 values in (6,7,8,9,10));"] [user=]
[2022/06/22 14:36:42.707 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:86, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:83, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.687 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:36:42.707 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:86, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:83, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.687 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t4 (id int, a int, b int, primary key (a)) partition by list (    a    ) (partition p0 values in (1,2,3,4,5), partition p1 values in (6,7,8,9,10));"]
[2022/06/22 14:36:42.708 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:86, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:83, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.687 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.715 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=38] [neededSchemaVersion=39] ["start time"=775.823µs] [phyTblIDs="[83,84,85]"] [actionTypes="[8,8,8]"]
[2022/06/22 14:36:42.765 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=39] ["take time"=51.736179ms] [job="ID:86, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:83, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.687 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.766 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:86, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:83, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.687 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.769 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=86]
[2022/06/22 14:36:42.769 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:36:42.770 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=39] [cur_db=test_partition] [sql="create table t5 (a int, id int, b int, unique key (a,b)) partition by list (a*3 + b - 2*a - b) (partition p0 values in (1,2,3,4,5), partition p1 values in (6,7,8,9,10,null));"] [user=]
[2022/06/22 14:36:42.777 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:90, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:87, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.737 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:36:42.777 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:90, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:87, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.737 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t5 (a int, id int, b int, unique key (a,b)) partition by list (a*3 + b - 2*a - b) (partition p0 values in (1,2,3,4,5), partition p1 values in (6,7,8,9,10,null));"]
[2022/06/22 14:36:42.778 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:90, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:87, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.737 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.785 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=39] [neededSchemaVersion=40] ["start time"=979.334µs] [phyTblIDs="[87,88,89]"] [actionTypes="[8,8,8]"]
[2022/06/22 14:36:42.834 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=40] ["take time"=51.146237ms] [job="ID:90, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:87, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.737 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.836 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:90, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:87, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.737 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.839 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=90]
[2022/06/22 14:36:42.839 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:36:42.840 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=40] [cur_db=test_partition] [sql="create table t6 (b int, id int, a int, unique key (a,b)) partition by list columns (a) (partition p0 values in (1,2,3,4,5), partition p1 values in (6,7,8,9,10,null));"] [user=]
[2022/06/22 14:36:42.850 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:94, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:91, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.837 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:36:42.850 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:94, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:91, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.837 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t6 (b int, id int, a int, unique key (a,b)) partition by list columns (a) (partition p0 values in (1,2,3,4,5), partition p1 values in (6,7,8,9,10,null));"]
[2022/06/22 14:36:42.851 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:94, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:91, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.837 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.858 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=40] [neededSchemaVersion=41] ["start time"=895.974µs] [phyTblIDs="[91,92,93]"] [actionTypes="[8,8,8]"]
[2022/06/22 14:36:42.907 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=41] ["take time"=51.518148ms] [job="ID:94, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:91, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.837 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.909 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:94, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:91, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.837 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.912 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=94]
[2022/06/22 14:36:42.912 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:36:42.914 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078955048009735] [checkTS=434078955048009736]
[2022/06/22 14:36:42.919 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078955048009738] [checkTS=434078955048009739]
[2022/06/22 14:36:42.922 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078955048009741] [checkTS=434078955048009742]
[2022/06/22 14:36:42.928 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078955048009745] [checkTS=434078955048009746]
[2022/06/22 14:36:42.932 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078955048009748] [checkTS=434078955048009749]
[2022/06/22 14:36:42.935 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=41] [cur_db=test_partition] [sql="create table t7 (a int unsigned) partition by list (a)(partition p0 values in (0),partition p1 values in (1),partition pnull values in (null),partition p2 values in (2));"] [user=]
[2022/06/22 14:36:42.942 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:100, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:95, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.937 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:36:42.942 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:100, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:95, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.937 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t7 (a int unsigned) partition by list (a)(partition p0 values in (0),partition p1 values in (1),partition pnull values in (null),partition p2 values in (2));"]
[2022/06/22 14:36:42.943 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:100, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:95, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.937 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:42.950 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=41] [neededSchemaVersion=42] ["start time"=851.364µs] [phyTblIDs="[95,96,97,98,99]"] [actionTypes="[8,8,8,8,8]"]
[2022/06/22 14:36:42.999 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=42] ["take time"=51.219458ms] [job="ID:100, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:95, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.937 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.001 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:100, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:95, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.937 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.004 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=100]
[2022/06/22 14:36:43.004 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:36:43.006 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434078955074224135] [checkTS=434078955074224136]
[2022/06/22 14:36:43.008 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=2] [schemaVersion=42] [cur_db=] [sql="drop database if exists test_partition_2;"] [user=]
[2022/06/22 14:36:43.008 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=2] [schemaVersion=42] [cur_db=] [sql="create database test_partition_2"] [user=]
[2022/06/22 14:36:43.013 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:102, Type:create schema, State:queueing, SchemaState:none, SchemaID:101, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.987 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:36:43.013 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:102, Type:create schema, State:queueing, SchemaState:none, SchemaID:101, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.987 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create database test_partition_2"]
[2022/06/22 14:36:43.014 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:102, Type:create schema, State:queueing, SchemaState:none, SchemaID:101, TableID:0, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.987 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.019 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=42] [neededSchemaVersion=43] ["start time"=411.202µs] [phyTblIDs="[]"] [actionTypes="[]"]
[2022/06/22 14:36:43.069 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=43] ["take time"=51.295997ms] [job="ID:102, Type:create schema, State:done, SchemaState:public, SchemaID:101, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:42.987 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.070 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:102, Type:create schema, State:synced, SchemaState:public, SchemaID:101, TableID:0, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:42.987 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.073 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=102]
[2022/06/22 14:36:43.073 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:36:43.074 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=2] [schemaVersion=43] [cur_db=test_partition_2] [sql="create table t1 (id int, a int, b int)"] [user=]
[2022/06/22 14:36:43.079 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:104, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:103, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.037 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:36:43.079 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:104, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:103, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.037 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t1 (id int, a int, b int)"]
[2022/06/22 14:36:43.080 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:104, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:103, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:43.037 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.086 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=43] [neededSchemaVersion=44] ["start time"=642.232µs] [phyTblIDs="[103]"] [actionTypes="[8]"]
[2022/06/22 14:36:43.135 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=44] ["take time"=50.975025ms] [job="ID:104, Type:create table, State:done, SchemaState:public, SchemaID:101, TableID:103, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.037 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.136 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:104, Type:create table, State:synced, SchemaState:public, SchemaID:101, TableID:103, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:43.037 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.139 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=104]
[2022/06/22 14:36:43.139 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:36:43.140 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=2] [schemaVersion=44] [cur_db=test_partition_2] [sql="create table t2 (a int, id int, b int)"] [user=]
[2022/06/22 14:36:43.145 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:106, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:105, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.138 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:36:43.145 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:106, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:105, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.138 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t2 (a int, id int, b int)"]
[2022/06/22 14:36:43.146 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:106, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:105, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:43.138 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.151 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=44] [neededSchemaVersion=45] ["start time"=596.572µs] [phyTblIDs="[105]"] [actionTypes="[8]"]
[2022/06/22 14:36:43.201 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=45] ["take time"=51.311947ms] [job="ID:106, Type:create table, State:done, SchemaState:public, SchemaID:101, TableID:105, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.138 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.203 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:106, Type:create table, State:synced, SchemaState:public, SchemaID:101, TableID:105, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:43.138 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.206 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=106]
[2022/06/22 14:36:43.206 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:36:43.206 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=2] [schemaVersion=45] [cur_db=test_partition_2] [sql="create table t3 (b int, id int, a int)"] [user=]
[2022/06/22 14:36:43.211 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:108, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:107, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.187 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:36:43.211 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:108, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:107, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.187 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t3 (b int, id int, a int)"]
[2022/06/22 14:36:43.212 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:108, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:107, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:43.187 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.218 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=45] [neededSchemaVersion=46] ["start time"=594.013µs] [phyTblIDs="[107]"] [actionTypes="[8]"]
[2022/06/22 14:36:43.269 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=46] ["take time"=52.653373ms] [job="ID:108, Type:create table, State:done, SchemaState:public, SchemaID:101, TableID:107, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.187 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.270 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:108, Type:create table, State:synced, SchemaState:public, SchemaID:101, TableID:107, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:43.187 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.273 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=108]
[2022/06/22 14:36:43.273 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:36:43.273 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=2] [schemaVersion=46] [cur_db=test_partition_2] [sql="create table t4 (id int, a int, b int, primary key (a));"] [user=]
[2022/06/22 14:36:43.278 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:110, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:109, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.237 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:36:43.278 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:110, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:109, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.237 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t4 (id int, a int, b int, primary key (a));"]
[2022/06/22 14:36:43.279 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:110, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:109, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:43.237 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.286 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=46] [neededSchemaVersion=47] ["start time"=703.743µs] [phyTblIDs="[109]"] [actionTypes="[8]"]
[2022/06/22 14:36:43.335 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=47] ["take time"=51.327866ms] [job="ID:110, Type:create table, State:done, SchemaState:public, SchemaID:101, TableID:109, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.237 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.336 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:110, Type:create table, State:synced, SchemaState:public, SchemaID:101, TableID:109, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:43.237 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.340 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=110]
[2022/06/22 14:36:43.340 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:36:43.340 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=2] [schemaVersion=47] [cur_db=test_partition_2] [sql="create table t5 (a int, id int, b int, unique key (a,b));"] [user=]
[2022/06/22 14:36:43.345 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:112, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:111, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.337 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:36:43.345 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:112, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:111, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.337 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t5 (a int, id int, b int, unique key (a,b));"]
[2022/06/22 14:36:43.347 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:112, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:111, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:43.337 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.352 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=47] [neededSchemaVersion=48] ["start time"=713.452µs] [phyTblIDs="[111]"] [actionTypes="[8]"]
[2022/06/22 14:36:43.403 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=48] ["take time"=52.126901ms] [job="ID:112, Type:create table, State:done, SchemaState:public, SchemaID:101, TableID:111, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.337 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.404 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:112, Type:create table, State:synced, SchemaState:public, SchemaID:101, TableID:111, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:43.337 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.407 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=112]
[2022/06/22 14:36:43.407 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:36:43.407 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=2] [schemaVersion=48] [cur_db=test_partition_2] [sql="create table t6 (b int, id int, a int, unique key (a,b));"] [user=]
[2022/06/22 14:36:43.412 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:114, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:113, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.387 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:36:43.412 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:114, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:113, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.387 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t6 (b int, id int, a int, unique key (a,b));"]
[2022/06/22 14:36:43.413 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:114, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:113, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:43.387 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.420 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=48] [neededSchemaVersion=49] ["start time"=649.363µs] [phyTblIDs="[113]"] [actionTypes="[8]"]
[2022/06/22 14:36:43.471 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=49] ["take time"=52.730333ms] [job="ID:114, Type:create table, State:done, SchemaState:public, SchemaID:101, TableID:113, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.387 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.472 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:114, Type:create table, State:synced, SchemaState:public, SchemaID:101, TableID:113, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:43.387 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.475 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=114]
[2022/06/22 14:36:43.475 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:36:43.477 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=2] [startTS=434078955192188935] [checkTS=434078955192188936]
[2022/06/22 14:36:43.481 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=2] [startTS=434078955192188938] [checkTS=434078955192188939]
[2022/06/22 14:36:43.485 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=2] [startTS=434078955192188941] [checkTS=434078955192188942]
[2022/06/22 14:36:43.491 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=2] [startTS=434078955205296130] [checkTS=434078955205296131]
[2022/06/22 14:36:43.498 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=2] [startTS=434078955205296133] [checkTS=434078955205296134]
[2022/06/22 14:36:43.500 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=2] [schemaVersion=49] [cur_db=test_partition_2] [sql="create table t7 (a int unsigned);"] [user=]
[2022/06/22 14:36:43.505 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:116, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:115, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.487 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:36:43.505 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:116, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:115, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.487 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t7 (a int unsigned);"]
[2022/06/22 14:36:43.506 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:116, Type:create table, State:queueing, SchemaState:none, SchemaID:101, TableID:115, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:43.487 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.512 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=49] [neededSchemaVersion=50] ["start time"=620.243µs] [phyTblIDs="[115]"] [actionTypes="[8]"]
[2022/06/22 14:36:43.562 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=50] ["take time"=51.536768ms] [job="ID:116, Type:create table, State:done, SchemaState:public, SchemaID:101, TableID:115, RowCount:0, ArgLen:1, start time: 2022-06-22 14:36:43.487 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.564 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:116, Type:create table, State:synced, SchemaState:public, SchemaID:101, TableID:115, RowCount:0, ArgLen:0, start time: 2022-06-22 14:36:43.487 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:36:43.568 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=116]
[2022/06/22 14:36:43.568 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:36:43.570 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=2] [startTS=434078955218403335] [checkTS=434078955218403336]
[2022/06/22 14:36:43.572 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"]
[2022/06/22 14:36:43.572 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"]
[2022/06/22 14:36:43.573 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"] []
[2022/06/22 14:36:43.573 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=450ns]
[2022/06/22 14:36:43.573 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=180ns]
[2022/06/22 14:36:43.573 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:36:43.573 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:36:43.573 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=6b257c56-89e8-48a3-a38c-0f332f31200a] ["take time"=1.083834ms]
[2022/06/22 14:36:43.573 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=6b257c56-89e8-48a3-a38c-0f332f31200a]
[2022/06/22 14:36:43.574 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:36:43.575 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"]
[2022/06/22 14:36:43.575 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"]
[2022/06/22 14:36:43.575 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:36:43.575 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"]
[2022/06/22 14:36:43.575 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"]
[2022/06/22 14:36:43.575 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a watch owner key /tidb/stats/owner/2231818a2087bb48"]
[2022/06/22 14:36:43.575 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"]
[2022/06/22 14:36:43.575 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:36:43.575 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:43644->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:36:43.575 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"]
[2022/06/22 14:36:43.710 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"] [error="context canceled"]
[2022/06/22 14:36:43.911 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:36:46.082 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:36:46.082 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:36:46.113 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:36:46.113 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:36:46.457 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 6b257c56-89e8-48a3-a38c-0f332f31200a"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:36:46.457 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:36:46.457 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.884564108s]
[2022/06/22 14:36:46.457 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=6062882784c0002]
--- FAIL: TestListPartitionPruner (9.97s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				partition_pruner_test.go:315
        	Error:      	Not equal: 
        	            	expected: "[TableReader 0.01 root partition:p1 data:Selection]\n[└─Selection 0.01 cop[tikv]  eq(test_partition.t1.a, 6), eq(test_partition.t1.id, 6)]\n[  └─TableFullScan 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo]\n"
        	            	actual  : "[TableReader 0.01 root  data:Selection]\n[└─Selection 0.01 cop[tikv]  eq(test_partition.t1.a, 6), eq(test_partition.t1.id, 6)]\n[  └─TableFullScan 10000.00 cop[tikv] table:t1, partition:p1 keep order:false, stats:pseudo]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,4 +1,4 @@
        	            	-[TableReader 0.01 root partition:p1 data:Selection]
        	            	+[TableReader 0.01 root  data:Selection]
        	            	 [└─Selection 0.01 cop[tikv]  eq(test_partition.t1.a, 6), eq(test_partition.t1.id, 6)]
        	            	-[  └─TableFullScan 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo]
        	            	+[  └─TableFullScan 10000.00 cop[tikv] table:t1, partition:p1 keep order:false, stats:pseudo]
        	            	 
        	Test:       	TestListPartitionPruner
        	Messages:   	sql:explain format = 'brief' select * from t1 where id = 6 and a = 6, args:[]
FAIL
err=exit status 1
[2022/06/22 14:37:05.133 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:37:05.133 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:37:06.133 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:37:08.855 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 14:37:09.856 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:37:09.856 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:37:09.856 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:37:09.856 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:37:09.860 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:37:09.868 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=3364621] ["lease id"=2231818a20f7c424]
[2022/06/22 14:37:09.871 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:37:09.881 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=6.660956ms]
[2022/06/22 14:37:09.881 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:37:09.881 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=ed9140a6-4e23-4a13-b404-465d964ee512] [runWorker=true]
[2022/06/22 14:37:09.881 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:37:09.882 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:37:09.882 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:37:09.882 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:37:09.885 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"] [ownerID=ed9140a6-4e23-4a13-b404-465d964ee512]
[2022/06/22 14:37:09.891 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:37:09.891 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:37:09.893 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"] [ownerID=ed9140a6-4e23-4a13-b404-465d964ee512]
[2022/06/22 14:37:09.907 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:37:09.920 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:37:09.922 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:37:09.923 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:37:10.084 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:37:10.085 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:37:10.086 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=606288428c40002]
[2022/06/22 14:37:10.088 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"] [ownerID=ed9140a6-4e23-4a13-b404-465d964ee512]
[2022/06/22 14:37:10.088 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"] [ownerID=ed9140a6-4e23-4a13-b404-465d964ee512]
[2022/06/22 14:37:10.091 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=6.548165ms]
[2022/06/22 14:37:10.118 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=606288428c40002]
[2022/06/22 14:37:10.118 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table pt (id int, c int, key i_id(id), key i_c(c)) partition by range (c) (\npartition p0 values less than (4),\npartition p1 values less than (7),\npartition p2 values less than (10))"] [user=]
[2022/06/22 14:37:10.126 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:73, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:37:10.115 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:37:10.126 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:73, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:37:10.115 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table pt (id int, c int, key i_id(id), key i_c(c)) partition by range (c) (\npartition p0 values less than (4),\npartition p1 values less than (7),\npartition p2 values less than (10))"]
[2022/06/22 14:37:10.127 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:73, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:37:10.115 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:37:10.134 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=1.150945ms] [phyTblIDs="[69,70,71,72]"] [actionTypes="[8,8,8,8]"]
[2022/06/22 14:37:10.184 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=52.079286ms] [job="ID:73, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:37:10.115 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:37:10.186 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:73, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:37:10.115 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:37:10.190 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=73]
[2022/06/22 14:37:10.190 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:37:10.190 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"]
[2022/06/22 14:37:10.190 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"]
[2022/06/22 14:37:10.190 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:37:10.191 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"] []
[2022/06/22 14:37:10.191 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=310ns]
[2022/06/22 14:37:10.191 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=140ns]
[2022/06/22 14:37:10.191 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:37:10.191 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:37:10.191 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=ed9140a6-4e23-4a13-b404-465d964ee512] ["take time"=952.854µs]
[2022/06/22 14:37:10.191 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=ed9140a6-4e23-4a13-b404-465d964ee512]
[2022/06/22 14:37:10.192 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:37:10.192 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:37:10.192 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:37:10.192 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:37:10.192 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:37:10.192 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:37:10.192 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:37:10.192 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:37:10.192 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:37:10.192 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:37:10.192 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"]
[2022/06/22 14:37:10.192 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"]
[2022/06/22 14:37:10.192 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:37:10.192 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:37:10.192 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:37:10.192 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"]
[2022/06/22 14:37:10.192 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"]
[2022/06/22 14:37:10.192 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:37:10.192 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:37:10.192 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:37:10.192 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:37:10.192 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:37:10.192 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager ed9140a6-4e23-4a13-b404-465d964ee512 watch owner key /tidb/stats/owner/2231818a20f7c448"]
[2022/06/22 14:37:10.193 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"]
[2022/06/22 14:37:10.193 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:37:10.193 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:43736->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:37:10.193 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"]
[2022/06/22 14:37:10.195 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"] [error="context canceled"]
[2022/06/22 14:37:10.395 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:37:12.729 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:37:12.729 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:37:12.750 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:37:12.750 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:37:12.943 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager ed9140a6-4e23-4a13-b404-465d964ee512"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:37:12.943 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:37:12.943 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.752823128s]
[2022/06/22 14:37:12.943 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=606288428c40002]
[2022/06/22 14:37:12.943 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 14:37:12.943 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestPartitionExplain (7.81s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				integration_test.go:3321
        	Error:      	Not equal: 
        	            	expected: "[TableReader_7 3333.33 root partition:dual data:Selection_6]\n[└─Selection_6 3333.33 cop[tikv]  gt(test.pt.c, 10)]\n[  └─TableFullScan_5 10000.00 cop[tikv] table:pt keep order:false, stats:pseudo]\n"
        	            	actual  : "[TableDual_7 0.00 root  rows:0]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,4 +1,2 @@
        	            	-[TableReader_7 3333.33 root partition:dual data:Selection_6]
        	            	-[└─Selection_6 3333.33 cop[tikv]  gt(test.pt.c, 10)]
        	            	-[  └─TableFullScan_5 10000.00 cop[tikv] table:pt keep order:false, stats:pseudo]
        	            	+[TableDual_7 0.00 root  rows:0]
        	            	 
        	Test:       	TestPartitionExplain
        	Messages:   	sql:explain select * from pt where c > 10, args:[]
FAIL
err=exit status 1
[2022/06/22 14:37:31.772 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:37:31.772 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:37:32.772 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:37:36.463 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 14:37:37.463 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:37:37.464 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:37:37.464 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:37:37.464 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:37:37.471 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:37:37.480 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=2149271] ["lease id"=2231818a215fb424]
[2022/06/22 14:37:37.482 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:37:37.492 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=7.053737ms]
[2022/06/22 14:37:37.492 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:37:37.492 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=99d3d888-6541-42f4-b313-9ee5de387b86] [runWorker=true]
[2022/06/22 14:37:37.492 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:37:37.493 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:37:37.493 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:37:37.493 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:37:37.495 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"] [ownerID=99d3d888-6541-42f4-b313-9ee5de387b86]
[2022/06/22 14:37:37.498 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:37:37.498 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:37:37.500 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"] [ownerID=99d3d888-6541-42f4-b313-9ee5de387b86]
[2022/06/22 14:37:37.514 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:37:37.530 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:37:37.533 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:37:37.533 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:37:37.709 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:37:37.709 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:37:37.711 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=6062885d8380002]
[2022/06/22 14:37:37.712 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"] [ownerID=99d3d888-6541-42f4-b313-9ee5de387b86]
[2022/06/22 14:37:37.713 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"] [ownerID=99d3d888-6541-42f4-b313-9ee5de387b86]
[2022/06/22 14:37:37.714 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=4.941439ms]
[2022/06/22 14:37:37.739 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=6062885d8380002]
[2022/06/22 14:37:37.739 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t"] [user=]
[2022/06/22 14:37:37.739 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t(a int unsigned primary key, b int, c int, index idx_b(b))"] [user=]
[2022/06/22 14:37:37.746 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:37:37.727 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:37:37.746 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:37:37.727 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t(a int unsigned primary key, b int, c int, index idx_b(b))"]
[2022/06/22 14:37:37.747 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:37:37.727 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:37:37.753 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=887.363µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 14:37:37.802 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.230209ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:37:37.727 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:37:37.804 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:37:37.727 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:37:37.807 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:37:37.807 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:37:37.871 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:37:37.828 +08:00] ["end time"=2022/06/22 14:37:37.867 +08:00] [cost=39.721914ms]
[2022/06/22 14:37:37.887 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"]
[2022/06/22 14:37:37.888 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"]
[2022/06/22 14:37:37.888 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"] []
[2022/06/22 14:37:37.888 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=190ns]
[2022/06/22 14:37:37.888 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=50ns]
[2022/06/22 14:37:37.888 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:37:37.888 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:37:37.888 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=99d3d888-6541-42f4-b313-9ee5de387b86] ["take time"=970.053µs]
[2022/06/22 14:37:37.888 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=99d3d888-6541-42f4-b313-9ee5de387b86]
[2022/06/22 14:37:37.889 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:37:37.889 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:37:37.889 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:37:37.889 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:37:37.889 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:37:37.889 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:37:37.889 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:37:37.889 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:37:37.889 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:37:37.889 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:37:37.889 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"]
[2022/06/22 14:37:37.889 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"]
[2022/06/22 14:37:37.889 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:37:37.889 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:37:37.889 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:37:37.889 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"]
[2022/06/22 14:37:37.889 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"]
[2022/06/22 14:37:37.890 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:37:37.890 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:37:37.890 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:37:37.890 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:37:37.890 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:37:37.890 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86 watch owner key /tidb/stats/owner/2231818a215fb448"]
[2022/06/22 14:37:37.890 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"]
[2022/06/22 14:37:37.890 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:37:37.890 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:43800->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:37:37.892 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"] [error="context canceled"]
[2022/06/22 14:37:37.892 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"]
[2022/06/22 14:37:37.892 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:37:40.415 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:37:40.415 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:37:40.418 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:37:40.418 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:37:40.441 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 99d3d888-6541-42f4-b313-9ee5de387b86"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:37:40.441 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:37:40.441 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.55341524s]
[2022/06/22 14:37:40.441 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=6062885d8380002]
--- FAIL: TestPreferRangeScanForUnsignedIntHandle (8.67s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				integration_test.go:5560
        	Error:      	Not equal: 
        	            	expected: "[TableReader_7 3.00 19.21 root  data:Selection_6]\n[└─Selection_6 3.00 195.00 cop[tikv]  gt(test.t.b, 5)]\n[  └─TableFullScan_5 5.00 180.00 cop[tikv] table:t keep order:false]\n"
        	            	actual  : "[TableReader_7 3.00 26.21 root  data:Selection_6]\n[└─Selection_6 3.00 300.00 cop[tikv]  gt(test.t.b, 5)]\n[  └─TableFullScan_5 5.00 285.00 cop[tikv] table:t keep order:false]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,4 +1,4 @@
        	            	-[TableReader_7 3.00 19.21 root  data:Selection_6]
        	            	-[└─Selection_6 3.00 195.00 cop[tikv]  gt(test.t.b, 5)]
        	            	-[  └─TableFullScan_5 5.00 180.00 cop[tikv] table:t keep order:false]
        	            	+[TableReader_7 3.00 26.21 root  data:Selection_6]
        	            	+[└─Selection_6 3.00 300.00 cop[tikv]  gt(test.t.b, 5)]
        	            	+[  └─TableFullScan_5 5.00 285.00 cop[tikv] table:t keep order:false]
        	            	 
        	Test:       	TestPreferRangeScanForUnsignedIntHandle
        	Messages:   	sql:explain format = 'verbose' select * from t where b > 5, args:[]
FAIL
err=exit status 1
[2022/06/22 14:38:00.104 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:38:00.104 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:38:01.104 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:38:04.313 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 14:38:05.315 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:38:05.315 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:38:05.315 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:38:05.315 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:38:05.320 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:38:05.324 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=1750197] ["lease id"=2231818a21ce7624]
[2022/06/22 14:38:05.326 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:38:05.337 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=7.79431ms]
[2022/06/22 14:38:05.337 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:38:05.337 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=3bcc2b0d-8ab0-4f8d-80fa-d52609860dba] [runWorker=true]
[2022/06/22 14:38:05.337 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:38:05.338 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:38:05.338 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:38:05.338 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:38:05.344 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"] [ownerID=3bcc2b0d-8ab0-4f8d-80fa-d52609860dba]
[2022/06/22 14:38:05.349 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:38:05.350 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:38:05.351 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"] [ownerID=3bcc2b0d-8ab0-4f8d-80fa-d52609860dba]
[2022/06/22 14:38:05.366 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:38:05.379 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:38:05.382 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:38:05.382 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:38:05.527 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:38:05.528 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:38:05.529 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=60628878b5c0002]
[2022/06/22 14:38:05.531 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"] [ownerID=3bcc2b0d-8ab0-4f8d-80fa-d52609860dba]
[2022/06/22 14:38:05.531 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"] [ownerID=3bcc2b0d-8ab0-4f8d-80fa-d52609860dba]
[2022/06/22 14:38:05.532 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=4.640288ms]
[2022/06/22 14:38:05.561 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=60628878b5c0002]
[2022/06/22 14:38:05.561 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=] [sql="create database test_partition"] [user=]
[2022/06/22 14:38:05.569 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create schema, State:queueing, SchemaState:none, SchemaID:69, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.527 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:38:05.569 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create schema, State:queueing, SchemaState:none, SchemaID:69, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.527 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create database test_partition"]
[2022/06/22 14:38:05.570 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create schema, State:queueing, SchemaState:none, SchemaID:69, TableID:0, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:05.527 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.574 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=330.751µs] [phyTblIDs="[]"] [actionTypes="[]"]
[2022/06/22 14:38:05.623 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=50.837024ms] [job="ID:70, Type:create schema, State:done, SchemaState:public, SchemaID:69, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.527 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.624 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create schema, State:synced, SchemaState:public, SchemaID:69, TableID:0, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:05.527 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.627 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:38:05.627 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:38:05.628 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test_partition] [sql="drop table if exists t1, t2;"] [user=]
[2022/06/22 14:38:05.628 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test_partition] [sql="create table t2(id int, a int, b int, primary key(id, a)) partition by hash(id + a) partitions 10;"] [user=]
[2022/06/22 14:38:05.635 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:82, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.627 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:38:05.635 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:82, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.627 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t2(id int, a int, b int, primary key(id, a)) partition by hash(id + a) partitions 10;"]
[2022/06/22 14:38:05.636 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:82, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:05.627 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.642 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=1.091304ms] [phyTblIDs="[71,72,73,74,75,76,77,78,79,80,81]"] [actionTypes="[8,8,8,8,8,8,8,8,8,8,8]"]
[2022/06/22 14:38:05.691 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.651237ms] [job="ID:82, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.627 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.693 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:82, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:05.627 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.697 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=82]
[2022/06/22 14:38:05.697 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:38:05.697 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=36] [cur_db=test_partition] [sql="create table t1(id int primary key, a int, b int) partition by hash(id) partitions 10;"] [user=]
[2022/06/22 14:38:05.708 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:94, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:83, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.676 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:38:05.708 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:94, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:83, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.676 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t1(id int primary key, a int, b int) partition by hash(id) partitions 10;"]
[2022/06/22 14:38:05.709 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:94, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:83, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:05.676 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.716 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=36] [neededSchemaVersion=37] ["start time"=889.293µs] [phyTblIDs="[83,84,85,86,87,88,89,90,91,92,93]"] [actionTypes="[8,8,8,8,8,8,8,8,8,8,8]"]
[2022/06/22 14:38:05.765 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=37] ["take time"=50.800994ms] [job="ID:94, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:83, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.676 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.766 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:94, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:83, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:05.676 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.769 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=94]
[2022/06/22 14:38:05.769 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:38:05.769 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=37] [cur_db=test_partition] [sql="create table t3(id int, a int, b int, primary key(id, a)) partition by hash(id) partitions 10;"] [user=]
[2022/06/22 14:38:05.777 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:106, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:95, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.726 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:38:05.777 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:106, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:95, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.726 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t3(id int, a int, b int, primary key(id, a)) partition by hash(id) partitions 10;"]
[2022/06/22 14:38:05.778 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:106, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:95, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:05.726 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.784 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=37] [neededSchemaVersion=38] ["start time"=1.010523ms] [phyTblIDs="[95,96,97,98,99,100,101,102,103,104,105]"] [actionTypes="[8,8,8,8,8,8,8,8,8,8,8]"]
[2022/06/22 14:38:05.833 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=38] ["take time"=51.076723ms] [job="ID:106, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:95, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.726 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.835 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:106, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:95, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:05.726 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.839 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=106]
[2022/06/22 14:38:05.839 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:38:05.840 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=38] [cur_db=test_partition] [sql="create table t4(d datetime, a int, b int, primary key(d, a)) partition by hash(year(d)) partitions 10;"] [user=]
[2022/06/22 14:38:05.847 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:118, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:107, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.826 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:38:05.847 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:118, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:107, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.826 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t4(d datetime, a int, b int, primary key(d, a)) partition by hash(year(d)) partitions 10;"]
[2022/06/22 14:38:05.848 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:118, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:107, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:05.826 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.854 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=38] [neededSchemaVersion=39] ["start time"=786.623µs] [phyTblIDs="[107,108,109,110,111,112,113,114,115,116,117]"] [actionTypes="[8,8,8,8,8,8,8,8,8,8,8]"]
[2022/06/22 14:38:05.903 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=39] ["take time"=51.016354ms] [job="ID:118, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:107, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.826 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.906 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:118, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:107, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:05.826 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.917 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=118]
[2022/06/22 14:38:05.917 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:38:05.917 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=39] [cur_db=test_partition] [sql="create table t5(d date, a int, b int, primary key(d, a)) partition by hash(month(d)) partitions 10;"] [user=]
[2022/06/22 14:38:05.925 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:130, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:119, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.877 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:38:05.925 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:130, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:119, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.877 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t5(d date, a int, b int, primary key(d, a)) partition by hash(month(d)) partitions 10;"]
[2022/06/22 14:38:05.926 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:130, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:119, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:05.877 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.932 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=39] [neededSchemaVersion=40] ["start time"=861.303µs] [phyTblIDs="[119,120,121,122,123,124,125,126,127,128,129]"] [actionTypes="[8,8,8,8,8,8,8,8,8,8,8]"]
[2022/06/22 14:38:05.982 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=40] ["take time"=51.499447ms] [job="ID:130, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:119, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.877 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.983 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:130, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:119, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:05.877 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:05.986 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=130]
[2022/06/22 14:38:05.986 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:38:05.987 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=40] [cur_db=test_partition] [sql="create table t6(a int, b int) partition by hash(a) partitions 3;"] [user=]
[2022/06/22 14:38:05.994 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:135, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:131, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.977 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:38:05.994 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:135, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:131, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.977 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t6(a int, b int) partition by hash(a) partitions 3;"]
[2022/06/22 14:38:05.996 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:135, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:131, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:05.977 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:06.008 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=40] [neededSchemaVersion=41] ["start time"=3.490814ms] [phyTblIDs="[131,132,133,134]"] [actionTypes="[8,8,8,8]"]
[2022/06/22 14:38:06.055 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=41] ["take time"=51.859978ms] [job="ID:135, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:131, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:05.977 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:06.056 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:135, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:131, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:05.977 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:06.060 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=135]
[2022/06/22 14:38:06.060 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:38:06.060 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=41] [cur_db=test_partition] [sql="create table t7(a int, b int) partition by hash(a + b) partitions 10;"] [user=]
[2022/06/22 14:38:06.067 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:147, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:136, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:06.026 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:38:06.067 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:147, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:136, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:06.026 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t7(a int, b int) partition by hash(a + b) partitions 10;"]
[2022/06/22 14:38:06.068 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:147, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:136, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:06.026 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:06.073 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=41] [neededSchemaVersion=42] ["start time"=873.283µs] [phyTblIDs="[136,137,138,139,140,141,142,143,144,145,146]"] [actionTypes="[8,8,8,8,8,8,8,8,8,8,8]"]
[2022/06/22 14:38:06.123 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=42] ["take time"=51.269895ms] [job="ID:147, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:136, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:06.026 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:06.124 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:147, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:136, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:06.026 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:06.128 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=147]
[2022/06/22 14:38:06.128 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:38:06.128 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=42] [cur_db=test_partition] [sql="create table t8(a int, b int) partition by hash(a) partitions 6;"] [user=]
[2022/06/22 14:38:06.136 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:155, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:148, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:06.126 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:38:06.136 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:155, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:148, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:06.126 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t8(a int, b int) partition by hash(a) partitions 6;"]
[2022/06/22 14:38:06.137 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:155, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:148, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:06.126 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:06.145 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=42] [neededSchemaVersion=43] ["start time"=1.121884ms] [phyTblIDs="[148,149,150,151,152,153,154]"] [actionTypes="[8,8,8,8,8,8,8]"]
[2022/06/22 14:38:06.194 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=43] ["take time"=51.894416ms] [job="ID:155, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:148, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:06.126 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:06.197 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:155, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:148, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:06.126 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:06.200 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=155]
[2022/06/22 14:38:06.200 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:38:06.201 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=43] [cur_db=test_partition] [sql="create table t9(a bit(1) default null, b int(11) default null) partition by hash(a) partitions 3;"] [user=]
[2022/06/22 14:38:06.207 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:160, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:156, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:06.177 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:38:06.207 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:160, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:156, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:06.177 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t9(a bit(1) default null, b int(11) default null) partition by hash(a) partitions 3;"]
[2022/06/22 14:38:06.209 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:160, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:156, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:06.177 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:06.216 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=43] [neededSchemaVersion=44] ["start time"=1.109344ms] [phyTblIDs="[156,157,158,159]"] [actionTypes="[8,8,8,8]"]
[2022/06/22 14:38:06.265 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=44] ["take time"=51.605847ms] [job="ID:160, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:156, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:06.177 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:06.267 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:160, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:156, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:06.177 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:06.270 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=160]
[2022/06/22 14:38:06.270 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:38:06.271 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=44] [cur_db=test_partition] [sql="create table t10(a bigint unsigned) partition BY hash (a);"] [user=]
[2022/06/22 14:38:06.279 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:163, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:161, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:06.226 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:38:06.279 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:163, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:161, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:06.226 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t10(a bigint unsigned) partition BY hash (a);"]
[2022/06/22 14:38:06.280 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:163, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:161, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:06.226 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:06.290 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=44] [neededSchemaVersion=45] ["start time"=783.473µs] [phyTblIDs="[161,162]"] [actionTypes="[8,8]"]
[2022/06/22 14:38:06.339 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=45] ["take time"=50.967004ms] [job="ID:163, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:161, RowCount:0, ArgLen:1, start time: 2022-06-22 14:38:06.226 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:06.340 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:163, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:161, RowCount:0, ArgLen:0, start time: 2022-06-22 14:38:06.226 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:38:06.344 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=163]
[2022/06/22 14:38:06.344 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:38:06.345 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"]
[2022/06/22 14:38:06.345 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"]
[2022/06/22 14:38:06.346 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"] []
[2022/06/22 14:38:06.347 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=390ns]
[2022/06/22 14:38:06.347 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=230ns]
[2022/06/22 14:38:06.347 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:38:06.347 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:38:06.347 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=3bcc2b0d-8ab0-4f8d-80fa-d52609860dba] ["take time"=1.683276ms]
[2022/06/22 14:38:06.347 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=3bcc2b0d-8ab0-4f8d-80fa-d52609860dba]
[2022/06/22 14:38:06.347 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:38:06.348 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"]
[2022/06/22 14:38:06.348 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"]
[2022/06/22 14:38:06.348 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:38:06.348 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"]
[2022/06/22 14:38:06.348 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"]
[2022/06/22 14:38:06.348 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba watch owner key /tidb/stats/owner/2231818a21ce7646"]
[2022/06/22 14:38:06.348 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"]
[2022/06/22 14:38:06.348 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:38:06.348 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:43900->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:38:06.348 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"]
[2022/06/22 14:38:06.350 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"] [error="context canceled"]
[2022/06/22 14:38:06.551 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:38:08.885 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:38:08.885 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:38:08.893 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:38:08.893 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:38:09.091 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 3bcc2b0d-8ab0-4f8d-80fa-d52609860dba"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:38:09.091 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:38:09.091 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.746173897s]
[2022/06/22 14:38:09.091 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=60628878b5c0002]
--- FAIL: TestHashPartitionPruner (8.99s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				partition_pruner_test.go:62
        	Error:      	Not equal: 
        	            	expected: "[TableReader 0.00 root partition:p7 data:Selection]\n[└─Selection 0.00 cop[tikv]  eq(test_partition.t1.a, 6)]\n[  └─TableRangeScan 1.00 cop[tikv] table:t1 range:[7,7], keep order:false, stats:pseudo]\n"
        	            	actual  : "[Selection 0.00 root  eq(test_partition.t1.a, 6)]\n[└─Point_Get 1.00 root table:t1, partition:p7 handle:7]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,4 +1,3 @@
        	            	-[TableReader 0.00 root partition:p7 data:Selection]
        	            	-[└─Selection 0.00 cop[tikv]  eq(test_partition.t1.a, 6)]
        	            	-[  └─TableRangeScan 1.00 cop[tikv] table:t1 range:[7,7], keep order:false, stats:pseudo]
        	            	+[Selection 0.00 root  eq(test_partition.t1.a, 6)]
        	            	+[└─Point_Get 1.00 root table:t1, partition:p7 handle:7]
        	            	 
        	Test:       	TestHashPartitionPruner
        	Messages:   	sql:explain format = 'brief' select * from t1 where id = 7 and a = 6, args:[]
FAIL
err=exit status 1
[2022/06/22 14:42:30.946 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:42:30.947 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:42:31.947 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:42:34.133 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 14:42:35.134 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:42:35.134 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:42:35.134 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:42:35.134 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:42:35.139 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:42:35.147 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=2913553] ["lease id"=2231818a25f05a24]
[2022/06/22 14:42:35.149 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:42:35.158 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=6.994413ms]
[2022/06/22 14:42:35.158 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:42:35.158 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=264ec97c-1954-403f-9f05-13a800d4e9ad] [runWorker=true]
[2022/06/22 14:42:35.158 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:42:35.159 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:42:35.159 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:42:35.159 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:42:35.162 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"] [ownerID=264ec97c-1954-403f-9f05-13a800d4e9ad]
[2022/06/22 14:42:35.168 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:42:35.169 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:42:35.170 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"] [ownerID=264ec97c-1954-403f-9f05-13a800d4e9ad]
[2022/06/22 14:42:35.185 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:42:35.198 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:42:35.200 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:42:35.201 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:42:35.372 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:42:35.372 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:42:35.374 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=606289803580002]
[2022/06/22 14:42:35.375 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"] [ownerID=264ec97c-1954-403f-9f05-13a800d4e9ad]
[2022/06/22 14:42:35.375 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"] [ownerID=264ec97c-1954-403f-9f05-13a800d4e9ad]
[2022/06/22 14:42:35.377 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=4.604915ms]
[2022/06/22 14:42:35.399 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=606289803580002]
[2022/06/22 14:42:35.399 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists a"] [user=]
[2022/06/22 14:42:35.400 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table a(id int, value int)"] [user=]
[2022/06/22 14:42:35.406 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:42:35.4 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:42:35.406 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:42:35.4 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table a(id int, value int)"]
[2022/06/22 14:42:35.407 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:42:35.4 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:42:35.413 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=842.092µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 14:42:35.462 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.312698ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:42:35.4 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:42:35.463 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:42:35.4 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:42:35.466 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:42:35.466 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:42:35.468 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079047470284807] [checkTS=434079047470284808]
[2022/06/22 14:42:35.510 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`a` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:42:35.478 +08:00] ["end time"=2022/06/22 14:42:35.506 +08:00] [cost=28.197464ms]
[2022/06/22 14:42:35.519 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="drop table if exists b"] [user=]
[2022/06/22 14:42:35.519 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="create table b(id int, value int)"] [user=]
[2022/06/22 14:42:35.524 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:42:35.5 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:42:35.524 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:42:35.5 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table b(id int, value int)"]
[2022/06/22 14:42:35.525 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:42:35.5 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:42:35.531 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=566.992µs] [phyTblIDs="[71]"] [actionTypes="[8]"]
[2022/06/22 14:42:35.581 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.281597ms] [job="ID:72, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:42:35.5 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:42:35.582 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:42:35.5 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:42:35.585 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=72]
[2022/06/22 14:42:35.585 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:42:35.587 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079047496499207] [checkTS=434079047496499208]
[2022/06/22 14:42:35.614 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`b` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:42:35.592 +08:00] ["end time"=2022/06/22 14:42:35.611 +08:00] [cost=18.37782ms]
[2022/06/22 14:42:35.624 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"]
[2022/06/22 14:42:35.624 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"]
[2022/06/22 14:42:35.625 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"] []
[2022/06/22 14:42:35.625 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=220ns]
[2022/06/22 14:42:35.625 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=150ns]
[2022/06/22 14:42:35.625 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:42:35.625 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:42:35.625 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=264ec97c-1954-403f-9f05-13a800d4e9ad] ["take time"=1.058684ms]
[2022/06/22 14:42:35.625 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=264ec97c-1954-403f-9f05-13a800d4e9ad]
[2022/06/22 14:42:35.626 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:42:35.626 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:42:35.626 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:42:35.626 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:42:35.626 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:42:35.626 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:42:35.626 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:42:35.626 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:42:35.626 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:42:35.626 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:42:35.626 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"]
[2022/06/22 14:42:35.626 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"]
[2022/06/22 14:42:35.626 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:42:35.626 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:42:35.626 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:42:35.626 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:42:35.626 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:42:35.626 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:42:35.626 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:42:35.626 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:42:35.626 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"]
[2022/06/22 14:42:35.626 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"]
[2022/06/22 14:42:35.626 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:42:35.626 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad watch owner key /tidb/stats/owner/2231818a25f05a48"]
[2022/06/22 14:42:35.626 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"]
[2022/06/22 14:42:35.626 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:42:35.627 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:44828->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:42:35.627 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"]
[2022/06/22 14:42:35.642 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"] [error="context canceled"]
[2022/06/22 14:42:35.842 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:42:38.139 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:42:38.139 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:42:38.160 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:42:38.160 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:42:38.353 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 264ec97c-1954-403f-9f05-13a800d4e9ad"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:42:38.354 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:42:38.354 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.729393408s]
[2022/06/22 14:42:38.354 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=606289803580002]
--- FAIL: TestMPPOuterJoinBuildSideForShuffleJoin (7.41s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				integration_test.go:804
        	Error:      	Not equal: 
        	            	expected: "[StreamAgg 1.00 root  funcs:count(1)->Column#7]\n[└─TableReader 2.00 root  data:ExchangeSender]\n[  └─ExchangeSender 2.00 mpp[tiflash]  ExchangeType: PassThrough]\n[    └─HashJoin 2.00 mpp[tiflash]  right outer join, equal:[eq(test.b.id, test.a.id)]]\n[      ├─ExchangeReceiver(Build) 2.00 mpp[tiflash]  ]\n[      │ └─ExchangeSender 2.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: test.a.id, collate: binary]]\n[      │   └─TableFullScan 2.00 mpp[tiflash] table:a keep order:false]\n[      └─ExchangeReceiver(Probe) 3.00 mpp[tiflash]  ]\n[        └─ExchangeSender 3.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: test.b.id, collate: binary]]\n[          └─Selection 3.00 mpp[tiflash]  not(isnull(test.b.id))]\n[            └─TableFullScan 3.00 mpp[tiflash] table:b keep order:false]\n"
        	            	actual  : "[StreamAgg 1.00 root  funcs:count(1)->Column#7]\n[└─TableReader 2.00 root  data:ExchangeSender]\n[  └─ExchangeSender 2.00 mpp[tiflash]  ExchangeType: PassThrough]\n[    └─HashJoin 2.00 mpp[tiflash]  right outer join, equal:[eq(test.b.id, test.a.id)]]\n[      ├─ExchangeReceiver(Build) 3.00 mpp[tiflash]  ]\n[      │ └─ExchangeSender 3.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: test.b.id, collate: binary]]\n[      │   └─Selection 3.00 mpp[tiflash]  not(isnull(test.b.id))]\n[      │     └─TableFullScan 3.00 mpp[tiflash] table:b keep order:false]\n[      └─ExchangeReceiver(Probe) 2.00 mpp[tiflash]  ]\n[        └─ExchangeSender 2.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: test.a.id, collate: binary]]\n[          └─TableFullScan 2.00 mpp[tiflash] table:a keep order:false]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -4,9 +4,9 @@
        	            	 [    └─HashJoin 2.00 mpp[tiflash]  right outer join, equal:[eq(test.b.id, test.a.id)]]
        	            	-[      ├─ExchangeReceiver(Build) 2.00 mpp[tiflash]  ]
        	            	-[      │ └─ExchangeSender 2.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: test.a.id, collate: binary]]
        	            	-[      │   └─TableFullScan 2.00 mpp[tiflash] table:a keep order:false]
        	            	-[      └─ExchangeReceiver(Probe) 3.00 mpp[tiflash]  ]
        	            	-[        └─ExchangeSender 3.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: test.b.id, collate: binary]]
        	            	-[          └─Selection 3.00 mpp[tiflash]  not(isnull(test.b.id))]
        	            	-[            └─TableFullScan 3.00 mpp[tiflash] table:b keep order:false]
        	            	+[      ├─ExchangeReceiver(Build) 3.00 mpp[tiflash]  ]
        	            	+[      │ └─ExchangeSender 3.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: test.b.id, collate: binary]]
        	            	+[      │   └─Selection 3.00 mpp[tiflash]  not(isnull(test.b.id))]
        	            	+[      │     └─TableFullScan 3.00 mpp[tiflash] table:b keep order:false]
        	            	+[      └─ExchangeReceiver(Probe) 2.00 mpp[tiflash]  ]
        	            	+[        └─ExchangeSender 2.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: test.a.id, collate: binary]]
        	            	+[          └─TableFullScan 2.00 mpp[tiflash] table:a keep order:false]
        	            	 
        	Test:       	TestMPPOuterJoinBuildSideForShuffleJoin
        	Messages:   	sql:explain format = 'brief' select count(*) from b right join a on a.id = b.id, args:[]
FAIL
err=exit status 1
[2022/06/22 14:46:10.838 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:46:10.838 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:46:11.838 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:46:14.549 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 14:46:15.550 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:46:15.550 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:46:15.550 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:46:15.550 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:46:15.554 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:46:15.562 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=2751886] ["lease id"=2231818a294b6624]
[2022/06/22 14:46:15.564 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:46:15.585 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=13.467793ms]
[2022/06/22 14:46:15.585 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:46:15.585 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=18bc095a-bf6c-46cb-9c44-a96814683531] [runWorker=true]
[2022/06/22 14:46:15.585 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:46:15.586 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:46:15.586 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:46:15.586 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:46:15.588 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"] [ownerID=18bc095a-bf6c-46cb-9c44-a96814683531]
[2022/06/22 14:46:15.592 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:46:15.592 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:46:15.594 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"] [ownerID=18bc095a-bf6c-46cb-9c44-a96814683531]
[2022/06/22 14:46:15.608 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:46:15.622 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:46:15.624 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:46:15.625 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:46:15.783 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:46:15.784 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:46:15.785 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=60628a577580002]
[2022/06/22 14:46:15.787 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"] [ownerID=18bc095a-bf6c-46cb-9c44-a96814683531]
[2022/06/22 14:46:15.787 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"] [ownerID=18bc095a-bf6c-46cb-9c44-a96814683531]
[2022/06/22 14:46:15.789 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=4.95979ms]
[2022/06/22 14:46:15.811 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=60628a577580002]
[2022/06/22 14:46:15.811 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t1"] [user=]
[2022/06/22 14:46:15.812 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t1(a int, b int, c int);"] [user=]
[2022/06/22 14:46:15.818 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:46:15.766 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:46:15.818 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:46:15.766 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t1(a int, b int, c int);"]
[2022/06/22 14:46:15.819 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:46:15.766 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:46:15.825 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=1.021961ms] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 14:46:15.874 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.048655ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:46:15.766 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:46:15.875 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:46:15.766 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:46:15.878 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:46:15.878 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:46:15.880 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079105251016711] [checkTS=434079105251016712]
[2022/06/22 14:46:15.939 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t1` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:46:15.907 +08:00] ["end time"=2022/06/22 14:46:15.936 +08:00] [cost=28.95741ms]
[2022/06/22 14:46:15.952 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"]
[2022/06/22 14:46:15.952 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"]
[2022/06/22 14:46:15.952 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:46:15.952 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"] []
[2022/06/22 14:46:15.953 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=170ns]
[2022/06/22 14:46:15.953 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=540ns]
[2022/06/22 14:46:15.953 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:46:15.953 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:46:15.953 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=18bc095a-bf6c-46cb-9c44-a96814683531] ["take time"=1.017742ms]
[2022/06/22 14:46:15.953 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=18bc095a-bf6c-46cb-9c44-a96814683531]
[2022/06/22 14:46:15.954 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:46:15.954 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"]
[2022/06/22 14:46:15.954 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"]
[2022/06/22 14:46:15.954 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:46:15.954 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"]
[2022/06/22 14:46:15.954 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"]
[2022/06/22 14:46:15.954 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531 watch owner key /tidb/stats/owner/2231818a294b6648"]
[2022/06/22 14:46:15.954 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"]
[2022/06/22 14:46:15.954 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:46:15.954 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:45582->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:46:15.954 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"]
[2022/06/22 14:46:15.962 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"] [error="context canceled"]
[2022/06/22 14:46:16.163 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:46:18.480 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:46:18.480 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:46:18.490 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:46:18.490 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:46:18.698 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 18bc095a-bf6c-46cb-9c44-a96814683531"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:46:18.698 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:46:18.698 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.745881755s]
[2022/06/22 14:46:18.698 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=60628a577580002]
--- FAIL: TestDNFCondSelectivityWithConst (7.86s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				integration_test.go:6281
        	Error:      	Not equal: 
        	            	expected: "[TableReader 1.99 root  data:Selection]\n[└─Selection 1.99 cop[tikv]  or(eq(test.t1.a, 1), eq(test.t1.b, 1))]\n[  └─TableFullScan 129.00 cop[tikv] table:t1 keep order:false]\n"
        	            	actual  : "[TableReader 0.26 root  data:Selection]\n[└─Selection 0.26 cop[tikv]  or(eq(test.t1.a, 1), eq(test.t1.b, 1))]\n[  └─TableFullScan 129.00 cop[tikv] table:t1 keep order:false]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,3 +1,3 @@
        	            	-[TableReader 1.99 root  data:Selection]
        	            	-[└─Selection 1.99 cop[tikv]  or(eq(test.t1.a, 1), eq(test.t1.b, 1))]
        	            	+[TableReader 0.26 root  data:Selection]
        	            	+[└─Selection 0.26 cop[tikv]  or(eq(test.t1.a, 1), eq(test.t1.b, 1))]
        	            	 [  └─TableFullScan 129.00 cop[tikv] table:t1 keep order:false]
        	Test:       	TestDNFCondSelectivityWithConst
        	Messages:   	sql:explain format = 'brief' select * from t1 where a=1 or b=1;, args:[]
FAIL
err=exit status 1
[2022/06/22 14:46:37.218 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:46:37.218 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:46:38.218 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:46:42.221 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING: error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING"]
[2022/06/22 14:46:43.222 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:46:43.222 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:46:43.222 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:46:43.222 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:46:45.227 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:46:45.232 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=649486] ["lease id"=2231818a29b25f27]
[2022/06/22 14:46:45.235 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:46:51.231 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=4.005956142s]
[2022/06/22 14:46:51.231 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:46:51.231 +08:00] [WARN] [domain.go:449] ["loading schema takes a long time"] ["take time"=5.994670351s]
[2022/06/22 14:46:51.231 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=32e5642d-aac4-41fd-8848-0919441ac553] [runWorker=true]
[2022/06/22 14:46:51.231 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:46:51.232 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:46:51.232 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:46:51.232 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:46:51.236 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"] [ownerID=32e5642d-aac4-41fd-8848-0919441ac553]
[2022/06/22 14:46:51.242 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:46:51.243 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:46:51.244 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"] [ownerID=32e5642d-aac4-41fd-8848-0919441ac553]
[2022/06/22 14:46:51.259 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:46:51.531 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:46:51.534 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:46:51.534 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:46:51.679 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:46:51.679 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:46:51.683 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=3.919829ms]
[2022/06/22 14:46:51.684 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=60628a7a8680002]
[2022/06/22 14:46:51.686 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"] [ownerID=32e5642d-aac4-41fd-8848-0919441ac553]
[2022/06/22 14:46:51.686 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"] [ownerID=32e5642d-aac4-41fd-8848-0919441ac553]
[2022/06/22 14:46:52.193 +08:00] [WARN] [adapter.go:1095] ["# Txn_start_ts: 434079114637869063\n# Query_time: 0.506209579\n# Parse_time: 0\n# Compile_time: 0.000092463\n# Rewrite_time: 0.000016949\n# Optimize_time: 0\n# Wait_TS: 0.000097142\n# Prewrite_time: 0.002628575 Commit_time: 0.001693102 Get_commit_ts_time: 0.000134589 Write_keys: 1 Write_size: 109 Prewrite_region: 1\n# Is_internal: true\n# Digest: 61f4cce222f1a26d6b0650865051ebed3d077412ae053636e2f5acf9dc426a42\n# Num_cop_tasks: 0\n# Mem_max: 403\n# Prepared: false\n# Plan_from_cache: false\n# Plan_from_binding: false\n# Has_more_results: false\n# KV_total: 0\n# PD_total: 0\n# Backoff_total: 0\n# Write_sql_response_total: 0\n# Result_rows: 0\n# Succ: true\n# IsExplicitTxn: false\n# Plan: tidb_decode_plan('jgTYMAkyN18xCTAJMAlOL0EJMAl0aW1lOjY2My44wrVzLCBsb29wczoxLCBwcmVwYXJlOiAxMTAuMQUcUGNoZWNrX2luc2VydDoge3RvdGFsXwVAFCA1NTMuNwUlCG1lbQ0jDRsMNDYuNgUaMHByZWZldGNoOiA1MDcNU0hycGM6e0JhdGNoR2V0OntudW1fARMIMiwgHV5UNDcxLjXCtXN9LCBzY2FuX2RldGFpbBWCNHByb2Nlc3Nfa2V5czogFTsuFwAkX3NpemU6IDIwOBFZFS2Ycm9ja3NkYjoge2RlbGV0ZV9za2lwcGVkX2NvdW50OiAwLCBrZXlfRhYAQGJsb2NrOiB7Y2FjaGVfaGl0ETIYMTIsIHJlYS5CAAUPNGJ5dGU6IDAgQnl0ZXN9AQGQLCBjb21taXRfdHhuOiB7cHJld3JpdGU6Mi42M21zLCBnZXRfYw0iFHM6MTM0LilKCTYQOjEuNjkBJyRyZWdpb25fbnVtIbkFQwngBDEsDQ4Fe0gxMDl9CTQwMyBCeXRlcwlOL0EK')\nINSERT HIGH_PRIORITY INTO mysql.tidb VALUES ('tikv_gc_leader_uuid', '60628a7a8680002', 'Current GC worker leader UUID. (DO NOT EDIT)')           ON DUPLICATE KEY           UPDATE variable_value = '60628a7a8680002', comment = 'Current GC worker leader UUID. (DO NOT EDIT)';"]
[2022/06/22 14:46:52.211 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=60628a7a8680002]
[2022/06/22 14:46:52.211 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t1, t2"] [user=]
[2022/06/22 14:46:52.212 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t1(a int not null, c int not null)"] [user=]
[2022/06/22 14:46:52.220 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:46:52.174 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:46:52.220 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:46:52.174 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t1(a int not null, c int not null)"]
[2022/06/22 14:46:52.222 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:46:52.174 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:46:52.229 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=701.573µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 14:46:52.279 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.371504ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:46:52.174 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:46:52.280 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:46:52.174 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:46:52.283 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:46:52.283 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:46:52.284 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="create table t2(a int not null, b int not null, c int not null, primary key(a,b))"] [user=]
[2022/06/22 14:46:52.289 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:46:52.274 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:46:52.289 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:46:52.274 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t2(a int not null, b int not null, c int not null, primary key(a,b))"]
[2022/06/22 14:46:52.290 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:46:52.274 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:46:52.296 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=693.264µs] [phyTblIDs="[71]"] [actionTypes="[8]"]
[2022/06/22 14:46:52.346 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.222675ms] [job="ID:72, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:46:52.274 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:46:52.347 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:46:52.274 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:46:52.350 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=72]
[2022/06/22 14:46:52.350 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:46:52.352 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079114808262663] [checkTS=434079114808262664]
[2022/06/22 14:46:52.356 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079114808262666] [checkTS=434079114808262667]
[2022/06/22 14:46:52.408 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t2` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:46:52.369 +08:00] ["end time"=2022/06/22 14:46:52.400 +08:00] [cost=30.627767ms]
[2022/06/22 14:46:52.424 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t1` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:46:52.369 +08:00] ["end time"=2022/06/22 14:46:52.421 +08:00] [cost=51.678719ms]
[2022/06/22 14:46:52.448 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"]
[2022/06/22 14:46:52.448 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"]
[2022/06/22 14:46:52.448 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"] []
[2022/06/22 14:46:52.448 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=160ns]
[2022/06/22 14:46:52.448 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=50ns]
[2022/06/22 14:46:52.448 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:46:52.448 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:46:52.448 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=32e5642d-aac4-41fd-8848-0919441ac553] ["take time"=981.45µs]
[2022/06/22 14:46:52.448 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=32e5642d-aac4-41fd-8848-0919441ac553]
[2022/06/22 14:46:52.449 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:46:52.449 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:46:52.449 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:46:52.449 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:46:52.449 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:46:52.449 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:46:52.449 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:46:52.449 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:46:52.449 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:46:52.449 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"]
[2022/06/22 14:46:52.449 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"]
[2022/06/22 14:46:52.449 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:46:52.449 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:46:52.449 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:46:52.450 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:46:52.450 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"]
[2022/06/22 14:46:52.450 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"]
[2022/06/22 14:46:52.450 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:46:52.450 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:46:52.450 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:46:52.450 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:46:52.450 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:46:52.450 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 32e5642d-aac4-41fd-8848-0919441ac553 watch owner key /tidb/stats/owner/2231818a29b25f56"]
[2022/06/22 14:46:52.450 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"]
[2022/06/22 14:46:52.450 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:46:52.450 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:45682->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:46:52.450 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"]
[2022/06/22 14:46:52.464 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"] [error="context canceled"]
[2022/06/22 14:46:52.664 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:46:54.953 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:46:54.953 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:46:54.972 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:46:54.972 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:46:55.200 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 32e5642d-aac4-41fd-8848-0919441ac553"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:46:55.200 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:46:55.200 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.752949748s]
[2022/06/22 14:46:55.200 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=60628a7a8680002]
[2022/06/22 14:46:55.201 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 14:46:55.201 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestIndexJoinUniqueCompositeIndex (17.98s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				integration_test.go:1605
        	Error:      	Not equal: 
        	            	expected: "[IndexJoin 1.00 root  inner join, inner:IndexLookUp, outer key:test.t1.a, inner key:test.t2.a, equal cond:eq(test.t1.a, test.t2.a)]\n[├─TableReader(Build) 1.00 root  data:TableFullScan]\n[│ └─TableFullScan 1.00 cop[tikv] table:t1 keep order:false]\n[└─IndexLookUp(Probe) 1.00 root  ]\n[  ├─IndexRangeScan(Build) 1.00 cop[tikv] table:t2, index:PRIMARY(a, b) range: decided by [eq(test.t2.a, test.t1.a) eq(test.t2.b, 1)], keep order:false]\n[  └─TableRowIDScan(Probe) 1.00 cop[tikv] table:t2 keep order:false]\n"
        	            	actual  : "[IndexJoin 0.00 root  inner join, inner:IndexLookUp, outer key:test.t1.a, inner key:test.t2.a, equal cond:eq(test.t1.a, test.t2.a)]\n[├─TableReader(Build) 1.00 root  data:TableFullScan]\n[│ └─TableFullScan 1.00 cop[tikv] table:t1 keep order:false]\n[└─IndexLookUp(Probe) 0.00 root  ]\n[  ├─IndexRangeScan(Build) 0.00 cop[tikv] table:t2, index:PRIMARY(a, b) range: decided by [eq(test.t2.a, test.t1.a) eq(test.t2.b, 1)], keep order:false]\n[  └─TableRowIDScan(Probe) 0.00 cop[tikv] table:t2 keep order:false]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,7 +1,7 @@
        	            	-[IndexJoin 1.00 root  inner join, inner:IndexLookUp, outer key:test.t1.a, inner key:test.t2.a, equal cond:eq(test.t1.a, test.t2.a)]
        	            	+[IndexJoin 0.00 root  inner join, inner:IndexLookUp, outer key:test.t1.a, inner key:test.t2.a, equal cond:eq(test.t1.a, test.t2.a)]
        	            	 [├─TableReader(Build) 1.00 root  data:TableFullScan]
        	            	 [│ └─TableFullScan 1.00 cop[tikv] table:t1 keep order:false]
        	            	-[└─IndexLookUp(Probe) 1.00 root  ]
        	            	-[  ├─IndexRangeScan(Build) 1.00 cop[tikv] table:t2, index:PRIMARY(a, b) range: decided by [eq(test.t2.a, test.t1.a) eq(test.t2.b, 1)], keep order:false]
        	            	-[  └─TableRowIDScan(Probe) 1.00 cop[tikv] table:t2 keep order:false]
        	            	+[└─IndexLookUp(Probe) 0.00 root  ]
        	            	+[  ├─IndexRangeScan(Build) 0.00 cop[tikv] table:t2, index:PRIMARY(a, b) range: decided by [eq(test.t2.a, test.t1.a) eq(test.t2.b, 1)], keep order:false]
        	            	+[  └─TableRowIDScan(Probe) 0.00 cop[tikv] table:t2 keep order:false]
        	            	 
        	Test:       	TestIndexJoinUniqueCompositeIndex
        	Messages:   	sql:explain format = 'brief' select /*+ TIDB_INLJ(t2) */ * from t1 join t2 on t1.a = t2.a and t2.b = 1, args:[]
FAIL
err=exit status 1
[2022/06/22 14:49:55.061 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:49:55.061 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:49:56.061 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:50:00.064 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING: error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING"]
[2022/06/22 14:50:01.066 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:50:01.066 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:50:01.066 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:50:01.066 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:50:03.074 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:50:03.082 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=2991328] ["lease id"=2231818a2cb74027]
[2022/06/22 14:50:03.084 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:50:09.078 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=4.005722398s]
[2022/06/22 14:50:09.078 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:50:09.078 +08:00] [WARN] [domain.go:449] ["loading schema takes a long time"] ["take time"=5.992657706s]
[2022/06/22 14:50:09.078 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=fc8cd862-b7c6-48c9-9be4-f5343c14d8b6] [runWorker=true]
[2022/06/22 14:50:09.078 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:50:09.083 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:50:09.083 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:50:09.083 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:50:09.085 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"] [ownerID=fc8cd862-b7c6-48c9-9be4-f5343c14d8b6]
[2022/06/22 14:50:09.088 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:50:09.089 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:50:09.090 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"] [ownerID=fc8cd862-b7c6-48c9-9be4-f5343c14d8b6]
[2022/06/22 14:50:09.109 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:50:09.362 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:50:09.365 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:50:09.365 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:50:10.573 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:50:10.573 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:50:10.576 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=3.759223ms]
[2022/06/22 14:50:10.577 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=60628b3cb980002]
[2022/06/22 14:50:10.579 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"] [ownerID=fc8cd862-b7c6-48c9-9be4-f5343c14d8b6]
[2022/06/22 14:50:10.579 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"] [ownerID=fc8cd862-b7c6-48c9-9be4-f5343c14d8b6]
[2022/06/22 14:50:10.602 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=60628b3cb980002]
[2022/06/22 14:50:10.603 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t1"] [user=]
[2022/06/22 14:50:10.603 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t (a int, b varchar(20), c decimal(40,10), d int, primary key(a,b), key(c))"] [user=]
[2022/06/22 14:50:10.609 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:50:10.583 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:50:10.609 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:50:10.583 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t (a int, b varchar(20), c decimal(40,10), d int, primary key(a,b), key(c))"]
[2022/06/22 14:50:10.610 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:50:10.583 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:50:10.617 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=1.351589ms] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 14:50:10.666 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.114736ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:50:10.583 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:50:10.667 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:50:10.583 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:50:10.670 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:50:10.670 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:50:10.726 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:50:10.679 +08:00] ["end time"=2022/06/22 14:50:10.723 +08:00] [cost=43.567892ms]
[2022/06/22 14:50:10.763 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"]
[2022/06/22 14:50:10.763 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"]
[2022/06/22 14:50:10.763 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:50:10.764 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"] []
[2022/06/22 14:50:10.764 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=470ns]
[2022/06/22 14:50:10.764 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=170ns]
[2022/06/22 14:50:10.764 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:50:10.764 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:50:10.764 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=fc8cd862-b7c6-48c9-9be4-f5343c14d8b6] ["take time"=1.48915ms]
[2022/06/22 14:50:10.765 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=fc8cd862-b7c6-48c9-9be4-f5343c14d8b6]
[2022/06/22 14:50:10.765 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:50:10.766 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"]
[2022/06/22 14:50:10.766 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"]
[2022/06/22 14:50:10.766 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:50:10.766 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"]
[2022/06/22 14:50:10.766 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"]
[2022/06/22 14:50:10.766 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6 watch owner key /tidb/stats/owner/2231818a2cb74057"]
[2022/06/22 14:50:10.766 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"]
[2022/06/22 14:50:10.766 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:50:10.766 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:46334->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:50:10.766 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"]
[2022/06/22 14:50:10.776 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"] [error="context canceled"]
[2022/06/22 14:50:10.977 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:50:13.291 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:50:13.291 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:50:13.305 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:50:13.305 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:50:13.533 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager fc8cd862-b7c6-48c9-9be4-f5343c14d8b6"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:50:13.533 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:50:13.533 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.769962049s]
[2022/06/22 14:50:13.533 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=60628b3cb980002]
--- FAIL: TestIndexJoinOnClusteredIndex (18.47s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				integration_test.go:2704
        	Error:      	Not equal: 
        	            	expected: "[IndexMergeJoin 3.00 root  left outer join, inner:Projection, outer key:Column#9, inner key:test.t.c]\n[├─Projection(Build) 3.00 root  cast(test.t.a, decimal(20,0) BINARY)->Column#9]\n[│ └─TableReader 3.00 root  data:TableFullScan]\n[│   └─TableFullScan 3.00 cop[tikv] table:t1 keep order:false]\n[└─Projection(Probe) 1.00 root  test.t.a, test.t.c, test.t.d]\n[  └─IndexLookUp 1.00 root  ]\n[    ├─IndexRangeScan(Build) 1.00 cop[tikv] table:t2, index:c(c) range: decided by [eq(test.t.c, Column#9)], keep order:true]\n[    └─TableRowIDScan(Probe) 1.00 cop[tikv] table:t2 keep order:false]\n"
        	            	actual  : "[IndexMergeJoin 3.00 root  left outer join, inner:Projection, outer key:Column#9, inner key:test.t.c]\n[├─Projection(Build) 3.00 root  cast(test.t.a, decimal(20,0) BINARY)->Column#9]\n[│ └─IndexReader 3.00 root  index:IndexFullScan]\n[│   └─IndexFullScan 3.00 cop[tikv] table:t1, index:c(c) keep order:false]\n[└─Projection(Probe) 1.00 root  test.t.a, test.t.c, test.t.d]\n[  └─IndexLookUp 1.00 root  ]\n[    ├─IndexRangeScan(Build) 1.00 cop[tikv] table:t2, index:c(c) range: decided by [eq(test.t.c, Column#9)], keep order:true]\n[    └─TableRowIDScan(Probe) 1.00 cop[tikv] table:t2 keep order:false]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -2,4 +2,4 @@
        	            	 [├─Projection(Build) 3.00 root  cast(test.t.a, decimal(20,0) BINARY)->Column#9]
        	            	-[│ └─TableReader 3.00 root  data:TableFullScan]
        	            	-[│   └─TableFullScan 3.00 cop[tikv] table:t1 keep order:false]
        	            	+[│ └─IndexReader 3.00 root  index:IndexFullScan]
        	            	+[│   └─IndexFullScan 3.00 cop[tikv] table:t1, index:c(c) keep order:false]
        	            	 [└─Projection(Probe) 1.00 root  test.t.a, test.t.c, test.t.d]
        	Test:       	TestIndexJoinOnClusteredIndex
        	Messages:   	sql:explain  format = 'brief'select /*+ inl_merge_join(t1,t2) */ t2.a, t2.c, t2.d from t t1 left join t t2 on t1.a = t2.c;, args:[]
FAIL
err=exit status 1
[2022/06/22 14:52:28.627 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:52:28.627 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:52:29.627 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:52:33.630 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING: error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING"]
[2022/06/22 14:52:34.633 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:52:34.633 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:52:34.633 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:52:34.633 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:52:34.637 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:52:34.642 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=1960732] ["lease id"=2231818a2f0f2024]
[2022/06/22 14:52:34.645 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:52:34.653 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=6.608543ms]
[2022/06/22 14:52:34.654 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:52:34.654 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da] [runWorker=true]
[2022/06/22 14:52:34.654 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:52:34.655 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:52:34.655 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:52:34.655 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:52:34.656 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"] [ownerID=5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da]
[2022/06/22 14:52:34.660 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:52:34.661 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:52:34.668 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"] [ownerID=5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da]
[2022/06/22 14:52:34.685 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:52:34.700 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:52:34.702 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:52:34.703 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:52:34.835 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:52:34.835 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:52:34.837 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=60628bc99bc0002]
[2022/06/22 14:52:34.838 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"] [ownerID=5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da]
[2022/06/22 14:52:34.839 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"] [ownerID=5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da]
[2022/06/22 14:52:34.840 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=5.130498ms]
[2022/06/22 14:52:34.868 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=60628bc99bc0002]
[2022/06/22 14:52:34.868 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists tbl"] [user=]
[2022/06/22 14:52:34.868 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table tbl(a int, b int, c int, key idx_b_c(b,c))"] [user=]
[2022/06/22 14:52:34.875 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:52:34.849 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:52:34.875 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:52:34.849 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table tbl(a int, b int, c int, key idx_b_c(b,c))"]
[2022/06/22 14:52:34.876 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:52:34.849 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:52:34.882 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=956.613µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 14:52:34.931 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=50.962262ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:52:34.849 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:52:34.932 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:52:34.849 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:52:34.935 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:52:34.935 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:52:34.938 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079204612505607] [checkTS=434079204612505608]
[2022/06/22 14:52:34.998 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`tbl` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:52:34.947 +08:00] ["end time"=2022/06/22 14:52:34.993 +08:00] [cost=46.437504ms]
[2022/06/22 14:52:35.014 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"]
[2022/06/22 14:52:35.014 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"]
[2022/06/22 14:52:35.014 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:52:35.014 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"] []
[2022/06/22 14:52:35.015 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=480ns]
[2022/06/22 14:52:35.015 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=130ns]
[2022/06/22 14:52:35.015 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:52:35.015 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:52:35.015 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da] ["take time"=1.054688ms]
[2022/06/22 14:52:35.015 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da]
[2022/06/22 14:52:35.015 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:52:35.015 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:52:35.015 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:52:35.016 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:52:35.016 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:52:35.016 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:52:35.016 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:52:35.016 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:52:35.016 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:52:35.016 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:52:35.016 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"]
[2022/06/22 14:52:35.016 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"]
[2022/06/22 14:52:35.016 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:52:35.016 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:52:35.016 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:52:35.016 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"]
[2022/06/22 14:52:35.016 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"]
[2022/06/22 14:52:35.016 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:52:35.016 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:52:35.016 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:52:35.016 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:52:35.016 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:52:35.016 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da watch owner key /tidb/stats/owner/2231818a2f0f2045"]
[2022/06/22 14:52:35.016 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"]
[2022/06/22 14:52:35.016 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:52:35.016 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:46804->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:52:35.016 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"]
[2022/06/22 14:52:35.024 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"] [error="context canceled"]
[2022/06/22 14:52:35.224 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:52:37.541 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:52:37.541 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:52:37.554 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:52:37.554 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:52:37.756 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 5b6b32c2-35d4-4d38-ac2b-9d8a2889c0da"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:52:37.756 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:52:37.756 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.742251505s]
[2022/06/22 14:52:37.756 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=60628bc99bc0002]
[2022/06/22 14:52:37.756 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 14:52:37.756 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestPushLimitDownIndexLookUpReader (9.13s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				integration_test.go:195
        	Error:      	Not equal: 
        	            	expected: "[IndexLookUp 1.00 root  limit embedded(offset:2, count:1)]\n[├─Limit(Build) 3.00 cop[tikv]  offset:0, count:3]\n[│ └─Selection 3.00 cop[tikv]  gt(test.tbl.c, 1)]\n[│   └─IndexRangeScan 3.75 cop[tikv] table:tbl, index:idx_b_c(b, c) range:(1,+inf], keep order:false]\n[└─TableRowIDScan(Probe) 1.00 cop[tikv] table:tbl keep order:false]\n"
        	            	actual  : "[IndexLookUp 1.00 root  limit embedded(offset:2, count:1)]\n[├─Limit(Build) 1.33 cop[tikv]  offset:0, count:3]\n[│ └─Selection 1.33 cop[tikv]  gt(test.tbl.c, 1)]\n[│   └─IndexRangeScan 4.00 cop[tikv] table:tbl, index:idx_b_c(b, c) range:(1,+inf], keep order:false]\n[└─TableRowIDScan(Probe) 1.00 cop[tikv] table:tbl keep order:false]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,5 +1,5 @@
        	            	 [IndexLookUp 1.00 root  limit embedded(offset:2, count:1)]
        	            	-[├─Limit(Build) 3.00 cop[tikv]  offset:0, count:3]
        	            	-[│ └─Selection 3.00 cop[tikv]  gt(test.tbl.c, 1)]
        	            	-[│   └─IndexRangeScan 3.75 cop[tikv] table:tbl, index:idx_b_c(b, c) range:(1,+inf], keep order:false]
        	            	+[├─Limit(Build) 1.33 cop[tikv]  offset:0, count:3]
        	            	+[│ └─Selection 1.33 cop[tikv]  gt(test.tbl.c, 1)]
        	            	+[│   └─IndexRangeScan 4.00 cop[tikv] table:tbl, index:idx_b_c(b, c) range:(1,+inf], keep order:false]
        	            	 [└─TableRowIDScan(Probe) 1.00 cop[tikv] table:tbl keep order:false]
        	Test:       	TestPushLimitDownIndexLookUpReader
        	Messages:   	sql:explain format = 'brief' select * from tbl use index(idx_b_c) where b > 1 and c > 1 limit 2,1, args:[]
FAIL
err=exit status 1
[2022/06/22 14:55:53.873 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:55:53.874 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:55:54.874 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:55:58.576 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 14:55:59.577 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:55:59.577 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:55:59.577 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:55:59.577 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:55:59.583 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:55:59.593 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=1941526] ["lease id"=2231818a3230d924]
[2022/06/22 14:55:59.596 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:55:59.605 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=7.104331ms]
[2022/06/22 14:55:59.606 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:55:59.606 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=cc4c9b9b-a2e2-47cb-a207-14614a776271] [runWorker=true]
[2022/06/22 14:55:59.606 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:55:59.606 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:55:59.607 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:55:59.607 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:55:59.608 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"] [ownerID=cc4c9b9b-a2e2-47cb-a207-14614a776271]
[2022/06/22 14:55:59.612 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:55:59.612 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:55:59.614 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"] [ownerID=cc4c9b9b-a2e2-47cb-a207-14614a776271]
[2022/06/22 14:55:59.628 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:55:59.642 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:55:59.646 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:55:59.646 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:55:59.797 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:55:59.798 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:55:59.798 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=60628c91cc40002]
[2022/06/22 14:55:59.800 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"] [ownerID=cc4c9b9b-a2e2-47cb-a207-14614a776271]
[2022/06/22 14:55:59.801 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"] [ownerID=cc4c9b9b-a2e2-47cb-a207-14614a776271]
[2022/06/22 14:55:59.802 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=4.679222ms]
[2022/06/22 14:55:59.825 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=60628c91cc40002]
[2022/06/22 14:55:59.825 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists test;"] [user=]
[2022/06/22 14:55:59.826 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table test(id int, name int)"] [user=]
[2022/06/22 14:55:59.831 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:55:59.793 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:55:59.831 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:55:59.793 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table test(id int, name int)"]
[2022/06/22 14:55:59.832 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:55:59.793 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:55:59.838 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=674.525µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 14:55:59.888 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.426337ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:55:59.793 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:55:59.889 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:55:59.793 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:55:59.892 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:55:59.892 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:55:59.894 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079258337083399] [checkTS=434079258350190593]
[2022/06/22 14:55:59.902 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="drop table if exists ptest;"] [user=]
[2022/06/22 14:55:59.902 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="CREATE TABLE ptest (id int,name int) PARTITION BY RANGE ( id ) (PARTITION `p0` VALUES LESS THAN (2), PARTITION `p1` VALUES LESS THAN (11))"] [user=]
[2022/06/22 14:55:59.909 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:55:59.893 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:55:59.910 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:55:59.893 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="CREATE TABLE ptest (id int,name int) PARTITION BY RANGE ( id ) (PARTITION `p0` VALUES LESS THAN (2), PARTITION `p1` VALUES LESS THAN (11))"]
[2022/06/22 14:55:59.910 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:55:59.893 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:55:59.916 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=796.98µs] [phyTblIDs="[71,72,73]"] [actionTypes="[8,8,8]"]
[2022/06/22 14:55:59.967 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.925577ms] [job="ID:74, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:55:59.893 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:55:59.968 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:55:59.893 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:55:59.971 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=74]
[2022/06/22 14:55:59.971 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:55:59.974 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079258363297799] [checkTS=434079258363297800]
[2022/06/22 14:55:59.977 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"]
[2022/06/22 14:55:59.977 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"]
[2022/06/22 14:55:59.978 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"] []
[2022/06/22 14:55:59.978 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=200ns]
[2022/06/22 14:55:59.978 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=150ns]
[2022/06/22 14:55:59.978 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:55:59.978 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:55:59.978 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=cc4c9b9b-a2e2-47cb-a207-14614a776271] ["take time"=977.863µs]
[2022/06/22 14:55:59.978 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=cc4c9b9b-a2e2-47cb-a207-14614a776271]
[2022/06/22 14:55:59.979 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:55:59.979 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"]
[2022/06/22 14:55:59.979 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"]
[2022/06/22 14:55:59.979 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:55:59.979 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"]
[2022/06/22 14:55:59.979 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"]
[2022/06/22 14:55:59.979 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271 watch owner key /tidb/stats/owner/2231818a3230d946"]
[2022/06/22 14:55:59.979 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"]
[2022/06/22 14:55:59.979 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:55:59.979 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:47496->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:55:59.980 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"]
[2022/06/22 14:55:59.999 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"] [error="context canceled"]
[2022/06/22 14:56:00.200 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:56:02.485 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:56:02.485 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:56:02.490 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:56:02.490 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:56:02.716 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager cc4c9b9b-a2e2-47cb-a207-14614a776271"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:56:02.716 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:56:02.716 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.739071798s]
[2022/06/22 14:56:02.716 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=60628c91cc40002]
[2022/06/22 14:56:02.716 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 14:56:02.716 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestGroupConcatOrderby (8.84s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				physical_plan_test.go:1184
        	Error:      	Not equal: 
        	            	expected: "[HashAgg 1.00 root  funcs:group_concat(Column#6 order by Column#7 desc separator \"++\")->Column#4, funcs:group_concat(Column#8 order by Column#9 desc, Column#10 separator \"--\")->Column#5]\n[└─Projection 10000.00 root  cast(test.ptest.name, var_string(20))->Column#6, test.ptest.name, cast(test.ptest.id, var_string(20))->Column#8, test.ptest.name, test.ptest.id]\n[  └─TableReader 10000.00 root partition:all data:TableFullScan]\n[    └─TableFullScan 10000.00 cop[tikv] table:ptest keep order:false, stats:pseudo]\n"
        	            	actual  : "[HashAgg 1.00 root  funcs:group_concat(Column#6 order by Column#7 desc separator \"++\")->Column#4, funcs:group_concat(Column#8 order by Column#9 desc, Column#10 separator \"--\")->Column#5]\n[└─Projection 20000.00 root  cast(test.ptest.name, var_string(20))->Column#6, test.ptest.name, cast(test.ptest.id, var_string(20))->Column#8, test.ptest.name, test.ptest.id]\n[  └─PartitionUnion 20000.00 root  ]\n[    ├─TableReader 10000.00 root  data:TableFullScan]\n[    │ └─TableFullScan 10000.00 cop[tikv] table:ptest, partition:p0 keep order:false, stats:pseudo]\n[    └─TableReader 10000.00 root  data:TableFullScan]\n[      └─TableFullScan 10000.00 cop[tikv] table:ptest, partition:p1 keep order:false, stats:pseudo]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,5 +1,8 @@
        	            	 [HashAgg 1.00 root  funcs:group_concat(Column#6 order by Column#7 desc separator "++")->Column#4, funcs:group_concat(Column#8 order by Column#9 desc, Column#10 separator "--")->Column#5]
        	            	-[└─Projection 10000.00 root  cast(test.ptest.name, var_string(20))->Column#6, test.ptest.name, cast(test.ptest.id, var_string(20))->Column#8, test.ptest.name, test.ptest.id]
        	            	-[  └─TableReader 10000.00 root partition:all data:TableFullScan]
        	            	-[    └─TableFullScan 10000.00 cop[tikv] table:ptest keep order:false, stats:pseudo]
        	            	+[└─Projection 20000.00 root  cast(test.ptest.name, var_string(20))->Column#6, test.ptest.name, cast(test.ptest.id, var_string(20))->Column#8, test.ptest.name, test.ptest.id]
        	            	+[  └─PartitionUnion 20000.00 root  ]
        	            	+[    ├─TableReader 10000.00 root  data:TableFullScan]
        	            	+[    │ └─TableFullScan 10000.00 cop[tikv] table:ptest, partition:p0 keep order:false, stats:pseudo]
        	            	+[    └─TableReader 10000.00 root  data:TableFullScan]
        	            	+[      └─TableFullScan 10000.00 cop[tikv] table:ptest, partition:p1 keep order:false, stats:pseudo]
        	            	 
        	Test:       	TestGroupConcatOrderby
        	Messages:   	sql:explain format = 'brief' select /*+ agg_to_cop */ group_concat(name ORDER BY name desc SEPARATOR '++'), group_concat(id ORDER BY name desc, id asc SEPARATOR '--') from ptest;, args:[]
FAIL
err=exit status 1
[2022/06/22 14:58:53.415 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 14:58:53.415 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:58:54.415 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 14:58:58.115 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 14:58:59.117 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 14:58:59.117 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 14:58:59.117 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 14:58:59.117 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 14:58:59.122 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 14:58:59.127 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=18957] ["lease id"=2231818a34ee2d24]
[2022/06/22 14:58:59.129 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 14:58:59.145 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=12.705854ms]
[2022/06/22 14:58:59.146 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 14:58:59.146 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=e04ae875-a69f-4027-a2e4-d456069e82a0] [runWorker=true]
[2022/06/22 14:58:59.146 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 14:58:59.146 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 14:58:59.147 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 14:58:59.147 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 14:58:59.149 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"] [ownerID=e04ae875-a69f-4027-a2e4-d456069e82a0]
[2022/06/22 14:58:59.152 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 14:58:59.153 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 14:58:59.154 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"] [ownerID=e04ae875-a69f-4027-a2e4-d456069e82a0]
[2022/06/22 14:58:59.169 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 14:58:59.182 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 14:58:59.184 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 14:58:59.185 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 14:58:59.336 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 14:58:59.336 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 14:58:59.338 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=60628d4120c0002]
[2022/06/22 14:58:59.340 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"] [ownerID=e04ae875-a69f-4027-a2e4-d456069e82a0]
[2022/06/22 14:58:59.340 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"] [ownerID=e04ae875-a69f-4027-a2e4-d456069e82a0]
[2022/06/22 14:58:59.342 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=5.816229ms]
[2022/06/22 14:58:59.371 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=60628d4120c0002]
[2022/06/22 14:58:59.372 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists d1_t"] [user=]
[2022/06/22 14:58:59.372 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table d1_t(d1_k int, value int)"] [user=]
[2022/06/22 14:58:59.379 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:58:59.331 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:58:59.379 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:58:59.331 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table d1_t(d1_k int, value int)"]
[2022/06/22 14:58:59.380 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:58:59.331 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:58:59.386 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=837.404µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 14:58:59.436 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.879952ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 14:58:59.331 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:58:59.437 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 14:58:59.331 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:58:59.441 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 14:58:59.441 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:58:59.443 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079305415000071] [checkTS=434079305415000072]
[2022/06/22 14:58:59.482 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`d1_t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:58:59.455 +08:00] ["end time"=2022/06/22 14:58:59.478 +08:00] [cost=23.148727ms]
[2022/06/22 14:58:59.493 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="drop table if exists d2_t"] [user=]
[2022/06/22 14:58:59.493 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="create table d2_t(d2_k decimal(10,2), value int)"] [user=]
[2022/06/22 14:58:59.499 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:58:59.48 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:58:59.499 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:58:59.48 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table d2_t(d2_k decimal(10,2), value int)"]
[2022/06/22 14:58:59.500 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:58:59.48 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:58:59.507 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=887.013µs] [phyTblIDs="[71]"] [actionTypes="[8]"]
[2022/06/22 14:58:59.557 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.319338ms] [job="ID:72, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 14:58:59.48 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:58:59.558 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 14:58:59.48 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:58:59.561 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=72]
[2022/06/22 14:58:59.561 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:58:59.563 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079305440952327] [checkTS=434079305440952328]
[2022/06/22 14:58:59.597 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`d2_t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:58:59.570 +08:00] ["end time"=2022/06/22 14:58:59.593 +08:00] [cost=22.355652ms]
[2022/06/22 14:58:59.608 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=36] [cur_db=test] [sql="drop table if exists d3_t"] [user=]
[2022/06/22 14:58:59.609 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=36] [cur_db=test] [sql="create table d3_t(d3_k date, value int)"] [user=]
[2022/06/22 14:58:59.614 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 14:58:59.581 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:58:59.614 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 14:58:59.581 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table d3_t(d3_k date, value int)"]
[2022/06/22 14:58:59.615 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:0, start time: 2022-06-22 14:58:59.581 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:58:59.620 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=36] [neededSchemaVersion=37] ["start time"=620.54µs] [phyTblIDs="[73]"] [actionTypes="[8]"]
[2022/06/22 14:58:59.671 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=37] ["take time"=51.619369ms] [job="ID:74, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 14:58:59.581 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:58:59.672 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:73, RowCount:0, ArgLen:0, start time: 2022-06-22 14:58:59.581 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:58:59.675 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=74]
[2022/06/22 14:58:59.675 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:58:59.677 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079305467428872] [checkTS=434079305467428873]
[2022/06/22 14:58:59.707 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`d3_t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:58:59.683 +08:00] ["end time"=2022/06/22 14:58:59.702 +08:00] [cost=18.866822ms]
[2022/06/22 14:58:59.719 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=37] [cur_db=test] [sql="drop table if exists fact_t"] [user=]
[2022/06/22 14:58:59.719 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=37] [cur_db=test] [sql="create table fact_t(d1_k int, d2_k decimal(10,2), d3_k date, col1 int, col2 int, col3 int)"] [user=]
[2022/06/22 14:58:59.724 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:76, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 14:58:59.68 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 14:58:59.724 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:76, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 14:58:59.68 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table fact_t(d1_k int, d2_k decimal(10,2), d3_k date, col1 int, col2 int, col3 int)"]
[2022/06/22 14:58:59.725 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:76, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 14:58:59.68 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:58:59.732 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=37] [neededSchemaVersion=38] ["start time"=1.066447ms] [phyTblIDs="[75]"] [actionTypes="[8]"]
[2022/06/22 14:58:59.782 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=38] ["take time"=51.879741ms] [job="ID:76, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 14:58:59.68 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:58:59.784 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:76, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 14:58:59.68 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 14:58:59.787 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=76]
[2022/06/22 14:58:59.787 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 14:58:59.792 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079305506750471] [checkTS=434079305506750472]
[2022/06/22 14:58:59.853 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`fact_t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 14:58:59.800 +08:00] ["end time"=2022/06/22 14:58:59.850 +08:00] [cost=49.772257ms]
[2022/06/22 14:58:59.872 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"]
[2022/06/22 14:58:59.872 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"]
[2022/06/22 14:58:59.872 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"] []
[2022/06/22 14:58:59.873 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=150ns]
[2022/06/22 14:58:59.873 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=140ns]
[2022/06/22 14:58:59.873 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 14:58:59.873 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 14:58:59.873 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=e04ae875-a69f-4027-a2e4-d456069e82a0] ["take time"=1.014369ms]
[2022/06/22 14:58:59.873 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=e04ae875-a69f-4027-a2e4-d456069e82a0]
[2022/06/22 14:58:59.874 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 14:58:59.874 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"]
[2022/06/22 14:58:59.874 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"]
[2022/06/22 14:58:59.874 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 14:58:59.874 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"]
[2022/06/22 14:58:59.874 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"]
[2022/06/22 14:58:59.874 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0 watch owner key /tidb/stats/owner/2231818a34ee2d48"]
[2022/06/22 14:58:59.874 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"]
[2022/06/22 14:58:59.874 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 14:58:59.874 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:48066->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 14:58:59.874 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"]
[2022/06/22 14:58:59.898 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"] [error="context canceled"]
[2022/06/22 14:59:00.099 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 14:59:02.374 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:59:02.374 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 14:59:02.414 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:59:02.414 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 14:59:02.646 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager e04ae875-a69f-4027-a2e4-d456069e82a0"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 14:59:02.646 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 14:59:02.646 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.774283153s]
[2022/06/22 14:59:02.646 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=60628d4120c0002]
[2022/06/22 14:59:02.646 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 14:59:02.646 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestMPPJoin (9.23s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				integration_test.go:612
        	Error:      	Not equal: 
        	            	expected: "[StreamAgg 1.00 root  funcs:count(1)->Column#11]\n[└─TableReader 8.00 root  data:ExchangeSender]\n[  └─ExchangeSender 8.00 mpp[tiflash]  ExchangeType: PassThrough]\n[    └─HashJoin 8.00 mpp[tiflash]  inner join, equal:[eq(test.d1_t.d1_k, test.fact_t.d1_k)]]\n[      ├─ExchangeReceiver(Build) 2.00 mpp[tiflash]  ]\n[      │ └─ExchangeSender 2.00 mpp[tiflash]  ExchangeType: Broadcast]\n[      │   └─Selection 2.00 mpp[tiflash]  not(isnull(test.d1_t.d1_k))]\n[      │     └─TableFullScan 2.00 mpp[tiflash] table:d1_t keep order:false]\n[      └─Selection(Probe) 8.00 mpp[tiflash]  not(isnull(test.fact_t.d1_k))]\n[        └─TableFullScan 8.00 mpp[tiflash] table:fact_t keep order:false]\n"
        	            	actual  : "[StreamAgg 1.00 root  funcs:count(1)->Column#11]\n[└─TableReader 7.99 root  data:ExchangeSender]\n[  └─ExchangeSender 7.99 mpp[tiflash]  ExchangeType: PassThrough]\n[    └─HashJoin 7.99 mpp[tiflash]  inner join, equal:[eq(test.d1_t.d1_k, test.fact_t.d1_k)]]\n[      ├─ExchangeReceiver(Build) 2.00 mpp[tiflash]  ]\n[      │ └─ExchangeSender 2.00 mpp[tiflash]  ExchangeType: Broadcast]\n[      │   └─Selection 2.00 mpp[tiflash]  not(isnull(test.d1_t.d1_k))]\n[      │     └─TableFullScan 2.00 mpp[tiflash] table:d1_t keep order:false]\n[      └─Selection(Probe) 7.99 mpp[tiflash]  not(isnull(test.fact_t.d1_k))]\n[        └─TableFullScan 8.00 mpp[tiflash] table:fact_t keep order:false]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,5 +1,5 @@
        	            	 [StreamAgg 1.00 root  funcs:count(1)->Column#11]
        	            	-[└─TableReader 8.00 root  data:ExchangeSender]
        	            	-[  └─ExchangeSender 8.00 mpp[tiflash]  ExchangeType: PassThrough]
        	            	-[    └─HashJoin 8.00 mpp[tiflash]  inner join, equal:[eq(test.d1_t.d1_k, test.fact_t.d1_k)]]
        	            	+[└─TableReader 7.99 root  data:ExchangeSender]
        	            	+[  └─ExchangeSender 7.99 mpp[tiflash]  ExchangeType: PassThrough]
        	            	+[    └─HashJoin 7.99 mpp[tiflash]  inner join, equal:[eq(test.d1_t.d1_k, test.fact_t.d1_k)]]
        	            	 [      ├─ExchangeReceiver(Build) 2.00 mpp[tiflash]  ]
        	            	@@ -8,3 +8,3 @@
        	            	 [      │     └─TableFullScan 2.00 mpp[tiflash] table:d1_t keep order:false]
        	            	-[      └─Selection(Probe) 8.00 mpp[tiflash]  not(isnull(test.fact_t.d1_k))]
        	            	+[      └─Selection(Probe) 7.99 mpp[tiflash]  not(isnull(test.fact_t.d1_k))]
        	            	 [        └─TableFullScan 8.00 mpp[tiflash] table:fact_t keep order:false]
        	Test:       	TestMPPJoin
        	Messages:   	sql:explain format = 'brief' select count(*) from fact_t, d1_t where fact_t.d1_k = d1_t.d1_k, args:[]
FAIL
err=exit status 1
[2022/06/22 15:00:40.057 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 15:00:40.058 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:00:41.058 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:00:43.260 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 15:00:44.261 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 15:00:44.261 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 15:00:44.261 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 15:00:44.261 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 15:00:44.266 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 15:00:44.274 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=3975170] ["lease id"=2231818a368ec224]
[2022/06/22 15:00:44.276 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 15:00:44.286 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=7.091911ms]
[2022/06/22 15:00:44.286 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 15:00:44.286 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=358c993d-892a-4fef-aa6f-150a6ce45675] [runWorker=true]
[2022/06/22 15:00:44.286 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 15:00:44.287 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 15:00:44.287 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 15:00:44.287 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 15:00:44.290 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"] [ownerID=358c993d-892a-4fef-aa6f-150a6ce45675]
[2022/06/22 15:00:44.296 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 15:00:44.297 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 15:00:44.298 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"] [ownerID=358c993d-892a-4fef-aa6f-150a6ce45675]
[2022/06/22 15:00:44.314 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 15:00:44.327 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 15:00:44.330 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 15:00:44.330 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 15:00:44.488 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 15:00:44.488 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 15:00:44.490 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=60628da7cf00002]
[2022/06/22 15:00:44.491 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"] [ownerID=358c993d-892a-4fef-aa6f-150a6ce45675]
[2022/06/22 15:00:44.491 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"] [ownerID=358c993d-892a-4fef-aa6f-150a6ce45675]
[2022/06/22 15:00:44.492 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=4.770906ms]
[2022/06/22 15:00:44.517 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=60628da7cf00002]
[2022/06/22 15:00:44.517 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t1, t2"] [user=]
[2022/06/22 15:00:44.518 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t1(a int not null, b int not null, key(a,b))"] [user=]
[2022/06/22 15:00:44.524 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:00:44.476 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:00:44.524 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:00:44.476 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t1(a int not null, b int not null, key(a,b))"]
[2022/06/22 15:00:44.525 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:00:44.476 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:00:44.531 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=787.218µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 15:00:44.581 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.531176ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:00:44.476 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:00:44.582 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:00:44.476 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:00:44.585 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 15:00:44.585 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:00:44.589 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079332978130951] [checkTS=434079332978130952]
[2022/06/22 15:00:44.593 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="create table t2(a int not null, b int not null, key(a,b))"] [user=]
[2022/06/22 15:00:44.599 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:00:44.576 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:00:44.599 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:00:44.576 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t2(a int not null, b int not null, key(a,b))"]
[2022/06/22 15:00:44.600 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 15:00:44.576 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:00:44.605 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=476.097µs] [phyTblIDs="[71]"] [actionTypes="[8]"]
[2022/06/22 15:00:44.655 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.008941ms] [job="ID:72, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:00:44.576 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:00:44.656 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 15:00:44.576 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:00:44.659 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=72]
[2022/06/22 15:00:44.659 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:00:44.661 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079332991238151] [checkTS=434079332991238152]
[2022/06/22 15:00:44.702 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t1` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 15:00:44.670 +08:00] ["end time"=2022/06/22 15:00:44.698 +08:00] [cost=27.158964ms]
[2022/06/22 15:00:44.757 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t2` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 15:00:44.725 +08:00] ["end time"=2022/06/22 15:00:44.753 +08:00] [cost=28.190595ms]
[2022/06/22 15:00:44.771 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"]
[2022/06/22 15:00:44.771 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"]
[2022/06/22 15:00:44.771 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"] []
[2022/06/22 15:00:44.772 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=260ns]
[2022/06/22 15:00:44.772 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=130ns]
[2022/06/22 15:00:44.772 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 15:00:44.772 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 15:00:44.772 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=358c993d-892a-4fef-aa6f-150a6ce45675] ["take time"=1.082099ms]
[2022/06/22 15:00:44.772 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=358c993d-892a-4fef-aa6f-150a6ce45675]
[2022/06/22 15:00:44.773 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 15:00:44.773 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"]
[2022/06/22 15:00:44.773 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"]
[2022/06/22 15:00:44.773 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 15:00:44.773 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"]
[2022/06/22 15:00:44.773 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"]
[2022/06/22 15:00:44.773 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675 watch owner key /tidb/stats/owner/2231818a368ec248"]
[2022/06/22 15:00:44.773 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"]
[2022/06/22 15:00:44.773 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 15:00:44.773 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:48390->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 15:00:44.773 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"]
[2022/06/22 15:00:44.786 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"] [error="context canceled"]
[2022/06/22 15:00:44.988 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 15:00:47.277 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:00:47.277 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 15:00:47.324 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:00:47.324 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 15:00:47.507 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 358c993d-892a-4fef-aa6f-150a6ce45675"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:00:47.507 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 15:00:47.507 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.736331316s]
[2022/06/22 15:00:47.507 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=60628da7cf00002]
--- FAIL: TestGroupNDVs (7.45s)
    stats_test.go:118: 
        	Error Trace:	stats_test.go:118
        	Error:      	Not equal: 
        	            	expected: "[{[1 2] 4}]"
        	            	actual  : "[{[1 2] 1.3333333333333335}]"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1 +1 @@
        	            	-[{[1 2] 4}]
        	            	+[{[1 2] 1.3333333333333335}]
        	Test:       	TestGroupNDVs
        	Messages:   	case:3 sql: select count(1) from t1 where b > 0 group by a, b
FAIL
err=exit status 1
[2022/06/22 15:01:30.652 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 15:01:30.653 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:01:31.653 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:01:34.348 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 15:01:35.349 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 15:01:35.349 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 15:01:35.349 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 15:01:35.349 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 15:01:35.354 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 15:01:35.362 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=3640187] ["lease id"=2231818a37545c24]
[2022/06/22 15:01:35.364 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 15:01:35.381 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=13.811998ms]
[2022/06/22 15:01:35.381 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 15:01:35.381 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=bd988e39-2382-4c21-86c0-45c1f2ff0178] [runWorker=true]
[2022/06/22 15:01:35.381 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 15:01:35.382 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 15:01:35.382 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 15:01:35.382 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 15:01:35.384 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"] [ownerID=bd988e39-2382-4c21-86c0-45c1f2ff0178]
[2022/06/22 15:01:35.388 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 15:01:35.389 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 15:01:35.390 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"] [ownerID=bd988e39-2382-4c21-86c0-45c1f2ff0178]
[2022/06/22 15:01:35.406 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 15:01:35.419 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 15:01:35.421 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 15:01:35.422 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 15:01:35.582 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 15:01:35.583 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 15:01:35.584 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=60628dd9b300002]
[2022/06/22 15:01:35.586 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"] [ownerID=bd988e39-2382-4c21-86c0-45c1f2ff0178]
[2022/06/22 15:01:35.586 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"] [ownerID=bd988e39-2382-4c21-86c0-45c1f2ff0178]
[2022/06/22 15:01:35.587 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=4.760191ms]
[2022/06/22 15:01:35.611 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=60628dd9b300002]
[2022/06/22 15:01:35.612 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t"] [user=]
[2022/06/22 15:01:35.612 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t(id int, c1 int, c2 int, primary key (id), key i(c1))"] [user=]
[2022/06/22 15:01:35.618 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:01:35.613 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:01:35.618 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:01:35.613 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t(id int, c1 int, c2 int, primary key (id), key i(c1))"]
[2022/06/22 15:01:35.620 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:01:35.613 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:01:35.626 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=1.061781ms] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 15:01:35.675 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.462822ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:01:35.613 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:01:35.676 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:01:35.613 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:01:35.679 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 15:01:35.680 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:01:38.393 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 15:01:36.941 +08:00] ["end time"=2022/06/22 15:01:38.383 +08:00] [cost=1.442494114s]
[2022/06/22 15:01:38.423 +08:00] [WARN] [adapter.go:1095] ["# Txn_start_ts: 434079346698223645\n# Conn_ID: 1\n# Query_time: 1.49127411\n# Parse_time: 0.000018939\n# Compile_time: 0.000795969\n# Rewrite_time: 0.00074659\n# Optimize_time: 0\n# Wait_TS: 0.00000761\n# DB: test\n# Is_internal: false\n# Digest: d8a7882bcbe7ed5b735d585c8fc402824f4ac87a0772b64a1cdf2e93e0dbab7f\n# Num_cop_tasks: 0\n# Mem_max: 887152\n# Prepared: false\n# Plan_from_cache: false\n# Plan_from_binding: false\n# Has_more_results: false\n# KV_total: 0\n# PD_total: 0\n# Backoff_total: 0\n# Write_sql_response_total: 0\n# Result_rows: 0\n# Succ: true\n# IsExplicitTxn: false\nuse test;\nanalyze table t;"]
[2022/06/22 15:01:38.424 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="drop table t"] [user=]
[2022/06/22 15:01:38.427 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:71, Type:drop table, State:queueing, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:01:38.414 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:01:38.427 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:71, Type:drop table, State:queueing, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:01:38.414 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="drop table t"]
[2022/06/22 15:01:38.428 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:71, Type:drop table, State:queueing, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:01:38.414 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:01:38.432 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=212.004µs] [phyTblIDs="[69]"] [actionTypes="[16]"]
[2022/06/22 15:01:38.483 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.59441ms] [job="ID:71, Type:drop table, State:running, SchemaState:write only, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:01:38.414 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:01:38.483 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:71, Type:drop table, State:running, SchemaState:write only, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:01:38.414 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:01:38.487 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=36] [neededSchemaVersion=37] ["start time"=155.376µs] [phyTblIDs="[]"] [actionTypes="[]"]
[2022/06/22 15:01:38.538 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=37] ["take time"=51.514343ms] [job="ID:71, Type:drop table, State:running, SchemaState:delete only, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:01:38.414 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:01:38.539 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:71, Type:drop table, State:running, SchemaState:delete only, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:01:38.414 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:01:38.543 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=37] [neededSchemaVersion=38] ["start time"=187.935µs] [phyTblIDs="[]"] [actionTypes="[]"]
[2022/06/22 15:01:38.594 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=38] ["take time"=51.436705ms] [job="ID:71, Type:drop table, State:done, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:3, start time: 2022-06-22 15:01:38.414 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:01:38.595 +08:00] [INFO] [delete_range.go:448] ["[ddl] insert into delete-range table"] [jobID=71] [elementID=1] [comment="table ID is 69"]
[2022/06/22 15:01:38.600 +08:00] [INFO] [delete_range.go:105] ["[ddl] add job into delete-range table"] [jobID=71] [jobType="drop table"]
[2022/06/22 15:01:38.600 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:71, Type:drop table, State:synced, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:3, start time: 2022-06-22 15:01:38.414 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:01:38.604 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=71]
[2022/06/22 15:01:38.604 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:01:38.605 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"]
[2022/06/22 15:01:38.605 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"]
[2022/06/22 15:01:38.605 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 15:01:38.605 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"] []
[2022/06/22 15:01:38.605 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=220ns]
[2022/06/22 15:01:38.605 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=140ns]
[2022/06/22 15:01:38.605 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 15:01:38.605 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 15:01:38.605 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=bd988e39-2382-4c21-86c0-45c1f2ff0178] ["take time"=875.307µs]
[2022/06/22 15:01:38.605 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=bd988e39-2382-4c21-86c0-45c1f2ff0178]
[2022/06/22 15:01:38.606 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 15:01:38.606 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 15:01:38.606 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 15:01:38.606 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 15:01:38.606 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"]
[2022/06/22 15:01:38.606 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"]
[2022/06/22 15:01:38.606 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 15:01:38.606 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:01:38.607 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:01:38.607 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:01:38.607 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:01:38.607 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:01:38.607 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 15:01:38.607 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 15:01:38.607 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 15:01:38.607 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 15:01:38.607 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 15:01:38.607 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 15:01:38.607 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 15:01:38.607 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 15:01:38.607 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"]
[2022/06/22 15:01:38.607 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"]
[2022/06/22 15:01:38.607 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178 watch owner key /tidb/stats/owner/2231818a37545c48"]
[2022/06/22 15:01:38.607 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"]
[2022/06/22 15:01:38.607 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 15:01:38.607 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:48550->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 15:01:38.607 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"]
[2022/06/22 15:01:38.614 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"] [error="context canceled"]
[2022/06/22 15:01:38.814 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 15:01:41.140 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:01:41.140 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 15:01:41.148 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:01:41.148 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 15:01:41.340 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager bd988e39-2382-4c21-86c0-45c1f2ff0178"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:01:41.340 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 15:01:41.340 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.735248795s]
[2022/06/22 15:01:41.340 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=60628dd9b300002]
[2022/06/22 15:01:41.340 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 15:01:41.340 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestCopPaging (10.69s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				plan_test.go:679
        	Error:      	Not equal: 
        	            	expected: "[Limit 4.00 root  offset:0, count:960]\n[└─IndexLookUp 4.00 root  ]\n[  ├─Selection(Build) 1024.00 cop[tikv]  le(test.t.id, 1024)]\n[  │ └─IndexRangeScan 1024.00 cop[tikv] table:t, index:i(c1) range:[0,1024], keep order:true]\n[  └─Selection(Probe) 4.00 cop[tikv]  in(test.t.c2, 2, 4, 6, 8)]\n[    └─TableRowIDScan 1024.00 cop[tikv] table:t keep order:false]\n"
        	            	actual  : "[Limit 4.10 root  offset:0, count:960]\n[└─IndexLookUp 4.10 root  ]\n[  ├─Selection(Build) 1024.00 cop[tikv]  le(test.t.id, 1024)]\n[  │ └─IndexRangeScan 1024.00 cop[tikv] table:t, index:i(c1) range:[0,1024], keep order:true]\n[  └─Selection(Probe) 4.10 cop[tikv]  in(test.t.c2, 2, 4, 6, 8)]\n[    └─TableRowIDScan 1024.00 cop[tikv] table:t keep order:false]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,6 +1,6 @@
        	            	-[Limit 4.00 root  offset:0, count:960]
        	            	-[└─IndexLookUp 4.00 root  ]
        	            	+[Limit 4.10 root  offset:0, count:960]
        	            	+[└─IndexLookUp 4.10 root  ]
        	            	 [  ├─Selection(Build) 1024.00 cop[tikv]  le(test.t.id, 1024)]
        	            	 [  │ └─IndexRangeScan 1024.00 cop[tikv] table:t, index:i(c1) range:[0,1024], keep order:true]
        	            	-[  └─Selection(Probe) 4.00 cop[tikv]  in(test.t.c2, 2, 4, 6, 8)]
        	            	+[  └─Selection(Probe) 4.10 cop[tikv]  in(test.t.c2, 2, 4, 6, 8)]
        	            	 [    └─TableRowIDScan 1024.00 cop[tikv] table:t keep order:false]
        	Test:       	TestCopPaging
        	Messages:   	sql:explain format='brief' select * from t force index(i) where id <= 1024 and c1 >= 0 and c1 <= 1024 and c2 in (2, 4, 6, 8) order by c1 limit 960, args:[]
FAIL
err=exit status 1
[2022/06/22 15:09:49.558 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 15:09:49.559 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:09:50.559 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:09:53.769 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 15:09:54.770 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 15:09:54.770 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 15:09:54.770 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 15:09:54.770 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 15:09:54.774 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 15:09:54.779 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=266189] ["lease id"=2231818a3ef14624]
[2022/06/22 15:09:54.785 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 15:09:54.796 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=6.859776ms]
[2022/06/22 15:09:54.797 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 15:09:54.797 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=e2803ed7-a608-46b6-a099-55ba47f0e5ec] [runWorker=true]
[2022/06/22 15:09:54.797 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 15:09:54.813 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 15:09:54.813 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 15:09:54.813 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 15:09:54.819 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 15:09:54.821 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 15:09:54.823 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"] [ownerID=e2803ed7-a608-46b6-a099-55ba47f0e5ec]
[2022/06/22 15:09:54.824 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"] [ownerID=e2803ed7-a608-46b6-a099-55ba47f0e5ec]
[2022/06/22 15:09:54.844 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 15:09:54.859 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 15:09:54.861 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 15:09:54.862 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 15:09:55.257 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 15:09:55.257 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 15:09:55.258 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=60628fc1a9c0002]
[2022/06/22 15:09:55.261 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"] [ownerID=e2803ed7-a608-46b6-a099-55ba47f0e5ec]
[2022/06/22 15:09:55.261 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"] [ownerID=e2803ed7-a608-46b6-a099-55ba47f0e5ec]
[2022/06/22 15:09:55.264 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=7.478204ms]
[2022/06/22 15:09:55.289 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=60628fc1a9c0002]
[2022/06/22 15:09:55.289 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=] [sql="create database list_col_partition_types"] [user=]
[2022/06/22 15:09:55.295 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create schema, State:queueing, SchemaState:none, SchemaID:69, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 15:09:55.288 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:09:55.295 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create schema, State:queueing, SchemaState:none, SchemaID:69, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 15:09:55.288 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create database list_col_partition_types"]
[2022/06/22 15:09:55.296 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create schema, State:queueing, SchemaState:none, SchemaID:69, TableID:0, RowCount:0, ArgLen:0, start time: 2022-06-22 15:09:55.288 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:09:55.300 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=347.443µs] [phyTblIDs="[]"] [actionTypes="[]"]
[2022/06/22 15:09:55.350 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.458872ms] [job="ID:70, Type:create schema, State:done, SchemaState:public, SchemaID:69, TableID:0, RowCount:0, ArgLen:1, start time: 2022-06-22 15:09:55.288 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:09:55.351 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create schema, State:synced, SchemaState:public, SchemaID:69, TableID:0, RowCount:0, ArgLen:0, start time: 2022-06-22 15:09:55.288 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:09:55.354 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 15:09:55.354 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:09:55.354 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=list_col_partition_types] [sql="drop table if exists tlist"] [user=]
[2022/06/22 15:09:55.355 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=list_col_partition_types] [sql="create table tint (a int) partition by list columns(a) (partition p0 values in (0, 1), partition p1 values in (2, 3))"] [user=]
[2022/06/22 15:09:55.361 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:09:55.338 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:09:55.361 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:09:55.338 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table tint (a int) partition by list columns(a) (partition p0 values in (0, 1), partition p1 values in (2, 3))"]
[2022/06/22 15:09:55.362 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 15:09:55.338 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:09:55.368 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=869.743µs] [phyTblIDs="[71,72,73]"] [actionTypes="[8,8,8]"]
[2022/06/22 15:09:55.418 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.846754ms] [job="ID:74, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:09:55.338 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:09:55.419 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 15:09:55.338 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:09:55.422 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=74]
[2022/06/22 15:09:55.422 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:09:55.422 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=36] [cur_db=list_col_partition_types] [sql="create table tdate (a date) partition by list columns(a) (partition p0 values in ('2000-01-01', '2000-01-02'), partition p1 values in ('2000-01-03', '2000-01-04'))"] [user=]
[2022/06/22 15:09:55.429 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 15:09:55.389 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:09:55.429 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 15:09:55.389 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table tdate (a date) partition by list columns(a) (partition p0 values in ('2000-01-01', '2000-01-02'), partition p1 values in ('2000-01-03', '2000-01-04'))"]
[2022/06/22 15:09:55.430 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 15:09:55.389 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:09:55.436 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=36] [neededSchemaVersion=37] ["start time"=783.655µs] [phyTblIDs="[75,76,77]"] [actionTypes="[8,8,8]"]
[2022/06/22 15:09:55.485 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=37] ["take time"=50.858404ms] [job="ID:78, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 15:09:55.389 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:09:55.487 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:78, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 15:09:55.389 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:09:55.490 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=78]
[2022/06/22 15:09:55.490 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:09:55.491 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=37] [cur_db=list_col_partition_types] [sql="create table tstring (a varchar(32)) partition by list columns(a) (partition p0 values in ('a', 'b'), partition p1 values in ('c', 'd'))"] [user=]
[2022/06/22 15:09:55.500 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:82, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:79, RowCount:0, ArgLen:1, start time: 2022-06-22 15:09:55.488 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:09:55.500 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:82, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:79, RowCount:0, ArgLen:1, start time: 2022-06-22 15:09:55.488 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table tstring (a varchar(32)) partition by list columns(a) (partition p0 values in ('a', 'b'), partition p1 values in ('c', 'd'))"]
[2022/06/22 15:09:55.501 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:82, Type:create table, State:queueing, SchemaState:none, SchemaID:69, TableID:79, RowCount:0, ArgLen:0, start time: 2022-06-22 15:09:55.488 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:09:55.508 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=37] [neededSchemaVersion=38] ["start time"=1.03638ms] [phyTblIDs="[79,80,81]"] [actionTypes="[8,8,8]"]
[2022/06/22 15:09:55.558 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=38] ["take time"=51.893404ms] [job="ID:82, Type:create table, State:done, SchemaState:public, SchemaID:69, TableID:79, RowCount:0, ArgLen:1, start time: 2022-06-22 15:09:55.488 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:09:55.559 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:82, Type:create table, State:synced, SchemaState:public, SchemaID:69, TableID:79, RowCount:0, ArgLen:0, start time: 2022-06-22 15:09:55.488 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:09:55.562 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=82]
[2022/06/22 15:09:55.562 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:09:55.563 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=38] [cur_db=list_col_partition_types] [sql="create table tdouble (a double) partition by list columns(a) (partition p0 values in (0, 1), partition p1 values in (2, 3))"] [user=]
[2022/06/22 15:09:55.563 +08:00] [INFO] [tidb.go:268] ["rollbackTxn called due to ddl/autocommit failure"]
[2022/06/22 15:09:55.563 +08:00] [WARN] [session.go:1947] ["run statement failed"] [schemaVersion=38] [error="[ddl:1659]Field 'a' is of a not allowed type for this type of partitioning"] [errorVerbose="[ddl:1659]Field 'a' is of a not allowed type for this type of partitioning\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.(*Error).GenWithStackByArgs\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/normalize.go:164\ngithub.com/pingcap/tidb/ddl.checkColumnsPartitionType\n\t/home/genius/project/src/github.com/pingcap/tidb/ddl/ddl_api.go:2676\ngithub.com/pingcap/tidb/ddl.buildTablePartitionInfo\n\t/home/genius/project/src/github.com/pingcap/tidb/ddl/partition.go:470\ngithub.com/pingcap/tidb/ddl.buildTableInfoWithStmt\n\t/home/genius/project/src/github.com/pingcap/tidb/ddl/ddl_api.go:2155\ngithub.com/pingcap/tidb/ddl.(*ddl).CreateTable\n\t/home/genius/project/src/github.com/pingcap/tidb/ddl/ddl_api.go:2209\ngithub.com/pingcap/tidb/executor.(*DDLExec).executeCreateTable\n\t/home/genius/project/src/github.com/pingcap/tidb/executor/ddl.go:324\ngithub.com/pingcap/tidb/executor.(*DDLExec).Next\n\t/home/genius/project/src/github.com/pingcap/tidb/executor/ddl.go:149\ngithub.com/pingcap/tidb/executor.Next\n\t/home/genius/project/src/github.com/pingcap/tidb/executor/executor.go:319\ngithub.com/pingcap/tidb/executor.(*ExecStmt).handleNoDelayExecutor\n\t/home/genius/project/src/github.com/pingcap/tidb/executor/adapter.go:666\ngithub.com/pingcap/tidb/executor.(*ExecStmt).handleNoDelay\n\t/home/genius/project/src/github.com/pingcap/tidb/executor/adapter.go:516\ngithub.com/pingcap/tidb/executor.(*ExecStmt).Exec\n\t/home/genius/project/src/github.com/pingcap/tidb/executor/adapter.go:465\ngithub.com/pingcap/tidb/session.runStmt\n\t/home/genius/project/src/github.com/pingcap/tidb/session/session.go:2075\ngithub.com/pingcap/tidb/session.(*session).ExecuteStmt\n\t/home/genius/project/src/github.com/pingcap/tidb/session/session.go:1944\ngithub.com/pingcap/tidb/testkit.(*TestKit).Exec\n\t/home/genius/project/src/github.com/pingcap/tidb/testkit/testkit.go:218\ngithub.com/pingcap/tidb/testkit.(*TestKit).ExecToErr\n\t/home/genius/project/src/github.com/pingcap/tidb/testkit/testkit.go:255\ngithub.com/pingcap/tidb/planner/core_test.TestListColVariousTypes\n\t/home/genius/project/src/github.com/pingcap/tidb/planner/core/integration_partition_test.go:78\ntesting.tRunner\n\t/home/genius/project/go/src/testing/testing.go:1439\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"] [session="{\n  \"currDBName\": \"list_col_partition_types\",\n  \"id\": 1,\n  \"status\": 2,\n  \"strictMode\": true,\n  \"user\": null\n}"]
[2022/06/22 15:09:55.563 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=38] [cur_db=list_col_partition_types] [sql="create table tdecimal (a decimal(30, 10)) partition by list columns(a) (partition p0 values in (0, 1), partition p1 values in (2, 3))"] [user=]
[2022/06/22 15:09:55.563 +08:00] [INFO] [tidb.go:268] ["rollbackTxn called due to ddl/autocommit failure"]
[2022/06/22 15:09:55.563 +08:00] [WARN] [session.go:1947] ["run statement failed"] [schemaVersion=38] [error="[ddl:1659]Field 'a' is of a not allowed type for this type of partitioning"] [errorVerbose="[ddl:1659]Field 'a' is of a not allowed type for this type of partitioning\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.(*Error).GenWithStackByArgs\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/normalize.go:164\ngithub.com/pingcap/tidb/ddl.checkColumnsPartitionType\n\t/home/genius/project/src/github.com/pingcap/tidb/ddl/ddl_api.go:2676\ngithub.com/pingcap/tidb/ddl.buildTablePartitionInfo\n\t/home/genius/project/src/github.com/pingcap/tidb/ddl/partition.go:470\ngithub.com/pingcap/tidb/ddl.buildTableInfoWithStmt\n\t/home/genius/project/src/github.com/pingcap/tidb/ddl/ddl_api.go:2155\ngithub.com/pingcap/tidb/ddl.(*ddl).CreateTable\n\t/home/genius/project/src/github.com/pingcap/tidb/ddl/ddl_api.go:2209\ngithub.com/pingcap/tidb/executor.(*DDLExec).executeCreateTable\n\t/home/genius/project/src/github.com/pingcap/tidb/executor/ddl.go:324\ngithub.com/pingcap/tidb/executor.(*DDLExec).Next\n\t/home/genius/project/src/github.com/pingcap/tidb/executor/ddl.go:149\ngithub.com/pingcap/tidb/executor.Next\n\t/home/genius/project/src/github.com/pingcap/tidb/executor/executor.go:319\ngithub.com/pingcap/tidb/executor.(*ExecStmt).handleNoDelayExecutor\n\t/home/genius/project/src/github.com/pingcap/tidb/executor/adapter.go:666\ngithub.com/pingcap/tidb/executor.(*ExecStmt).handleNoDelay\n\t/home/genius/project/src/github.com/pingcap/tidb/executor/adapter.go:516\ngithub.com/pingcap/tidb/executor.(*ExecStmt).Exec\n\t/home/genius/project/src/github.com/pingcap/tidb/executor/adapter.go:465\ngithub.com/pingcap/tidb/session.runStmt\n\t/home/genius/project/src/github.com/pingcap/tidb/session/session.go:2075\ngithub.com/pingcap/tidb/session.(*session).ExecuteStmt\n\t/home/genius/project/src/github.com/pingcap/tidb/session/session.go:1944\ngithub.com/pingcap/tidb/testkit.(*TestKit).Exec\n\t/home/genius/project/src/github.com/pingcap/tidb/testkit/testkit.go:218\ngithub.com/pingcap/tidb/testkit.(*TestKit).ExecToErr\n\t/home/genius/project/src/github.com/pingcap/tidb/testkit/testkit.go:255\ngithub.com/pingcap/tidb/planner/core_test.TestListColVariousTypes\n\t/home/genius/project/src/github.com/pingcap/tidb/planner/core/integration_partition_test.go:82\ntesting.tRunner\n\t/home/genius/project/go/src/testing/testing.go:1439\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"] [session="{\n  \"currDBName\": \"list_col_partition_types\",\n  \"id\": 1,\n  \"status\": 2,\n  \"strictMode\": true,\n  \"user\": null\n}"]
[2022/06/22 15:09:55.565 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079477409775627] [checkTS=434079477409775628]
[2022/06/22 15:09:55.569 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079477409775630] [checkTS=434079477409775631]
[2022/06/22 15:09:55.573 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079477409775633] [checkTS=434079477409775634]
[2022/06/22 15:09:55.575 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"]
[2022/06/22 15:09:55.575 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"]
[2022/06/22 15:09:55.576 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"] []
[2022/06/22 15:09:55.576 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=530ns]
[2022/06/22 15:09:55.576 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=160ns]
[2022/06/22 15:09:55.576 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 15:09:55.576 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 15:09:55.576 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=e2803ed7-a608-46b6-a099-55ba47f0e5ec] ["take time"=1.109818ms]
[2022/06/22 15:09:55.576 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=e2803ed7-a608-46b6-a099-55ba47f0e5ec]
[2022/06/22 15:09:55.577 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 15:09:55.577 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 15:09:55.577 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 15:09:55.577 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:09:55.577 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:09:55.577 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:09:55.577 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:09:55.577 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:09:55.577 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 15:09:55.577 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 15:09:55.577 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"]
[2022/06/22 15:09:55.577 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"]
[2022/06/22 15:09:55.577 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 15:09:55.577 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 15:09:55.577 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 15:09:55.577 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"]
[2022/06/22 15:09:55.577 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"]
[2022/06/22 15:09:55.577 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 15:09:55.577 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 15:09:55.577 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 15:09:55.577 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 15:09:55.577 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 15:09:55.577 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec watch owner key /tidb/stats/owner/2231818a3ef14648"]
[2022/06/22 15:09:55.577 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"]
[2022/06/22 15:09:55.578 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 15:09:55.578 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:50034->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 15:09:55.578 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"]
[2022/06/22 15:09:55.617 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"] [error="context canceled"]
[2022/06/22 15:09:55.817 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 15:09:58.077 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:09:58.077 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 15:09:58.100 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:09:58.100 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 15:09:58.318 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager e2803ed7-a608-46b6-a099-55ba47f0e5ec"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:09:58.318 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 15:09:58.318 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.742846805s]
[2022/06/22 15:09:58.318 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=60628fc1a9c0002]
[2022/06/22 15:09:58.318 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 15:09:58.318 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestListColVariousTypes (8.76s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				integration_partition_test.go:102
        	Error:      	Not equal: 
        	            	expected: "[TableReader 3323.33 root partition:p0 data:Selection]\n[└─Selection 3323.33 cop[tikv]  le(list_col_partition_types.tint.a, 1)]\n[  └─TableFullScan 10000.00 cop[tikv] table:tint keep order:false, stats:pseudo]\n"
        	            	actual  : "[TableReader 3323.33 root  data:Selection]\n[└─Selection 3323.33 cop[tikv]  le(list_col_partition_types.tint.a, 1)]\n[  └─TableFullScan 10000.00 cop[tikv] table:tint, partition:p0 keep order:false, stats:pseudo]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,4 +1,4 @@
        	            	-[TableReader 3323.33 root partition:p0 data:Selection]
        	            	+[TableReader 3323.33 root  data:Selection]
        	            	 [└─Selection 3323.33 cop[tikv]  le(list_col_partition_types.tint.a, 1)]
        	            	-[  └─TableFullScan 10000.00 cop[tikv] table:tint keep order:false, stats:pseudo]
        	            	+[  └─TableFullScan 10000.00 cop[tikv] table:tint, partition:p0 keep order:false, stats:pseudo]
        	            	 
        	Test:       	TestListColVariousTypes
        	Messages:   	sql:explain format = 'brief' select * from tint where a<=1, args:[]
FAIL
err=exit status 1
[2022/06/22 15:10:36.882 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 15:10:36.882 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:10:37.883 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:10:40.152 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 15:10:41.153 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 15:10:41.153 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 15:10:41.153 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 15:10:41.154 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 15:10:41.158 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 15:10:41.165 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=912066] ["lease id"=2231818a3faa5924]
[2022/06/22 15:10:41.168 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 15:10:41.177 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=6.758799ms]
[2022/06/22 15:10:41.177 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 15:10:41.177 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=195b7fc4-a4ae-4c44-b844-22856a15d44a] [runWorker=true]
[2022/06/22 15:10:41.177 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 15:10:41.178 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 15:10:41.178 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 15:10:41.178 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 15:10:41.180 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"] [ownerID=195b7fc4-a4ae-4c44-b844-22856a15d44a]
[2022/06/22 15:10:41.183 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 15:10:41.184 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 15:10:41.185 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"] [ownerID=195b7fc4-a4ae-4c44-b844-22856a15d44a]
[2022/06/22 15:10:41.205 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 15:10:41.219 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 15:10:41.222 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 15:10:41.222 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 15:10:41.644 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 15:10:41.645 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 15:10:41.648 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=3.899074ms]
[2022/06/22 15:10:41.649 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=60628feef3c0002]
[2022/06/22 15:10:41.650 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"] [ownerID=195b7fc4-a4ae-4c44-b844-22856a15d44a]
[2022/06/22 15:10:41.651 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"] [ownerID=195b7fc4-a4ae-4c44-b844-22856a15d44a]
[2022/06/22 15:10:41.678 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=60628feef3c0002]
[2022/06/22 15:10:41.678 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t1"] [user=]
[2022/06/22 15:10:41.678 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t1(id int, v1 decimal(20,2), v2 decimal(20,2))"] [user=]
[2022/06/22 15:10:41.684 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:10:41.666 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:10:41.685 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:10:41.666 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t1(id int, v1 decimal(20,2), v2 decimal(20,2))"]
[2022/06/22 15:10:41.685 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:10:41.666 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:10:41.690 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=772.594µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 15:10:41.740 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.135967ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:10:41.666 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:10:41.741 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:10:41.666 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:10:41.744 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 15:10:41.744 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:10:41.745 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="create table t2(id int, v1 decimal(10,2), v2 decimal(10,2))"] [user=]
[2022/06/22 15:10:41.750 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:10:41.716 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:10:41.750 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:10:41.716 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t2(id int, v1 decimal(10,2), v2 decimal(10,2))"]
[2022/06/22 15:10:41.751 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 15:10:41.716 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:10:41.756 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=604.188µs] [phyTblIDs="[71]"] [actionTypes="[8]"]
[2022/06/22 15:10:41.807 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.825445ms] [job="ID:72, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:10:41.716 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:10:41.808 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 15:10:41.716 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:10:41.811 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=72]
[2022/06/22 15:10:41.811 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:10:41.811 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=36] [cur_db=test] [sql="create table t3(id int, v1 decimal(10,2), v2 decimal(10,2))"] [user=]
[2022/06/22 15:10:41.816 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 15:10:41.766 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:10:41.816 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 15:10:41.766 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t3(id int, v1 decimal(10,2), v2 decimal(10,2))"]
[2022/06/22 15:10:41.817 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:0, start time: 2022-06-22 15:10:41.766 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:10:41.824 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=36] [neededSchemaVersion=37] ["start time"=812.454µs] [phyTblIDs="[73]"] [actionTypes="[8]"]
[2022/06/22 15:10:41.875 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=37] ["take time"=52.707657ms] [job="ID:74, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 15:10:41.766 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:10:41.876 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:73, RowCount:0, ArgLen:0, start time: 2022-06-22 15:10:41.766 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:10:41.879 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=74]
[2022/06/22 15:10:41.879 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:10:41.883 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079489553858567] [checkTS=434079489553858568]
[2022/06/22 15:10:41.888 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079489553858570] [checkTS=434079489553858571]
[2022/06/22 15:10:41.892 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079489553858575] [checkTS=434079489553858576]
[2022/06/22 15:10:41.934 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t1` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 15:10:41.902 +08:00] ["end time"=2022/06/22 15:10:41.930 +08:00] [cost=28.62448ms]
[2022/06/22 15:10:41.999 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t2` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 15:10:41.959 +08:00] ["end time"=2022/06/22 15:10:41.995 +08:00] [cost=36.263594ms]
[2022/06/22 15:10:42.039 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t3` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 15:10:42.014 +08:00] ["end time"=2022/06/22 15:10:42.035 +08:00] [cost=21.181474ms]
[2022/06/22 15:10:42.055 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"]
[2022/06/22 15:10:42.055 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"]
[2022/06/22 15:10:42.056 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"] []
[2022/06/22 15:10:42.056 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=300ns]
[2022/06/22 15:10:42.056 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=150ns]
[2022/06/22 15:10:42.056 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 15:10:42.056 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 15:10:42.056 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=195b7fc4-a4ae-4c44-b844-22856a15d44a] ["take time"=1.184848ms]
[2022/06/22 15:10:42.056 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=195b7fc4-a4ae-4c44-b844-22856a15d44a]
[2022/06/22 15:10:42.057 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 15:10:42.057 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 15:10:42.057 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:10:42.057 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:10:42.057 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:10:42.057 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:10:42.057 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:10:42.057 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 15:10:42.057 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 15:10:42.057 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"]
[2022/06/22 15:10:42.057 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"]
[2022/06/22 15:10:42.057 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 15:10:42.057 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 15:10:42.057 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 15:10:42.057 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 15:10:42.057 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"]
[2022/06/22 15:10:42.057 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"]
[2022/06/22 15:10:42.057 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 15:10:42.057 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 15:10:42.057 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 15:10:42.057 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 15:10:42.058 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 15:10:42.058 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a watch owner key /tidb/stats/owner/2231818a3faa5948"]
[2022/06/22 15:10:42.058 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"]
[2022/06/22 15:10:42.058 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 15:10:42.058 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:50170->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 15:10:42.058 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"]
[2022/06/22 15:10:42.080 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"] [error="context canceled"]
[2022/06/22 15:10:42.280 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 15:10:44.588 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:10:44.588 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 15:10:44.591 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:10:44.591 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 15:10:44.810 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 195b7fc4-a4ae-4c44-b844-22856a15d44a"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:10:44.810 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 15:10:44.810 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.754563718s]
[2022/06/22 15:10:44.810 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=60628feef3c0002]
[2022/06/22 15:10:44.810 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 15:10:44.810 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestMPPJoinWithCanNotFoundColumnInSchemaColumnsError (7.93s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				integration_test.go:919
        	Error:      	Not equal: 
        	            	expected: "[TableReader 1.00 root  data:ExchangeSender]\n[└─ExchangeSender 1.00 mpp[tiflash]  ExchangeType: PassThrough]\n[  └─Projection 1.00 mpp[tiflash]  Column#13]\n[    └─HashJoin 1.00 mpp[tiflash]  left outer join, equal:[eq(test.t3.v1, test.t1.v1) eq(test.t3.v2, test.t1.v2)]]\n[      ├─ExchangeReceiver(Build) 1.00 mpp[tiflash]  ]\n[      │ └─ExchangeSender 1.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: Column#23, collate: binary], [name: Column#24, collate: binary]]\n[      │   └─Projection 1.00 mpp[tiflash]  test.t3.v1, test.t3.v2, cast(test.t3.v1, decimal(20,2))->Column#23, cast(test.t3.v2, decimal(20,2))->Column#24]\n[      │     └─TableFullScan 1.00 mpp[tiflash] table:a keep order:false]\n[      └─Projection(Probe) 2.00 mpp[tiflash]  test.t1.v1, test.t1.v2, plus(test.t1.v1, test.t1.v2)->Column#13]\n[        └─HashJoin 2.00 mpp[tiflash]  left outer join, equal:[eq(test.t1.v1, test.t2.v1) eq(test.t1.v2, test.t2.v2)]]\n[          ├─ExchangeReceiver(Build) 2.00 mpp[tiflash]  ]\n[          │ └─ExchangeSender 2.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: test.t1.v1, collate: binary], [name: test.t1.v2, collate: binary]]\n[          │   └─Selection 2.00 mpp[tiflash]  not(isnull(test.t1.v1)), not(isnull(test.t1.v2))]\n[          │     └─TableFullScan 2.00 mpp[tiflash] table:t1 keep order:false]\n[          └─ExchangeReceiver(Probe) 8.00 mpp[tiflash]  ]\n[            └─ExchangeSender 8.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: Column#15, collate: binary], [name: Column#16, collate: binary]]\n[              └─Projection 8.00 mpp[tiflash]  test.t2.v1, test.t2.v2, cast(test.t2.v1, decimal(20,2))->Column#15, cast(test.t2.v2, decimal(20,2))->Column#16]\n[                └─Selection 8.00 mpp[tiflash]  not(isnull(test.t2.v1)), not(isnull(test.t2.v2))]\n[                  └─TableFullScan 8.00 mpp[tiflash] table:t2 keep order:false]\n"
        	            	actual  : "[TableReader 1.00 root  data:ExchangeSender]\n[└─ExchangeSender 1.00 mpp[tiflash]  ExchangeType: PassThrough]\n[  └─Projection 1.00 mpp[tiflash]  Column#13]\n[    └─HashJoin 1.00 mpp[tiflash]  left outer join, equal:[eq(test.t3.v1, test.t1.v1) eq(test.t3.v2, test.t1.v2)]]\n[      ├─ExchangeReceiver(Build) 1.00 mpp[tiflash]  ]\n[      │ └─ExchangeSender 1.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: Column#23, collate: binary], [name: Column#24, collate: binary]]\n[      │   └─Projection 1.00 mpp[tiflash]  test.t3.v1, test.t3.v2, cast(test.t3.v1, decimal(20,2))->Column#23, cast(test.t3.v2, decimal(20,2))->Column#24]\n[      │     └─TableFullScan 1.00 mpp[tiflash] table:a keep order:false]\n[      └─Projection(Probe) 2.00 mpp[tiflash]  test.t1.v1, test.t1.v2, plus(test.t1.v1, test.t1.v2)->Column#13]\n[        └─HashJoin 2.00 mpp[tiflash]  left outer join, equal:[eq(test.t1.v1, test.t2.v1) eq(test.t1.v2, test.t2.v2)]]\n[          ├─ExchangeReceiver(Build) 2.00 mpp[tiflash]  ]\n[          │ └─ExchangeSender 2.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: test.t1.v1, collate: binary], [name: test.t1.v2, collate: binary]]\n[          │   └─Selection 2.00 mpp[tiflash]  not(isnull(test.t1.v1)), not(isnull(test.t1.v2))]\n[          │     └─TableFullScan 2.00 mpp[tiflash] table:t1 keep order:false]\n[          └─ExchangeReceiver(Probe) 7.98 mpp[tiflash]  ]\n[            └─ExchangeSender 7.98 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: Column#15, collate: binary], [name: Column#16, collate: binary]]\n[              └─Projection 7.98 mpp[tiflash]  test.t2.v1, test.t2.v2, cast(test.t2.v1, decimal(20,2))->Column#15, cast(test.t2.v2, decimal(20,2))->Column#16]\n[                └─Selection 7.98 mpp[tiflash]  not(isnull(test.t2.v1)), not(isnull(test.t2.v2))]\n[                  └─TableFullScan 8.00 mpp[tiflash] table:t2 keep order:false]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -14,6 +14,6 @@
        	            	 [          │     └─TableFullScan 2.00 mpp[tiflash] table:t1 keep order:false]
        	            	-[          └─ExchangeReceiver(Probe) 8.00 mpp[tiflash]  ]
        	            	-[            └─ExchangeSender 8.00 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: Column#15, collate: binary], [name: Column#16, collate: binary]]
        	            	-[              └─Projection 8.00 mpp[tiflash]  test.t2.v1, test.t2.v2, cast(test.t2.v1, decimal(20,2))->Column#15, cast(test.t2.v2, decimal(20,2))->Column#16]
        	            	-[                └─Selection 8.00 mpp[tiflash]  not(isnull(test.t2.v1)), not(isnull(test.t2.v2))]
        	            	+[          └─ExchangeReceiver(Probe) 7.98 mpp[tiflash]  ]
        	            	+[            └─ExchangeSender 7.98 mpp[tiflash]  ExchangeType: HashPartition, Hash Cols: [name: Column#15, collate: binary], [name: Column#16, collate: binary]]
        	            	+[              └─Projection 7.98 mpp[tiflash]  test.t2.v1, test.t2.v2, cast(test.t2.v1, decimal(20,2))->Column#15, cast(test.t2.v2, decimal(20,2))->Column#16]
        	            	+[                └─Selection 7.98 mpp[tiflash]  not(isnull(test.t2.v1)), not(isnull(test.t2.v2))]
        	            	 [                  └─TableFullScan 8.00 mpp[tiflash] table:t2 keep order:false]
        	Test:       	TestMPPJoinWithCanNotFoundColumnInSchemaColumnsError
        	Messages:   	sql:explain format = 'brief' select v from t3 as a left join (select t1.v1, t1.v2, t1.v1 + t1.v2 as v from t1 left join t2 on t1.v1 = t2.v1 and t1.v2 = t2.v2) b on a.v1 = b.v1 and a.v2 = b.v2, args:[]
FAIL
err=exit status 1
[2022/06/22 15:15:09.312 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 15:15:09.312 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:15:10.312 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:15:14.315 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING: error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING"]
[2022/06/22 15:15:15.317 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 15:15:15.317 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 15:15:15.317 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 15:15:15.317 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 15:15:17.321 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 15:15:17.329 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=1498738] ["lease id"=2231818a43d24427]
[2022/06/22 15:15:17.331 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 15:15:23.331 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=4.012171488s]
[2022/06/22 15:15:23.332 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 15:15:23.332 +08:00] [WARN] [domain.go:449] ["loading schema takes a long time"] ["take time"=5.99892305s]
[2022/06/22 15:15:23.332 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=bc16c5e4-a272-4a02-872f-5d345ce5ed49] [runWorker=true]
[2022/06/22 15:15:23.332 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 15:15:23.332 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 15:15:23.332 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 15:15:23.332 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 15:15:23.334 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"] [ownerID=bc16c5e4-a272-4a02-872f-5d345ce5ed49]
[2022/06/22 15:15:23.337 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 15:15:23.339 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 15:15:23.340 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"] [ownerID=bc16c5e4-a272-4a02-872f-5d345ce5ed49]
[2022/06/22 15:15:23.352 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 15:15:23.642 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 15:15:23.645 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 15:15:23.645 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 15:15:30.946 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 15:15:30.946 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 15:15:30.949 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=3.509858ms]
[2022/06/22 15:15:30.951 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=606291097b40002]
[2022/06/22 15:15:30.952 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"] [ownerID=bc16c5e4-a272-4a02-872f-5d345ce5ed49]
[2022/06/22 15:15:30.952 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"] [ownerID=bc16c5e4-a272-4a02-872f-5d345ce5ed49]
[2022/06/22 15:15:30.975 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=606291097b40002]
[2022/06/22 15:15:30.975 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t"] [user=]
[2022/06/22 15:15:30.976 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t(a int primary key, b int not null, c int not null default 0, index idx_bc(b, c))"] [user=]
[2022/06/22 15:15:30.981 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:15:30.975 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:15:30.981 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:15:30.975 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t(a int primary key, b int not null, c int not null default 0, index idx_bc(b, c))"]
[2022/06/22 15:15:30.982 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:15:30.975 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:30.987 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=715.447µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 15:15:31.037 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.424222ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:15:30.975 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.039 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:15:30.975 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.042 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 15:15:31.042 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:15:31.088 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 15:15:31.053 +08:00] ["end time"=2022/06/22 15:15:31.085 +08:00] [cost=32.010881ms]
[2022/06/22 15:15:31.104 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="truncate table t"] [user=]
[2022/06/22 15:15:31.109 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:72, Type:truncate table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:15:31.075 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:15:31.109 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:72, Type:truncate table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:15:31.075 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="truncate table t"]
[2022/06/22 15:15:31.110 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:truncate table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:15:31.075 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.116 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=563.36µs] [phyTblIDs="[69,71]"] [actionTypes="[2048,2048]"]
[2022/06/22 15:15:31.166 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.317755ms] [job="ID:72, Type:truncate table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:2, start time: 2022-06-22 15:15:31.075 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.166 +08:00] [INFO] [delete_range.go:448] ["[ddl] insert into delete-range table"] [jobID=72] [elementID=1] [comment="table ID is 69"]
[2022/06/22 15:15:31.171 +08:00] [INFO] [delete_range.go:105] ["[ddl] add job into delete-range table"] [jobID=72] [jobType="truncate table"]
[2022/06/22 15:15:31.172 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:truncate table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:2, start time: 2022-06-22 15:15:31.075 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.176 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=72]
[2022/06/22 15:15:31.176 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:15:31.232 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 15:15:31.183 +08:00] ["end time"=2022/06/22 15:15:31.228 +08:00] [cost=45.498346ms]
[2022/06/22 15:15:31.247 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=36] [cur_db=test] [sql="truncate table t"] [user=]
[2022/06/22 15:15:31.252 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:74, Type:truncate table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:15:31.224 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:15:31.252 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:74, Type:truncate table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:15:31.224 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="truncate table t"]
[2022/06/22 15:15:31.253 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:truncate table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 15:15:31.224 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.261 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=36] [neededSchemaVersion=37] ["start time"=539.371µs] [phyTblIDs="[71,73]"] [actionTypes="[2048,2048]"]
[2022/06/22 15:15:31.310 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=37] ["take time"=51.131518ms] [job="ID:74, Type:truncate table, State:done, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:2, start time: 2022-06-22 15:15:31.224 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.311 +08:00] [INFO] [delete_range.go:448] ["[ddl] insert into delete-range table"] [jobID=74] [elementID=1] [comment="table ID is 71"]
[2022/06/22 15:15:31.313 +08:00] [INFO] [delete_range.go:105] ["[ddl] add job into delete-range table"] [jobID=74] [jobType="truncate table"]
[2022/06/22 15:15:31.314 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:truncate table, State:synced, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:2, start time: 2022-06-22 15:15:31.224 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.318 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=74]
[2022/06/22 15:15:31.318 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:15:31.357 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 15:15:31.325 +08:00] ["end time"=2022/06/22 15:15:31.354 +08:00] [cost=29.210301ms]
[2022/06/22 15:15:31.373 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=37] [cur_db=test] [sql="truncate table t"] [user=]
[2022/06/22 15:15:31.377 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:76, Type:truncate table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 15:15:31.325 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:15:31.377 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:76, Type:truncate table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 15:15:31.325 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="truncate table t"]
[2022/06/22 15:15:31.378 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:76, Type:truncate table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:0, start time: 2022-06-22 15:15:31.325 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.385 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=37] [neededSchemaVersion=38] ["start time"=629.289µs] [phyTblIDs="[73,75]"] [actionTypes="[2048,2048]"]
[2022/06/22 15:15:31.435 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=38] ["take time"=51.124547ms] [job="ID:76, Type:truncate table, State:done, SchemaState:public, SchemaID:1, TableID:73, RowCount:0, ArgLen:2, start time: 2022-06-22 15:15:31.325 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.435 +08:00] [INFO] [delete_range.go:448] ["[ddl] insert into delete-range table"] [jobID=76] [elementID=1] [comment="table ID is 73"]
[2022/06/22 15:15:31.438 +08:00] [INFO] [delete_range.go:105] ["[ddl] add job into delete-range table"] [jobID=76] [jobType="truncate table"]
[2022/06/22 15:15:31.438 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:76, Type:truncate table, State:synced, SchemaState:public, SchemaID:1, TableID:73, RowCount:0, ArgLen:2, start time: 2022-06-22 15:15:31.325 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.442 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=76]
[2022/06/22 15:15:31.442 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:15:31.480 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 15:15:31.448 +08:00] ["end time"=2022/06/22 15:15:31.476 +08:00] [cost=27.5322ms]
[2022/06/22 15:15:31.503 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=38] [cur_db=test] [sql="truncate table t"] [user=]
[2022/06/22 15:15:31.511 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:78, Type:truncate table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 15:15:31.474 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:15:31.511 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:78, Type:truncate table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 15:15:31.474 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="truncate table t"]
[2022/06/22 15:15:31.512 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:78, Type:truncate table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 15:15:31.474 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.518 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=38] [neededSchemaVersion=39] ["start time"=567.98µs] [phyTblIDs="[75,77]"] [actionTypes="[2048,2048]"]
[2022/06/22 15:15:31.568 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=39] ["take time"=51.55253ms] [job="ID:78, Type:truncate table, State:done, SchemaState:public, SchemaID:1, TableID:75, RowCount:0, ArgLen:2, start time: 2022-06-22 15:15:31.474 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.569 +08:00] [INFO] [delete_range.go:448] ["[ddl] insert into delete-range table"] [jobID=78] [elementID=1] [comment="table ID is 75"]
[2022/06/22 15:15:31.571 +08:00] [INFO] [delete_range.go:105] ["[ddl] add job into delete-range table"] [jobID=78] [jobType="truncate table"]
[2022/06/22 15:15:31.572 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:78, Type:truncate table, State:synced, SchemaState:public, SchemaID:1, TableID:75, RowCount:0, ArgLen:2, start time: 2022-06-22 15:15:31.474 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.576 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=78]
[2022/06/22 15:15:31.576 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:15:31.612 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 15:15:31.582 +08:00] ["end time"=2022/06/22 15:15:31.608 +08:00] [cost=26.457279ms]
[2022/06/22 15:15:31.625 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=39] [cur_db=test] [sql="drop table t"] [user=]
[2022/06/22 15:15:31.627 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:79, Type:drop table, State:queueing, SchemaState:public, SchemaID:1, TableID:77, RowCount:0, ArgLen:0, start time: 2022-06-22 15:15:31.624 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:15:31.627 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:79, Type:drop table, State:queueing, SchemaState:public, SchemaID:1, TableID:77, RowCount:0, ArgLen:0, start time: 2022-06-22 15:15:31.624 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="drop table t"]
[2022/06/22 15:15:31.628 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:79, Type:drop table, State:queueing, SchemaState:public, SchemaID:1, TableID:77, RowCount:0, ArgLen:0, start time: 2022-06-22 15:15:31.624 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.632 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=39] [neededSchemaVersion=40] ["start time"=204.396µs] [phyTblIDs="[77]"] [actionTypes="[16]"]
[2022/06/22 15:15:31.682 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=40] ["take time"=51.562651ms] [job="ID:79, Type:drop table, State:running, SchemaState:write only, SchemaID:1, TableID:77, RowCount:0, ArgLen:0, start time: 2022-06-22 15:15:31.624 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.683 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:79, Type:drop table, State:running, SchemaState:write only, SchemaID:1, TableID:77, RowCount:0, ArgLen:0, start time: 2022-06-22 15:15:31.624 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.687 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=40] [neededSchemaVersion=41] ["start time"=161.617µs] [phyTblIDs="[]"] [actionTypes="[]"]
[2022/06/22 15:15:31.738 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=41] ["take time"=51.614881ms] [job="ID:79, Type:drop table, State:running, SchemaState:delete only, SchemaID:1, TableID:77, RowCount:0, ArgLen:0, start time: 2022-06-22 15:15:31.624 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.738 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:79, Type:drop table, State:running, SchemaState:delete only, SchemaID:1, TableID:77, RowCount:0, ArgLen:0, start time: 2022-06-22 15:15:31.624 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.743 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=41] [neededSchemaVersion=42] ["start time"=161.447µs] [phyTblIDs="[]"] [actionTypes="[]"]
[2022/06/22 15:15:31.793 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=42] ["take time"=51.59813ms] [job="ID:79, Type:drop table, State:done, SchemaState:none, SchemaID:1, TableID:77, RowCount:0, ArgLen:3, start time: 2022-06-22 15:15:31.624 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.794 +08:00] [INFO] [delete_range.go:448] ["[ddl] insert into delete-range table"] [jobID=79] [elementID=1] [comment="table ID is 77"]
[2022/06/22 15:15:31.796 +08:00] [INFO] [delete_range.go:105] ["[ddl] add job into delete-range table"] [jobID=79] [jobType="drop table"]
[2022/06/22 15:15:31.797 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:79, Type:drop table, State:synced, SchemaState:none, SchemaID:1, TableID:77, RowCount:0, ArgLen:3, start time: 2022-06-22 15:15:31.624 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.800 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=79]
[2022/06/22 15:15:31.800 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:15:31.801 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=42] [cur_db=test] [sql="create table t(a int primary key, b int, c int, d bigint default 2147483648, e bigint default 2147483648, f bigint default 2147483648, index idx(b,d,a,c))"] [user=]
[2022/06/22 15:15:31.806 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:81, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:80, RowCount:0, ArgLen:1, start time: 2022-06-22 15:15:31.775 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:15:31.806 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:81, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:80, RowCount:0, ArgLen:1, start time: 2022-06-22 15:15:31.775 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t(a int primary key, b int, c int, d bigint default 2147483648, e bigint default 2147483648, f bigint default 2147483648, index idx(b,d,a,c))"]
[2022/06/22 15:15:31.806 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:81, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:80, RowCount:0, ArgLen:0, start time: 2022-06-22 15:15:31.775 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.811 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=42] [neededSchemaVersion=43] ["start time"=539.01µs] [phyTblIDs="[80]"] [actionTypes="[8]"]
[2022/06/22 15:15:31.861 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=43] ["take time"=51.356505ms] [job="ID:81, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:80, RowCount:0, ArgLen:1, start time: 2022-06-22 15:15:31.775 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.862 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:81, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:80, RowCount:0, ArgLen:0, start time: 2022-06-22 15:15:31.775 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:15:31.865 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=81]
[2022/06/22 15:15:31.865 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:15:31.922 +08:00] [INFO] [analyze.go:420] ["analyze table `test`.`t` has finished"] [partition=] ["job info"="analyze table all columns with 256 buckets, 500 topn, 1 samplerate"] ["start time"=2022/06/22 15:15:31.871 +08:00] ["end time"=2022/06/22 15:15:31.918 +08:00] [cost=46.489001ms]
[2022/06/22 15:15:31.942 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"]
[2022/06/22 15:15:31.942 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"]
[2022/06/22 15:15:31.942 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 15:15:31.942 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"] []
[2022/06/22 15:15:31.943 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=150ns]
[2022/06/22 15:15:31.943 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=130ns]
[2022/06/22 15:15:31.943 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 15:15:31.943 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 15:15:31.943 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=bc16c5e4-a272-4a02-872f-5d345ce5ed49] ["take time"=1.033541ms]
[2022/06/22 15:15:31.943 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=bc16c5e4-a272-4a02-872f-5d345ce5ed49]
[2022/06/22 15:15:31.944 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 15:15:31.944 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"]
[2022/06/22 15:15:31.944 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"]
[2022/06/22 15:15:31.944 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 15:15:31.944 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"]
[2022/06/22 15:15:31.944 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"]
[2022/06/22 15:15:31.944 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49 watch owner key /tidb/stats/owner/2231818a43d2445d"]
[2022/06/22 15:15:31.944 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"]
[2022/06/22 15:15:31.944 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 15:15:31.944 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:50642->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 15:15:31.944 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"]
[2022/06/22 15:15:31.976 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"] [error="context canceled"]
[2022/06/22 15:15:32.177 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 15:15:34.462 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:15:34.462 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 15:15:34.489 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:15:34.489 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 15:15:34.702 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager bc16c5e4-a272-4a02-872f-5d345ce5ed49"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:15:34.702 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 15:15:34.702 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.759771693s]
[2022/06/22 15:15:34.702 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=606291097b40002]
[2022/06/22 15:15:34.702 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 15:15:34.702 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestLimitCrossEstimation (25.39s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				cbo_test.go:705
        	Error:      	Not equal: 
        	            	expected: "[Projection 1.00 root  test.t.a]\n[└─TopN 1.00 root  test.t.a, offset:0, count:1]\n[  └─IndexReader 1.00 root  index:TopN]\n[    └─TopN 1.00 cop[tikv]  test.t.a, offset:0, count:1]\n[      └─Selection 6.00 cop[tikv]  gt(test.t.c, 0)]\n[        └─IndexRangeScan 6.00 cop[tikv] table:t, index:idx(b, d, a, c) range:[2,2], keep order:false]\n"
        	            	actual  : "[Projection 1.00 root  test.t.a]\n[└─TopN 1.00 root  test.t.a, offset:0, count:1]\n[  └─IndexReader 1.00 root  index:TopN]\n[    └─TopN 1.00 cop[tikv]  test.t.a, offset:0, count:1]\n[      └─Selection 2.00 cop[tikv]  gt(test.t.c, 0)]\n[        └─IndexRangeScan 6.00 cop[tikv] table:t, index:idx(b, d, a, c) range:[2,2], keep order:false]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -4,3 +4,3 @@
        	            	 [    └─TopN 1.00 cop[tikv]  test.t.a, offset:0, count:1]
        	            	-[      └─Selection 6.00 cop[tikv]  gt(test.t.c, 0)]
        	            	+[      └─Selection 2.00 cop[tikv]  gt(test.t.c, 0)]
        	            	 [        └─IndexRangeScan 6.00 cop[tikv] table:t, index:idx(b, d, a, c) range:[2,2], keep order:false]
        	Test:       	TestLimitCrossEstimation
        	Messages:   	sql:explain format = 'brief' SELECT a FROM t WHERE b = 2 and c > 0 ORDER BY a limit 1, args:[]
FAIL
err=exit status 1
[2022/06/22 15:20:11.453 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 15:20:11.453 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:20:12.453 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:20:14.672 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 15:20:15.673 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 15:20:15.673 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 15:20:15.673 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 15:20:15.673 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 15:20:15.677 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 15:20:15.685 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=962891] ["lease id"=2231818a486e9124]
[2022/06/22 15:20:15.687 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 15:20:15.696 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=7.015144ms]
[2022/06/22 15:20:15.697 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 15:20:15.697 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=9225d472-bf13-491e-abf3-3b47206834c5] [runWorker=true]
[2022/06/22 15:20:15.697 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 15:20:15.698 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 15:20:15.698 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 15:20:15.698 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 15:20:15.702 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"] [ownerID=9225d472-bf13-491e-abf3-3b47206834c5]
[2022/06/22 15:20:15.708 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 15:20:15.708 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 15:20:15.709 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"] [ownerID=9225d472-bf13-491e-abf3-3b47206834c5]
[2022/06/22 15:20:15.724 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 15:20:15.738 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 15:20:15.741 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 15:20:15.741 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 15:20:15.885 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 15:20:15.885 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 15:20:15.888 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=6062921fc340002]
[2022/06/22 15:20:15.889 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"] [ownerID=9225d472-bf13-491e-abf3-3b47206834c5]
[2022/06/22 15:20:15.889 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"] [ownerID=9225d472-bf13-491e-abf3-3b47206834c5]
[2022/06/22 15:20:15.891 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=6.107325ms]
[2022/06/22 15:20:15.917 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=6062921fc340002]
[2022/06/22 15:20:15.918 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t"] [user=]
[2022/06/22 15:20:15.919 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t(a datetime) partition by range columns (a) (partition p1 values less than ('20000101'), partition p2 values less than ('2000-10-01'));"] [user=]
[2022/06/22 15:20:15.931 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:20:15.885 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:20:15.931 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:20:15.885 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t(a datetime) partition by range columns (a) (partition p1 values less than ('20000101'), partition p2 values less than ('2000-10-01'));"]
[2022/06/22 15:20:15.932 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:20:15.885 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:20:15.937 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=1.04914ms] [phyTblIDs="[69,70,71]"] [actionTypes="[8,8,8]"]
[2022/06/22 15:20:15.987 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.333681ms] [job="ID:72, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:20:15.885 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:20:15.988 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:20:15.885 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:20:15.991 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=72]
[2022/06/22 15:20:15.991 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:20:15.993 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079640055971847] [checkTS=434079640055971848]
[2022/06/22 15:20:15.996 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"]
[2022/06/22 15:20:15.996 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"]
[2022/06/22 15:20:15.996 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 15:20:15.996 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"] []
[2022/06/22 15:20:15.997 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=620ns]
[2022/06/22 15:20:15.997 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=130ns]
[2022/06/22 15:20:15.997 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 15:20:15.997 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 15:20:15.997 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=9225d472-bf13-491e-abf3-3b47206834c5] ["take time"=1.028129ms]
[2022/06/22 15:20:15.997 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=9225d472-bf13-491e-abf3-3b47206834c5]
[2022/06/22 15:20:15.998 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 15:20:15.998 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"]
[2022/06/22 15:20:15.998 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"]
[2022/06/22 15:20:15.998 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 15:20:15.998 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"]
[2022/06/22 15:20:15.998 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"]
[2022/06/22 15:20:15.998 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 9225d472-bf13-491e-abf3-3b47206834c5 watch owner key /tidb/stats/owner/2231818a486e9148"]
[2022/06/22 15:20:15.998 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"]
[2022/06/22 15:20:15.998 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 15:20:15.998 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:51158->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 15:20:15.998 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"]
[2022/06/22 15:20:16.015 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"] [error="context canceled"]
[2022/06/22 15:20:16.216 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 15:20:18.537 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:20:18.537 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 15:20:18.542 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:20:18.542 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 15:20:18.745 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 9225d472-bf13-491e-abf3-3b47206834c5"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:20:18.745 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 15:20:18.745 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.74881086s]
[2022/06/22 15:20:18.745 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=6062921fc340002]
[2022/06/22 15:20:18.745 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 15:20:18.745 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestPartitionPruningWithDateType (7.29s)
    integration_test.go:1493: 
        	Error Trace:	integration_test.go:1493
        	Error:      	Should be true
        	Test:       	TestPartitionPruningWithDateType
FAIL
err=exit status 1
[2022/06/22 15:23:47.949 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 15:23:47.950 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:23:48.950 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:23:52.953 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING: error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING"]
[2022/06/22 15:23:53.955 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 15:23:53.955 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 15:23:53.955 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 15:23:53.955 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 15:23:53.960 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 15:23:53.964 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=562798] ["lease id"=2231818a4bbc1f24]
[2022/06/22 15:23:53.966 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 15:23:53.975 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=7.432834ms]
[2022/06/22 15:23:53.977 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 15:23:53.977 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=a4eac537-b701-4633-aa9f-ef2cfbcbbcf2] [runWorker=true]
[2022/06/22 15:23:53.977 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 15:23:53.978 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 15:23:53.978 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 15:23:53.978 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 15:23:53.979 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"] [ownerID=a4eac537-b701-4633-aa9f-ef2cfbcbbcf2]
[2022/06/22 15:23:53.986 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 15:23:53.986 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 15:23:53.988 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"] [ownerID=a4eac537-b701-4633-aa9f-ef2cfbcbbcf2]
[2022/06/22 15:23:54.003 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 15:23:54.015 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 15:23:54.017 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 15:23:54.018 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 15:23:54.211 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 15:23:54.211 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 15:23:54.213 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=606292f4f540002]
[2022/06/22 15:23:54.215 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"] [ownerID=a4eac537-b701-4633-aa9f-ef2cfbcbbcf2]
[2022/06/22 15:23:54.215 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"] [ownerID=a4eac537-b701-4633-aa9f-ef2cfbcbbcf2]
[2022/06/22 15:23:54.219 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=7.687904ms]
[2022/06/22 15:23:54.244 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=606292f4f540002]
[2022/06/22 15:23:54.244 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t"] [user=]
[2022/06/22 15:23:54.244 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="create table t(a int, b int, c int, index(c))"] [user=]
[2022/06/22 15:23:54.251 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:23:54.247 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:23:54.251 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:23:54.247 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t(a int, b int, c int, index(c))"]
[2022/06/22 15:23:54.252 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:23:54.247 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:23:54.258 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=839.867µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 15:23:54.308 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.714947ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:23:54.247 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:23:54.309 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:23:54.247 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:23:54.312 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 15:23:54.312 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:23:54.314 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079697284890631] [checkTS=434079697284890632]
[2022/06/22 15:23:54.317 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="drop table if exists pt"] [user=]
[2022/06/22 15:23:54.317 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=35] [cur_db=test] [sql="CREATE TABLE pt (a int, b int) PARTITION BY RANGE (a) (\n\t\tPARTITION p0 VALUES LESS THAN (2),\n\t\tPARTITION p1 VALUES LESS THAN (100)\n\t);"] [user=]
[2022/06/22 15:23:54.324 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:23:54.296 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:23:54.324 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:23:54.296 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="CREATE TABLE pt (a int, b int) PARTITION BY RANGE (a) (\n\t\tPARTITION p0 VALUES LESS THAN (2),\n\t\tPARTITION p1 VALUES LESS THAN (100)\n\t);"]
[2022/06/22 15:23:54.325 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 15:23:54.296 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:23:54.331 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=803.676µs] [phyTblIDs="[71,72,73]"] [actionTypes="[8,8,8]"]
[2022/06/22 15:23:54.381 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.525721ms] [job="ID:74, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:23:54.296 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:23:54.382 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 15:23:54.296 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:23:54.385 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=74]
[2022/06/22 15:23:54.385 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:23:54.385 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=36] [cur_db=test] [sql="drop table if exists tc;"] [user=]
[2022/06/22 15:23:54.386 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=36] [cur_db=test] [sql="CREATE TABLE `tc`(`timestamp` timestamp NULL DEFAULT NULL, KEY `idx_timestamp` (`timestamp`)) PARTITION BY RANGE ( UNIX_TIMESTAMP(`timestamp`) ) (PARTITION `p2020072312` VALUES LESS THAN (1595480400),PARTITION `p2020072313` VALUES LESS THAN (1595484000));"] [user=]
[2022/06/22 15:23:54.393 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 15:23:54.347 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:23:54.393 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 15:23:54.347 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="CREATE TABLE `tc`(`timestamp` timestamp NULL DEFAULT NULL, KEY `idx_timestamp` (`timestamp`)) PARTITION BY RANGE ( UNIX_TIMESTAMP(`timestamp`) ) (PARTITION `p2020072312` VALUES LESS THAN (1595480400),PARTITION `p2020072313` VALUES LESS THAN (1595484000));"]
[2022/06/22 15:23:54.394 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 15:23:54.347 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:23:54.400 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=36] [neededSchemaVersion=37] ["start time"=894.225µs] [phyTblIDs="[75,76,77]"] [actionTypes="[8,8,8]"]
[2022/06/22 15:23:54.450 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=37] ["take time"=51.307533ms] [job="ID:78, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 15:23:54.347 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:23:54.451 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:78, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 15:23:54.347 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:23:54.454 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=78]
[2022/06/22 15:23:54.454 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:23:54.454 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=37] [cur_db=test] [sql="drop table if exists ta"] [user=]
[2022/06/22 15:23:54.455 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=37] [cur_db=test] [sql="create table ta(a int);"] [user=]
[2022/06/22 15:23:54.460 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:80, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:79, RowCount:0, ArgLen:1, start time: 2022-06-22 15:23:54.446 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:23:54.460 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:80, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:79, RowCount:0, ArgLen:1, start time: 2022-06-22 15:23:54.446 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table ta(a int);"]
[2022/06/22 15:23:54.461 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:80, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:79, RowCount:0, ArgLen:0, start time: 2022-06-22 15:23:54.446 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:23:54.466 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=37] [neededSchemaVersion=38] ["start time"=579.121µs] [phyTblIDs="[79]"] [actionTypes="[8]"]
[2022/06/22 15:23:54.516 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=38] ["take time"=51.715396ms] [job="ID:80, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:79, RowCount:0, ArgLen:1, start time: 2022-06-22 15:23:54.446 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:23:54.517 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:80, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:79, RowCount:0, ArgLen:0, start time: 2022-06-22 15:23:54.446 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:23:54.520 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=80]
[2022/06/22 15:23:54.520 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:23:54.522 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079697337581575] [checkTS=434079697337581576]
[2022/06/22 15:23:54.524 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=38] [cur_db=test] [sql="drop table if exists tb"] [user=]
[2022/06/22 15:23:54.524 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=38] [cur_db=test] [sql="create table tb(a int);"] [user=]
[2022/06/22 15:23:54.530 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:82, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:81, RowCount:0, ArgLen:1, start time: 2022-06-22 15:23:54.497 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:23:54.530 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:82, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:81, RowCount:0, ArgLen:1, start time: 2022-06-22 15:23:54.497 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table tb(a int);"]
[2022/06/22 15:23:54.531 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:82, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:81, RowCount:0, ArgLen:0, start time: 2022-06-22 15:23:54.497 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:23:54.542 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=38] [neededSchemaVersion=39] ["start time"=631.789µs] [phyTblIDs="[81]"] [actionTypes="[8]"]
[2022/06/22 15:23:54.592 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=39] ["take time"=51.595498ms] [job="ID:82, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:81, RowCount:0, ArgLen:1, start time: 2022-06-22 15:23:54.497 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:23:54.593 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:82, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:81, RowCount:0, ArgLen:0, start time: 2022-06-22 15:23:54.497 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:23:54.596 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=82]
[2022/06/22 15:23:54.596 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:23:54.598 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079697363533826] [checkTS=434079697363533827]
[2022/06/22 15:23:54.602 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"]
[2022/06/22 15:23:54.602 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"]
[2022/06/22 15:23:54.603 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"] []
[2022/06/22 15:23:54.603 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=490ns]
[2022/06/22 15:23:54.603 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=120ns]
[2022/06/22 15:23:54.603 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 15:23:54.603 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 15:23:54.603 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=a4eac537-b701-4633-aa9f-ef2cfbcbbcf2] ["take time"=1.019103ms]
[2022/06/22 15:23:54.603 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=a4eac537-b701-4633-aa9f-ef2cfbcbbcf2]
[2022/06/22 15:23:54.604 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 15:23:54.604 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 15:23:54.604 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 15:23:54.604 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:23:54.604 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:23:54.604 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:23:54.604 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:23:54.604 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:23:54.604 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 15:23:54.604 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 15:23:54.604 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"]
[2022/06/22 15:23:54.604 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"]
[2022/06/22 15:23:54.604 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 15:23:54.604 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 15:23:54.604 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 15:23:54.604 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"]
[2022/06/22 15:23:54.604 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"]
[2022/06/22 15:23:54.604 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 15:23:54.604 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 15:23:54.604 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 15:23:54.604 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 15:23:54.604 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 15:23:54.605 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2 watch owner key /tidb/stats/owner/2231818a4bbc1f48"]
[2022/06/22 15:23:54.605 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"]
[2022/06/22 15:23:54.605 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 15:23:54.605 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:51902->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 15:23:54.605 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"]
[2022/06/22 15:23:54.622 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"] [error="context canceled"]
[2022/06/22 15:23:54.822 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 15:23:57.130 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:23:57.130 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 15:23:57.168 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:23:57.168 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 15:23:57.365 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager a4eac537-b701-4633-aa9f-ef2cfbcbbcf2"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:23:57.365 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 15:23:57.365 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.76304771s]
[2022/06/22 15:23:57.365 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=606292f4f540002]
[2022/06/22 15:23:57.365 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 15:23:57.365 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestPushdownDistinctEnable (9.42s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				physical_plan_test.go:1143
        	            				physical_plan_test.go:1056
        	Error:      	Not equal: 
        	            	expected: "[1 2]\n"
        	            	actual  : "[2 2]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,2 +1,2 @@
        	            	-[1 2]
        	            	+[2 2]
        	            	 
        	Test:       	TestPushdownDistinctEnable
        	Messages:   	sql:select /*+ HASH_AGG() */ a, count(distinct a) from t;, args:[]
FAIL
err=exit status 1
[2022/06/22 15:24:41.987 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 15:24:41.987 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:24:42.987 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:24:46.990 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING: error:rpc error: code = DeadlineExceeded desc = context deadline exceeded target:127.0.0.1:2379 status:CONNECTING"]
[2022/06/22 15:24:47.992 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 15:24:47.992 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 15:24:47.992 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 15:24:47.992 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 15:24:49.996 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 15:24:50.000 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=4051762] ["lease id"=2231818a4c8f2d27]
[2022/06/22 15:24:50.003 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 15:24:56.002 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=4.007696934s]
[2022/06/22 15:24:56.004 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 15:24:56.004 +08:00] [WARN] [domain.go:449] ["loading schema takes a long time"] ["take time"=5.999449076s]
[2022/06/22 15:24:56.004 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=1a63af86-b363-4b3f-b1f5-68375caf227b] [runWorker=true]
[2022/06/22 15:24:56.004 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 15:24:56.008 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 15:24:56.008 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 15:24:56.008 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 15:24:56.010 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"] [ownerID=1a63af86-b363-4b3f-b1f5-68375caf227b]
[2022/06/22 15:24:56.014 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 15:24:56.014 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 15:24:56.015 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"] [ownerID=1a63af86-b363-4b3f-b1f5-68375caf227b]
[2022/06/22 15:24:56.030 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 15:24:56.295 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 15:24:56.297 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 15:24:56.298 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 15:24:56.474 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 15:24:56.474 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 15:24:56.480 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=5.806146ms]
[2022/06/22 15:24:56.480 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=60629331c700001]
[2022/06/22 15:24:56.482 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"] [ownerID=1a63af86-b363-4b3f-b1f5-68375caf227b]
[2022/06/22 15:24:56.482 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"] [ownerID=1a63af86-b363-4b3f-b1f5-68375caf227b]
[2022/06/22 15:24:56.992 +08:00] [WARN] [adapter.go:1095] ["# Txn_start_ts: 434079713585004550\n# Query_time: 0.507533172\n# Parse_time: 0\n# Compile_time: 0.000104188\n# Rewrite_time: 0.000025515\n# Optimize_time: 0\n# Wait_TS: 0.000179584\n# Prewrite_time: 0.002886179 Commit_time: 0.001693177 Get_commit_ts_time: 0.000121828 Write_keys: 1 Write_size: 109 Prewrite_region: 1\n# Is_internal: true\n# Digest: 61f4cce222f1a26d6b0650865051ebed3d077412ae053636e2f5acf9dc426a42\n# Num_cop_tasks: 0\n# Mem_max: 403\n# Prepared: false\n# Plan_from_cache: false\n# Plan_from_binding: false\n# Has_more_results: false\n# KV_total: 0\n# PD_total: 0\n# Backoff_total: 0\n# Write_sql_response_total: 0\n# Result_rows: 0\n# Succ: true\n# IsExplicitTxn: false\n# Plan: tidb_decode_plan('nwTwTzAJMjdfMQkwCTAJTi9BCTAJdGltZToxLjY1bXMsIGxvb3BzOjEsIHByZXBhcmU6IDE5NS4zwrVzLCBjaGVja19pbnNlcnQ6IHt0b3RhbF90AT4QIDEuNDYBPwhtZW0NIQBfBVcQIDY3LjQFPRxwcmVmZXRjaAEsBDM5ASxIcnBjOntCYXRjaEdldDp7bnVtXwETDDIsIHQZWhgxLjM0bXN9ERQYcHJvY2Vzcw1dADQBRyxzY2FuX2RldGFpbDoRlREnFGtleXM6IBVSLhcAJF9zaXplOiAyMDgRXBUtmHJvY2tzZGI6IHtkZWxldGVfc2tpcHBlZF9jb3VudDogMCwga2V5X0YWAEBibG9jazoge2NhY2hlX2hpdBEyGDEyLCByZWEuQgAFDzRieXRlOiAwIEJ5dGVzfQEBbCwgY29tbWl0X3R4bjoge3ByZXdyaXRlOjIuODkB7gRnZQFVCSIYczoxMjEuOCVfCTYhxwUnJHJlZ2lvbl9udW0hzAVDCeAEMSwNDgV7SDEwOX0JNDAzIEJ5dGVzCU4vQQo=')\nINSERT HIGH_PRIORITY INTO mysql.tidb VALUES ('tikv_gc_leader_uuid', '60629331c700001', 'Current GC worker leader UUID. (DO NOT EDIT)')           ON DUPLICATE KEY           UPDATE variable_value = '60629331c700001', comment = 'Current GC worker leader UUID. (DO NOT EDIT)';"]
[2022/06/22 15:24:57.012 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=60629331c700001]
[2022/06/22 15:24:57.012 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="DROP TABLE IF EXISTS t1"] [user=]
[2022/06/22 15:24:57.012 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=1] [schemaVersion=34] [cur_db=test] [sql="CREATE TABLE t1 (\n  a int(11) DEFAULT NULL,\n  b int(11) DEFAULT NULL\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin\nPARTITION BY HASH( a )\nPARTITIONS 4"] [user=]
[2022/06/22 15:24:57.021 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:24:56.976 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:24:57.021 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:24:56.976 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="CREATE TABLE t1 (\n  a int(11) DEFAULT NULL,\n  b int(11) DEFAULT NULL\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin\nPARTITION BY HASH( a )\nPARTITIONS 4"]
[2022/06/22 15:24:57.022 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:24:56.976 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:24:57.032 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=1.069133ms] [phyTblIDs="[69,70,71,72,73]"] [actionTypes="[8,8,8,8,8]"]
[2022/06/22 15:24:57.082 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=50.904301ms] [job="ID:74, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:24:56.976 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:24:57.083 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:24:56.976 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:24:57.086 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=74]
[2022/06/22 15:24:57.086 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:24:57.091 +08:00] [WARN] [2pc.go:1802] ["schemaLeaseChecker is not set for this transaction"] [sessionID=1] [startTS=434079713742290952] [checkTS=434079713742290953]
[2022/06/22 15:24:57.094 +08:00] [WARN] [client_batch.go:794] ["wait response is cancelled"] [to=127.0.0.1:20160] [cause="context canceled"]
[2022/06/22 15:24:57.095 +08:00] [WARN] [client_batch.go:794] ["wait response is cancelled"] [to=127.0.0.1:20160] [cause="context canceled"]
[2022/06/22 15:24:57.098 +08:00] [WARN] [client_batch.go:794] ["wait response is cancelled"] [to=127.0.0.1:20160] [cause="context canceled"]
[2022/06/22 15:24:57.099 +08:00] [WARN] [client_batch.go:794] ["wait response is cancelled"] [to=127.0.0.1:20160] [cause="context canceled"]
[2022/06/22 15:24:57.099 +08:00] [WARN] [client_batch.go:794] ["wait response is cancelled"] [to=127.0.0.1:20160] [cause="context canceled"]
[2022/06/22 15:24:57.099 +08:00] [WARN] [client_batch.go:794] ["wait response is cancelled"] [to=127.0.0.1:20160] [cause="context canceled"]
[2022/06/22 15:24:57.103 +08:00] [WARN] [client_batch.go:794] ["wait response is cancelled"] [to=127.0.0.1:20160] [cause="context canceled"]
[2022/06/22 15:24:57.103 +08:00] [WARN] [client_batch.go:794] ["wait response is cancelled"] [to=127.0.0.1:20160] [cause="context canceled"]
[2022/06/22 15:24:57.103 +08:00] [WARN] [client_batch.go:794] ["wait response is cancelled"] [to=127.0.0.1:20160] [cause="context canceled"]
[2022/06/22 15:24:57.104 +08:00] [WARN] [client_batch.go:794] ["wait response is cancelled"] [to=127.0.0.1:20160] [cause="context canceled"]
[2022/06/22 15:24:57.104 +08:00] [WARN] [client_batch.go:794] ["wait response is cancelled"] [to=127.0.0.1:20160] [cause="context canceled"]
[2022/06/22 15:24:57.104 +08:00] [WARN] [client_batch.go:794] ["wait response is cancelled"] [to=127.0.0.1:20160] [cause="context canceled"]
[2022/06/22 15:24:57.105 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"]
[2022/06/22 15:24:57.105 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"]
[2022/06/22 15:24:57.105 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 15:24:57.106 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"] []
[2022/06/22 15:24:57.108 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=270ns]
[2022/06/22 15:24:57.108 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=50ns]
[2022/06/22 15:24:57.108 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 15:24:57.108 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 15:24:57.108 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=1a63af86-b363-4b3f-b1f5-68375caf227b] ["take time"=2.708357ms]
[2022/06/22 15:24:57.108 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=1a63af86-b363-4b3f-b1f5-68375caf227b]
[2022/06/22 15:24:57.109 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 15:24:57.109 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"]
[2022/06/22 15:24:57.109 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"]
[2022/06/22 15:24:57.109 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 15:24:57.109 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"]
[2022/06/22 15:24:57.109 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"]
[2022/06/22 15:24:57.109 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b watch owner key /tidb/stats/owner/2231818a4c8f2d56"]
[2022/06/22 15:24:57.109 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"]
[2022/06/22 15:24:57.109 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 15:24:57.109 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:52098->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 15:24:57.109 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"]
[2022/06/22 15:24:57.132 +08:00] [WARN] [etcd.go:78] ["failed to new session to etcd"] [ownerInfo="[stats] /tidb/stats/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"] [error="context canceled"]
[2022/06/22 15:24:57.333 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 15:24:59.621 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:24:59.621 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 15:24:59.636 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:24:59.636 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 15:24:59.861 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager 1a63af86-b363-4b3f-b1f5-68375caf227b"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:24:59.861 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 15:24:59.861 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.756133701s]
[2022/06/22 15:24:59.861 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=60629331c700001]
[2022/06/22 15:24:59.861 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 15:24:59.861 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestIssue22635 (17.87s)
    result.go:49: 
        	Error Trace:	result.go:49
        	            				partition_pruner_test.go:561
        	Error:      	Not equal: 
        	            	expected: "[1 3]\n"
        	            	actual  : "[2 3]\n"
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,2 +1,2 @@
        	            	-[1 3]
        	            	+[2 3]
        	            	 
        	Test:       	TestIssue22635
        	Messages:   	sql:SELECT (SELECT tt.a FROM t1  tt LIMIT 1) aa, COUNT(DISTINCT b) FROM t1  GROUP BY aa, args:[]
FAIL
err=exit status 1
[2022/06/22 15:25:00.128 +08:00] [INFO] [client.go:392] ["[pd] create pd client with endpoints"] [pd-address="[127.0.0.1:2379]"]
[2022/06/22 15:25:00.129 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:25:01.129 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE: error:rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp 127.0.0.1:2379: connect: connection refused\" target:127.0.0.1:2379 status:TRANSIENT_FAILURE"]
[2022/06/22 15:25:04.302 +08:00] [WARN] [base_client.go:251] ["[pd] failed to get cluster id"] [url=http://127.0.0.1:2379] [error="[PD:client:ErrClientGetMember]error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY: error:rpc error: code = Unknown desc = [PD:server:ErrServerNotStarted]server not started target:127.0.0.1:2379 status:READY"]
[2022/06/22 15:25:05.303 +08:00] [INFO] [base_client.go:332] ["[pd] update member urls"] [old-urls="[http://127.0.0.1:2379]"] [new-urls="[http://0.0.0.0:2379]"]
[2022/06/22 15:25:05.303 +08:00] [INFO] [base_client.go:350] ["[pd] switch leader"] [new-leader=http://0.0.0.0:2379] [old-leader=]
[2022/06/22 15:25:05.303 +08:00] [INFO] [base_client.go:105] ["[pd] init cluster id"] [cluster-id=7111570900147915495]
[2022/06/22 15:25:05.303 +08:00] [INFO] [client.go:687] ["[pd] tso dispatcher created"] [dc-location=global]
[2022/06/22 15:25:05.312 +08:00] [INFO] [tidb.go:74] ["new domain"] [store=tikv-7111570900147915495] ["ddl lease"=1s] ["stats lease"=3s] ["index usage sync lease"=0s]
[2022/06/22 15:25:05.320 +08:00] [INFO] [domain.go:1731] [acquireServerID] [serverID=75880] ["lease id"=2231818a4cd60a24]
[2022/06/22 15:25:05.322 +08:00] [WARN] [info.go:241] ["init TiFlashPlacementManager"] ["pd addrs"="[0.0.0.0:2379]"]
[2022/06/22 15:25:05.332 +08:00] [INFO] [domain.go:176] ["full load InfoSchema success"] [currentSchemaVersion=0] [neededSchemaVersion=34] ["start time"=7.357596ms]
[2022/06/22 15:25:05.332 +08:00] [INFO] [domain.go:437] ["full load and reset schema validator"]
[2022/06/22 15:25:05.333 +08:00] [INFO] [ddl.go:471] ["[ddl] start DDL"] [ID=e0c36b30-9663-48fd-b813-d855474a884a] [runWorker=true]
[2022/06/22 15:25:05.333 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[ddl] /tidb/ddl/fg/owner"]
[2022/06/22 15:25:05.333 +08:00] [INFO] [ddl.go:460] ["[ddl] start delRangeManager OK"] ["is a emulator"=false]
[2022/06/22 15:25:05.333 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 1, tp general"]
[2022/06/22 15:25:05.333 +08:00] [INFO] [ddl_worker.go:161] ["[ddl] start DDL worker"] [worker="worker 2, tp add index"]
[2022/06/22 15:25:05.335 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"] [ownerID=e0c36b30-9663-48fd-b813-d855474a884a]
[2022/06/22 15:25:05.339 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[bindinfo] /tidb/bindinfo/owner"]
[2022/06/22 15:25:05.339 +08:00] [WARN] [sysvar_cache.go:52] ["sysvar cache is empty, triggering rebuild"]
[2022/06/22 15:25:05.340 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"] [ownerID=e0c36b30-9663-48fd-b813-d855474a884a]
[2022/06/22 15:25:05.360 +08:00] [INFO] [telemetry.go:174] ["Telemetry configuration"] [endpoint=https://telemetry.pingcap.com/api/v1/tidb/report] [report_interval=6h0m0s] [enabled=true]
[2022/06/22 15:25:05.373 +08:00] [INFO] [data_slow_query.go:68] ["[domain:9009]Prometheus address is not set in PD and etcd"]
[2022/06/22 15:25:05.376 +08:00] [INFO] [data_slow_query.go:158] ["Telemetry slow query stats, postReportSlowQueryStats finished"]
[2022/06/22 15:25:05.376 +08:00] [INFO] [telemetry.go:134] ["Uploading telemetry data to https://telemetry.pingcap.com/api/v1/tidb/report"]
[2022/06/22 15:25:05.546 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[stats] /tidb/stats/owner"]
[2022/06/22 15:25:05.546 +08:00] [INFO] [manager.go:140] ["start campaign owner"] [ownerInfo="[telemetry] /tidb/telemetry/owner"]
[2022/06/22 15:25:05.547 +08:00] [INFO] [gc_worker.go:202] ["[gc worker] start"] [uuid=6062933a9b80002]
[2022/06/22 15:25:05.548 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"] [ownerID=e0c36b30-9663-48fd-b813-d855474a884a]
[2022/06/22 15:25:05.549 +08:00] [INFO] [manager.go:276] ["get owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"] [ownerID=e0c36b30-9663-48fd-b813-d855474a884a]
[2022/06/22 15:25:05.550 +08:00] [INFO] [domain.go:1377] ["init stats info time"] ["take time"=4.287235ms]
[2022/06/22 15:25:05.572 +08:00] [INFO] [gc_worker.go:315] ["[gc worker] another gc job has just finished, skipped."] ["leaderTick on "=6062933a9b80002]
[2022/06/22 15:25:05.572 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=0] [schemaVersion=34] [cur_db=test] [sql="drop table if exists t_tinyint, t_unsigned, t_float, t_decimal, t_year"] [user=]
[2022/06/22 15:25:05.573 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=0] [schemaVersion=34] [cur_db=test] [sql="create table t_tinyint (a tinyint, b tinyint, key(a))"] [user=]
[2022/06/22 15:25:05.581 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:25:05.568 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:25:05.581 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:25:05.568 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t_tinyint (a tinyint, b tinyint, key(a))"]
[2022/06/22 15:25:05.583 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:25:05.568 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:25:05.589 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=34] [neededSchemaVersion=35] ["start time"=787.814µs] [phyTblIDs="[69]"] [actionTypes="[8]"]
[2022/06/22 15:25:05.639 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=35] ["take time"=51.016283ms] [job="ID:70, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:1, start time: 2022-06-22 15:25:05.568 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:25:05.640 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:70, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:69, RowCount:0, ArgLen:0, start time: 2022-06-22 15:25:05.568 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:25:05.643 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=70]
[2022/06/22 15:25:05.643 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:25:05.643 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=0] [schemaVersion=35] [cur_db=test] [sql="create table t_unsigned (a int unsigned, b int unsigned, key(a))"] [user=]
[2022/06/22 15:25:05.648 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:25:05.618 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:25:05.648 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:25:05.618 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t_unsigned (a int unsigned, b int unsigned, key(a))"]
[2022/06/22 15:25:05.649 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 15:25:05.618 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:25:05.654 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=35] [neededSchemaVersion=36] ["start time"=565.539µs] [phyTblIDs="[71]"] [actionTypes="[8]"]
[2022/06/22 15:25:05.705 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=36] ["take time"=51.81677ms] [job="ID:72, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:1, start time: 2022-06-22 15:25:05.618 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:25:05.706 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:72, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:71, RowCount:0, ArgLen:0, start time: 2022-06-22 15:25:05.618 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:25:05.709 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=72]
[2022/06/22 15:25:05.709 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:25:05.709 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=0] [schemaVersion=36] [cur_db=test] [sql="create table t_float(a float, b float, key(a))"] [user=]
[2022/06/22 15:25:05.713 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 15:25:05.669 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:25:05.713 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 15:25:05.669 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t_float(a float, b float, key(a))"]
[2022/06/22 15:25:05.714 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:73, RowCount:0, ArgLen:0, start time: 2022-06-22 15:25:05.669 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:25:05.719 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=36] [neededSchemaVersion=37] ["start time"=556.754µs] [phyTblIDs="[73]"] [actionTypes="[8]"]
[2022/06/22 15:25:05.769 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=37] ["take time"=50.899032ms] [job="ID:74, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:73, RowCount:0, ArgLen:1, start time: 2022-06-22 15:25:05.669 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:25:05.770 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:74, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:73, RowCount:0, ArgLen:0, start time: 2022-06-22 15:25:05.669 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:25:05.773 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=74]
[2022/06/22 15:25:05.773 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:25:05.774 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=0] [schemaVersion=37] [cur_db=test] [sql="create table t_decimal(a decimal(10,2), b decimal(10,2), key(a))"] [user=]
[2022/06/22 15:25:05.778 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:76, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 15:25:05.768 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:25:05.778 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:76, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 15:25:05.768 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t_decimal(a decimal(10,2), b decimal(10,2), key(a))"]
[2022/06/22 15:25:05.779 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:76, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 15:25:05.768 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:25:05.785 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=37] [neededSchemaVersion=38] ["start time"=725.987µs] [phyTblIDs="[75]"] [actionTypes="[8]"]
[2022/06/22 15:25:05.834 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=38] ["take time"=51.135249ms] [job="ID:76, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:75, RowCount:0, ArgLen:1, start time: 2022-06-22 15:25:05.768 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:25:05.836 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:76, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:75, RowCount:0, ArgLen:0, start time: 2022-06-22 15:25:05.768 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:25:05.838 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=76]
[2022/06/22 15:25:05.838 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:25:05.839 +08:00] [INFO] [session.go:3289] ["CRUCIAL OPERATION"] [conn=0] [schemaVersion=38] [cur_db=test] [sql="create table t_year(a year, b year, key(a))"] [user=]
[2022/06/22 15:25:05.844 +08:00] [INFO] [ddl_worker.go:334] ["[ddl] add DDL jobs"] ["batch count"=1] [jobs="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:77, RowCount:0, ArgLen:1, start time: 2022-06-22 15:25:05.819 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0; "]
[2022/06/22 15:25:05.844 +08:00] [INFO] [ddl.go:727] ["[ddl] start DDL job"] [job="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:77, RowCount:0, ArgLen:1, start time: 2022-06-22 15:25:05.819 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"] [query="create table t_year(a year, b year, key(a))"]
[2022/06/22 15:25:05.845 +08:00] [INFO] [ddl_worker.go:805] ["[ddl] run DDL job"] [worker="worker 1, tp general"] [job="ID:78, Type:create table, State:queueing, SchemaState:none, SchemaID:1, TableID:77, RowCount:0, ArgLen:0, start time: 2022-06-22 15:25:05.819 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:25:05.850 +08:00] [INFO] [domain.go:150] ["diff load InfoSchema success"] [currentSchemaVersion=38] [neededSchemaVersion=39] ["start time"=611.516µs] [phyTblIDs="[77]"] [actionTypes="[8]"]
[2022/06/22 15:25:05.901 +08:00] [INFO] [ddl_worker.go:1013] ["[ddl] wait latest schema version changed"] [worker="worker 1, tp general"] [ver=39] ["take time"=51.531846ms] [job="ID:78, Type:create table, State:done, SchemaState:public, SchemaID:1, TableID:77, RowCount:0, ArgLen:1, start time: 2022-06-22 15:25:05.819 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:25:05.902 +08:00] [INFO] [ddl_worker.go:468] ["[ddl] finish DDL job"] [worker="worker 1, tp general"] [job="ID:78, Type:create table, State:synced, SchemaState:public, SchemaID:1, TableID:77, RowCount:0, ArgLen:0, start time: 2022-06-22 15:25:05.819 +0800 CST, Err:<nil>, ErrCount:0, SnapshotVersion:0"]
[2022/06/22 15:25:05.905 +08:00] [INFO] [ddl.go:793] ["[ddl] DDL job is finished"] [jobID=78]
[2022/06/22 15:25:05.905 +08:00] [INFO] [callback.go:107] ["performing DDL change, must reload"]
[2022/06/22 15:25:05.943 +08:00] [WARN] [client_batch.go:794] ["wait response is cancelled"] [to=127.0.0.1:20160] [cause="context canceled"]
[2022/06/22 15:25:05.949 +08:00] [WARN] [coprocessor.go:924] ["other error"] [txnStartTS=434079716060430390] [regionID=2] [bucketsVer=0] [latestBucketsVer=0] [rangeNums=1] [firstRangeStartKey="t\ufffd\u0000\u0000\u0000\u0000\u0000\u0000E_r\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000"] [lastRangeEndKey="t\ufffd\u0000\u0000\u0000\u0000\u0000\u0000E_r\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0000"] [storeAddr=127.0.0.1:20160] [error="other error: [components/tidb_query_expr/src/types/expr_builder.rs:306]: Invalid compare (sig = GtInt) signature: Evaluate error: [components/tidb_query_expr/src/types/function.rs:269]: Expect `Int`, received `Bytes`"] [errorVerbose="other error: [components/tidb_query_expr/src/types/expr_builder.rs:306]: Invalid compare (sig = GtInt) signature: Evaluate error: [components/tidb_query_expr/src/types/function.rs:269]: Expect `Int`, received `Bytes`\ngithub.com/pingcap/tidb/store/copr.(*copIteratorWorker).handleCopResponse\n\t/home/genius/project/src/github.com/pingcap/tidb/store/copr/coprocessor.go:919\ngithub.com/pingcap/tidb/store/copr.(*copIteratorWorker).handleCopPagingResult\n\t/home/genius/project/src/github.com/pingcap/tidb/store/copr/coprocessor.go:852\ngithub.com/pingcap/tidb/store/copr.(*copIteratorWorker).handleTaskOnce\n\t/home/genius/project/src/github.com/pingcap/tidb/store/copr/coprocessor.go:782\ngithub.com/pingcap/tidb/store/copr.(*copIteratorWorker).handleTask\n\t/home/genius/project/src/github.com/pingcap/tidb/store/copr/coprocessor.go:674\ngithub.com/pingcap/tidb/store/copr.(*copIteratorWorker).run\n\t/home/genius/project/src/github.com/pingcap/tidb/store/copr/coprocessor.go:416\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 15:25:05.949 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"]
[2022/06/22 15:25:05.949 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"]
[2022/06/22 15:25:05.949 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 15:25:05.949 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[ddl] /tidb/ddl/fg/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"] []
[2022/06/22 15:25:05.950 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 1, tp general"] ["take time"=380ns]
[2022/06/22 15:25:05.950 +08:00] [INFO] [ddl_worker.go:155] ["[ddl] DDL worker closed"] [worker="worker 2, tp add index"] ["take time"=40ns]
[2022/06/22 15:25:05.950 +08:00] [INFO] [delete_range.go:130] ["[ddl] closing delRange"]
[2022/06/22 15:25:05.950 +08:00] [INFO] [session_pool.go:94] ["[ddl] closing sessionPool"]
[2022/06/22 15:25:05.950 +08:00] [INFO] [ddl.go:560] ["[ddl] DDL closed"] [ID=e0c36b30-9663-48fd-b813-d855474a884a] ["take time"=972.07µs]
[2022/06/22 15:25:05.950 +08:00] [INFO] [ddl.go:452] ["[ddl] stop DDL"] [ID=e0c36b30-9663-48fd-b813-d855474a884a]
[2022/06/22 15:25:05.951 +08:00] [INFO] [domain.go:594] ["loadSchemaInLoop exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [domain.go:1369] ["loadStatsWorker exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [domain.go:1252] ["dumpFileGcChecker exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [handle_hist.go:144] ["SubLoadWorker exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [domain.go:1524] ["gcAnalyzeHistory exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [domain.go:1503] ["autoAnalyzeWorker exited."]
[2022/06/22 15:25:05.951 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"]
[2022/06/22 15:25:05.951 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"]
[2022/06/22 15:25:05.951 +08:00] [INFO] [domain.go:1230] ["TelemetryRotateSubWindowLoop exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [domain.go:1046] ["LoadSysVarCacheLoop exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [domain.go:996] ["loadPrivilegeInLoop exited."]
[2022/06/22 15:25:05.951 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"]
[2022/06/22 15:25:05.951 +08:00] [INFO] [manager.go:208] ["break campaign loop, context is done"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"]
[2022/06/22 15:25:05.951 +08:00] [INFO] [domain.go:1124] ["globalBindHandleWorkerLoop exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [domain.go:563] ["topologySyncerKeeper exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [domain.go:540] ["globalConfigSyncerKeeper exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [domain.go:515] ["infoSyncerKeeper exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [domain.go:1758] ["serverIDKeeper exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [manager.go:295] ["watcher is closed, no owner"] ["owner info"="[stats] ownerManager e0c36b30-9663-48fd-b813-d855474a884a watch owner key /tidb/stats/owner/2231818a4cd60a48"]
[2022/06/22 15:25:05.951 +08:00] [WARN] [manager.go:241] ["is not the owner"] ["owner info"="[stats] /tidb/stats/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"]
[2022/06/22 15:25:05.951 +08:00] [INFO] [domain.go:486] ["topNSlowQueryLoop exited."]
[2022/06/22 15:25:05.951 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"] [error="rpc error: code = Unavailable desc = error reading from server: read tcp 127.0.0.1:52130->127.0.0.1:2379: use of closed network connection"]
[2022/06/22 15:25:05.959 +08:00] [INFO] [manager.go:227] ["failed to campaign"] ["owner info"="[stats] /tidb/stats/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"] [error="context canceled"]
[2022/06/22 15:25:05.959 +08:00] [INFO] [manager.go:199] ["etcd session is done, creates a new one"] ["owner info"="[stats] /tidb/stats/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"]
[2022/06/22 15:25:05.959 +08:00] [INFO] [manager.go:203] ["break campaign loop, NewSession failed"] ["owner info"="[stats] /tidb/stats/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"] [error="context canceled"] [errorVerbose="context canceled\ngithub.com/pingcap/errors.AddStack\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/home/genius/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20211224045212-9687c2b0f87c/juju_adaptor.go:15\ngithub.com/pingcap/tidb/util.contextDone\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:90\ngithub.com/pingcap/tidb/util.NewSession\n\t/home/genius/project/src/github.com/pingcap/tidb/util/etcd.go:50\ngithub.com/pingcap/tidb/owner.(*ownerManager).campaignLoop\n\t/home/genius/project/src/github.com/pingcap/tidb/owner/manager.go:201\nruntime.goexit\n\t/home/genius/project/go/src/runtime/asm_amd64.s:1571"]
[2022/06/22 15:25:08.490 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[telemetry] /tidb/telemetry/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:25:08.490 +08:00] [INFO] [domain.go:1200] ["TelemetryReportLoop exited."]
[2022/06/22 15:25:08.494 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[stats] /tidb/stats/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:25:08.494 +08:00] [INFO] [domain.go:1446] ["updateStatsWorker exited."]
[2022/06/22 15:25:08.504 +08:00] [INFO] [manager.go:252] ["revoke session"] ["owner info"="[bindinfo] /tidb/bindinfo/owner ownerManager e0c36b30-9663-48fd-b813-d855474a884a"] [error="rpc error: code = Canceled desc = grpc: the client connection is closing"]
[2022/06/22 15:25:08.504 +08:00] [INFO] [domain.go:1167] ["handleEvolvePlanTasksLoop exited."]
[2022/06/22 15:25:08.504 +08:00] [INFO] [domain.go:721] ["domain closed"] ["take time"=2.554994654s]
[2022/06/22 15:25:08.504 +08:00] [INFO] [gc_worker.go:230] ["[gc worker] quit"] [uuid=6062933a9b80002]
[2022/06/22 15:25:08.504 +08:00] [INFO] [client.go:768] ["[pd] stop fetching the pending tso requests due to context canceled"] [dc-location=global]
[2022/06/22 15:25:08.504 +08:00] [INFO] [client.go:706] ["[pd] exit tso dispatcher"] [dc-location=global]
--- FAIL: TestPrepareCacheChangingParamType (8.38s)
    testkit.go:174: 
        	Error Trace:	testkit.go:174
        	            				testkit.go:168
        	            				prepare_test.go:672
        	            				prepare_test.go:680
        	Error:      	Received unexpected error:
        	            	other error: [components/tidb_query_expr/src/types/expr_builder.rs:306]: Invalid compare (sig = GtInt) signature: Evaluate error: [components/tidb_query_expr/src/types/function.rs:269]: Expect `Int`, received `Bytes`
        	            	github.com/pingcap/tidb/store/copr.(*copIteratorWorker).handleCopResponse
        	            		/home/genius/project/src/github.com/pingcap/tidb/store/copr/coprocessor.go:919
        	            	github.com/pingcap/tidb/store/copr.(*copIteratorWorker).handleCopPagingResult
        	            		/home/genius/project/src/github.com/pingcap/tidb/store/copr/coprocessor.go:852
        	            	github.com/pingcap/tidb/store/copr.(*copIteratorWorker).handleTaskOnce
        	            		/home/genius/project/src/github.com/pingcap/tidb/store/copr/coprocessor.go:782
        	            	github.com/pingcap/tidb/store/copr.(*copIteratorWorker).handleTask
        	            		/home/genius/project/src/github.com/pingcap/tidb/store/copr/coprocessor.go:674
        	            	github.com/pingcap/tidb/store/copr.(*copIteratorWorker).run
        	            		/home/genius/project/src/github.com/pingcap/tidb/store/copr/coprocessor.go:416
        	            	runtime.goexit
        	            		/home/genius/project/go/src/runtime/asm_amd64.s:1571
        	Test:       	TestPrepareCacheChangingParamType
        	Messages:   	sql1:execute s5 using @a1, sql2:select * from t_tinyint where a>null
FAIL
make: *** [Makefile:121: ut] Error 1
